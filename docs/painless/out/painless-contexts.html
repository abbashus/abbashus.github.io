<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>Painless Scripting Language</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="painless-contexts" class="book toc2 toc-left">
<div id="header">
<h1>Painless Scripting Language</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">Painless Scripting Language</a></span></p><ul class="sectlevel1">
<li><a href="painless-guide.html">Painless Guide</a>
</li>
<li><a href="redirects.html">Appendix A: Deleted pages</a>
</li>
<li><a href="painless-lang-spec.html">Painless Language Specification</a>
</li>
<li><a href="painless-contexts.html"><span class="toc-current">Painless contexts</span></a>
<ul class="sectlevel2">
<li><a href="painless-contexts.html#painless-context-examples">Context examples</a>
</li>
<li><a href="painless-contexts.html#painless-ingest-processor-context">Ingest processor context</a>
</li>
<li><a href="painless-contexts.html#painless-update-context">Update context</a>
</li>
<li><a href="painless-contexts.html#painless-update-by-query-context">Update by query context</a>
</li>
<li><a href="painless-contexts.html#painless-reindex-context">Reindex context</a>
</li>
<li><a href="painless-contexts.html#painless-sort-context">Sort context</a>
</li>
<li><a href="painless-contexts.html#painless-similarity-context">Similarity context</a>
</li>
<li><a href="painless-contexts.html#painless-weight-context">Weight context</a>
</li>
<li><a href="painless-contexts.html#painless-score-context">Score context</a>
</li>
<li><a href="painless-contexts.html#painless-field-context">Field context</a>
</li>
<li><a href="painless-contexts.html#painless-filter-context">Filter context</a>
</li>
<li><a href="painless-contexts.html#painless-min-should-match-context">Minimum should match context</a>
</li>
<li><a href="painless-contexts.html#painless-metric-agg-init-context">Metric aggregation initialization context</a>
</li>
<li><a href="painless-contexts.html#painless-metric-agg-map-context">Metric aggregation map context</a>
</li>
<li><a href="painless-contexts.html#painless-metric-agg-combine-context">Metric aggregation combine context</a>
</li>
<li><a href="painless-contexts.html#painless-metric-agg-reduce-context">Metric aggregation reduce context</a>
</li>
<li><a href="painless-contexts.html#painless-bucket-script-agg-context">Bucket script aggregation context</a>
</li>
<li><a href="painless-contexts.html#painless-bucket-selector-agg-context">Bucket selector aggregation context</a>
</li>
<li><a href="painless-contexts.html#painless-analysis-predicate-context">Analysis Predicate Context</a>
</li>
</ul>
</li>
<li><a href="painless-api-reference.html">Painless API Reference</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="painless-contexts">Painless contexts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Painless script is evaluated within a context. Each context has values that
are available as local variables, an allowlist that controls the available
classes, and the methods and fields within those classes (API), and
if and what type of value is returned.</p>
</div>
<div class="paragraph">
<p>A Painless script is typically executed within one of the contexts in the table
below. Note this is not necessarily a comprehensive list as custom plugins and
specialized code may define new ways to use a Painless script.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Painless Documentation</th>
<th class="tableblock halign-left valign-top">OpenSearch Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ingest processor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-ingest-processor-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/script-processor.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-update-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/docs-update.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Update by query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-update-by-query-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/docs-update-by-query.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reindex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-reindex-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/docs-reindex.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-sort-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/sort-search-results.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Similarity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-similarity-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/index-modules-similarity.html">OpenSearchh Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Weight</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-weight-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/index-modules-similarity.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Score</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-score-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/query-dsl-function-score-query.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-field-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-fields.html#script-fields">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-filter-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/query-dsl-script-query.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minimum should match</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-min-should-match-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/query-dsl-terms-set-query.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metric aggregation initialization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-metric-agg-init-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-metrics-scripted-metric-aggregation.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metric aggregation map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-metric-agg-map-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-metrics-scripted-metric-aggregation.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metric aggregation combine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-metric-agg-combine-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-metrics-scripted-metric-aggregation.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metric aggregation reduce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-metric-agg-reduce-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-metrics-scripted-metric-aggregation.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bucket script aggregation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-bucket-script-agg-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-pipeline-bucket-script-aggregation.html">OpenSearch Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bucket selector aggregation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="painless-contexts.html#painless-bucket-selector-agg-context">Painless Documentation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-pipeline-bucket-selector-aggregation.html">OpenSearch Documentation</a></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="painless-context-examples">Context examples</h3>
<div class="paragraph">
<p>To run the examples, index the sample seat data into OpenSearch. The examples
must be run sequentially to work correctly.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the
<a href="https://download.opensearch.org/demos/painless/contexts/seats.json">seat data</a>. This
data set contains booking information for a collection of plays. Each document
represents a single seat for a play at a particular theater on a specific date
and time.</p>
<div class="paragraph">
<p>Each document contains the following fields:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>theatre</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/keyword.html"><code>keyword</code></a>)</dt>
<dd>
<p>The name of the theater the play is in.</p>
</dd>
<dt class="hdlist1"><code>play</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/text.html"><code>text</code></a>)</dt>
<dd>
<p>The name of the play.</p>
</dd>
<dt class="hdlist1"><code>actors</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/text.html"><code>text</code></a>)</dt>
<dd>
<p>A list of actors in the play.</p>
</dd>
<dt class="hdlist1"><code>row</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/number.html"><code>integer</code></a>)</dt>
<dd>
<p>The row of the seat.</p>
</dd>
<dt class="hdlist1"><code>number</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/number.html"><code>integer</code></a>)</dt>
<dd>
<p>The number of the seat within a row.</p>
</dd>
<dt class="hdlist1"><code>cost</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/number.html"><code>double</code></a>)</dt>
<dd>
<p>The cost of the ticket for the seat.</p>
</dd>
<dt class="hdlist1"><code>sold</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/boolean.html"><code>boolean</code></a>)</dt>
<dd>
<p>Whether or not the seat is sold.</p>
</dd>
<dt class="hdlist1"><code>datetime</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/date.html"><code>date</code></a>)</dt>
<dd>
<p>The date and time of the play as a date object.</p>
</dd>
<dt class="hdlist1"><code>date</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/keyword.html"><code>keyword</code></a>)</dt>
<dd>
<p>The date of the play as a keyword.</p>
</dd>
<dt class="hdlist1"><code>time</code> (<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/keyword.html"><code>keyword</code></a>)</dt>
<dd>
<p>The time of the play as a keyword.</p>
</dd>
</dl>
</div>
</li>
<li>
<p><a href="https://www.opensearch.org/guide/en/opensearch/guide/2.x/running-opensearch.html">Start</a> OpenSearch. Note these
examples assume OpenSearch and OpenSearch Dashboards are running locally. To use the Console
editor with a remote OpenSearch Dashboards instance, click the settings icon and enter the
Console URL. To submit a cURL request to a remote OpenSearch instance, edit
the request URL.</p>
</li>
<li>
<p>Create <a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping.html">mappings</a> for the sample data:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /seats
{
  "mappings": {
    "properties": {
      "theatre":  { "type": "keyword" },
      "play":     { "type": "keyword" },
      "actors":   { "type": "text"    },
      "row":      { "type": "integer" },
      "number":   { "type": "integer" },
      "cost":     { "type": "double"  },
      "sold":     { "type": "boolean" },
      "datetime": { "type": "date"    },
      "date":     { "type": "keyword" },
      "time":     { "type": "keyword" }
    }
  }
}</code></pre>
</div>
</div>
</li>
<li>
<p>Run the <a href="painless-contexts.html#painless-ingest-processor-context">ingest processor context</a>
example. This sets up a script ingest processor used on each document as the
seat data is indexed.</p>
</li>
<li>
<p>Index the seat data:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">curl -XPOST "localhost:9200/seats/_bulk?pipeline=seats" -H "Content-Type: application/x-ndjson" --data-binary "@/&lt;local-file-path&gt;/seats.json"</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="painless-ingest-processor-context">Ingest processor context</h3>
<div class="paragraph">
<p>Use a Painless script in an <a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/script-processor.html">ingest processor</a>
to modify documents upon insertion.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-index-field.html"><code>ctx['_index'</a></code>] (<code>String</code>)</dt>
<dd>
<p>The name of the index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-type-field.html"><code>ctx['_type'</a></code>] (<code>String</code>)</dt>
<dd>
<p>The type of document within an index.</p>
</dd>
<dt class="hdlist1"><code>ctx</code> (<code>Map</code>)</dt>
<dd>
<p>Contains extracted JSON in a <code>Map</code> and <code>List</code> structure for the fields
that are part of the document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Side Effects</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-index-field.html"><code>ctx['_index'</a></code>]</dt>
<dd>
<p>Modify this to change the destination index for the current document.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-type-field.html"><code>ctx['_type'</a></code>]</dt>
<dd>
<p>Modify this to change the type for the current document.</p>
</dd>
<dt class="hdlist1"><code>ctx</code> (<code>Map</code>)</dt>
<dd>
<p>Modify the values in the <code>Map/List</code> structure to add, modify, or delete
the fields of a document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">void</dt>
<dd>
<p>No expected return value.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>To run this example, first follow the steps in
<a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>The seat data contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A date in the format <code>YYYY-MM-DD</code> where the second digit of both month and day
is optional.</p>
</li>
<li>
<p>A time in the format HH:MM* where the second digit of both hours and minutes
is optional. The star (*) represents either the <code>String</code> <code>AM</code> or <code>PM</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following ingest script processes the date and time <code>Strings</code> and stores the
result in a <code>datetime</code> field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Painless" data-lang="Painless">String[] dateSplit = ctx.date.splitOnToken("-");                     <b class="conum">(1)</b>
String year = dateSplit[0].trim();
String month = dateSplit[1].trim();

if (month.length() == 1) {                                           <b class="conum">(2)</b>
    month = "0" + month;
}

String day = dateSplit[2].trim();

if (day.length() == 1) {                                             <b class="conum">(3)</b>
    day = "0" + day;
}

boolean pm = ctx.time.substring(ctx.time.length() - 2).equals("PM"); <b class="conum">(4)</b>
String[] timeSplit = ctx.time.substring(0,
        ctx.time.length() - 2).splitOnToken(":");                    <b class="conum">(5)</b>
int hours = Integer.parseInt(timeSplit[0].trim());
int minutes = Integer.parseInt(timeSplit[1].trim());

if (pm) {                                                            <b class="conum">(6)</b>
    hours += 12;
}

String dts = year + "-" + month + "-" + day + "T" +
        (hours &lt; 10 ? "0" + hours : "" + hours) + ":" +
        (minutes &lt; 10 ? "0" + minutes : "" + minutes) +
        ":00+08:00";                                                 <b class="conum">(7)</b>

ZonedDateTime dt = ZonedDateTime.parse(
         dts, DateTimeFormatter.ISO_OFFSET_DATE_TIME);               <b class="conum">(8)</b>
ctx.datetime = dt.getLong(ChronoField.INSTANT_SECONDS)*1000L;        <b class="conum">(9)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Uses the <code>splitOnToken</code> function to separate the date <code>String</code> from the
seat data into year, month, and day <code>Strings</code>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Note</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The use of the <code>ctx</code> ingest processor context variable to retrieve the
data from the <code>date</code> field.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>Appends the <a href="painless-lang-spec.html#string-literals">string literal</a> <code>"0"</code> value to a single
digit month since the format of the seat data allows for this case.</p>
</li>
<li>
<p>Appends the <a href="painless-lang-spec.html#string-literals">string literal</a> <code>"0"</code> value to a single
digit day since the format of the seat data allows for this case.</p>
</li>
<li>
<p>Sets the <a href="painless-lang-spec.html#primitive-types"><code>boolean type</code></a>
<a href="painless-lang-spec.html#painless-variables">variable</a> to <code>true</code> if the time <code>String</code> is a time
in the afternoon or evening.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Note</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The use of the <code>ctx</code> ingest processor context variable to retrieve the
data from the <code>time</code> field.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>Uses the <code>splitOnToken</code> function to separate the time <code>String</code> from the
seat data into hours and minutes <code>Strings</code>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Note</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The use of the <code>substring</code> method to remove the <code>AM</code> or <code>PM</code> portion of
the time <code>String</code>.</p>
</li>
<li>
<p>The use of the <code>ctx</code> ingest processor context variable to retrieve the
data from the <code>date</code> field.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</li>
<li>
<p>If the time <code>String</code> is an afternoon or evening value adds the
<a href="painless-lang-spec.html#integer-literals">integer literal</a> <code>12</code> to the existing hours to move to
a 24-hour based time.</p>
</li>
<li>
<p>Builds a new time <code>String</code> that is parsable using existing API methods.</p>
</li>
<li>
<p>Creates a <code>ZonedDateTime</code> <a href="painless-lang-spec.html#reference-types">reference type</a> value by using
the API method <code>parse</code> to parse the new time <code>String</code>.</p>
</li>
<li>
<p>Sets the datetime field <code>datetime</code> to the number of milliseconds retrieved
from the API method <code>getLong</code>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Note</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>The use of the <code>ctx</code> ingest processor context variable to set the field
<code>datetime</code>. Manipulate each document&#8217;s fields with the <code>ctx</code> variable as
each document is indexed.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Submit the following request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /_ingest/pipeline/seats
{
  "description": "update datetime for seats",
  "processors": [
    {
      "script": {
        "source": "String[] dateSplit = ctx.date.splitOnToken('-'); String year = dateSplit[0].trim(); String month = dateSplit[1].trim(); if (month.length() == 1) { month = '0' + month; } String day = dateSplit[2].trim(); if (day.length() == 1) { day = '0' + day; } boolean pm = ctx.time.substring(ctx.time.length() - 2).equals('PM'); String[] timeSplit = ctx.time.substring(0, ctx.time.length() - 2).splitOnToken(':'); int hours = Integer.parseInt(timeSplit[0].trim()); int minutes = Integer.parseInt(timeSplit[1].trim()); if (pm) { hours += 12; } String dts = year + '-' + month + '-' + day + 'T' + (hours &lt; 10 ? '0' + hours : '' + hours) + ':' + (minutes &lt; 10 ? '0' + minutes : '' + minutes) + ':00+08:00'; ZonedDateTime dt = ZonedDateTime.parse(dts, DateTimeFormatter.ISO_OFFSET_DATE_TIME); ctx.datetime = dt.getLong(ChronoField.INSTANT_SECONDS)*1000L;"
      }
    }
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-update-context">Update context</h3>
<div class="paragraph">
<p>Use a Painless script in an <a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/docs-update.html">update</a> operation to
add, modify, or delete fields within a single document.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>ctx['op']</code> (<code>String</code>)</dt>
<dd>
<p>The name of the operation.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-routing-field.html"><code>ctx['_routing'</a></code>] (<code>String</code>, read-only)</dt>
<dd>
<p>The value used to select a shard for document storage.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-index-field.html"><code>ctx['_index'</a></code>] (<code>String</code>, read-only)</dt>
<dd>
<p>The name of the index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-type-field.html"><code>ctx['_type'</a></code>] (<code>String</code>, read-only)</dt>
<dd>
<p>The type of document within an index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-id-field.html"><code>ctx['_id'</a></code>] (<code>int</code>, read-only)</dt>
<dd>
<p>The unique document id.</p>
</dd>
<dt class="hdlist1"><code>ctx['_version']</code> (<code>int</code>, read-only)</dt>
<dd>
<p>The current version of the document.</p>
</dd>
<dt class="hdlist1"><code>ctx['_now']</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The current timestamp in milliseconds.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-source-field.html"><code>ctx['_source'</a></code>] (<code>Map</code>)</dt>
<dd>
<p>Contains extracted JSON in a <code>Map</code> and <code>List</code> structure for the fields
existing in a stored document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Side Effects</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ctx['op']</code></dt>
<dd>
<p>Use the default of <code>index</code> to update a document. Set to <code>none</code> to
specify no operation or <code>delete</code> to delete the current document from
the index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-source-field.html"><code>ctx['_source'</a></code>]</dt>
<dd>
<p>Modify the values in the <code>Map/List</code> structure to add, modify, or delete
the fields of a document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>void</code></dt>
<dd>
<p>No expected return value.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>To run this example, first follow the steps in
<a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>The following query updates a document to be sold, and sets the cost
to the actual price paid after discounts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">POST /seats/_update/3
{
  "script": {
    "source": "ctx._source.sold = true; ctx._source.cost = params.sold_cost",
    "lang": "painless",
    "params": {
      "sold_cost": 26
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-update-by-query-context">Update by query context</h3>
<div class="paragraph">
<p>Use a Painless script in an
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/docs-update-by-query.html">update by query</a> operation to add,
modify, or delete fields within each of a set of documents collected as the
result of query.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>ctx['op']</code> (<code>String</code>)</dt>
<dd>
<p>The name of the operation.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-routing-field.html"><code>ctx['_routing'</a></code>] (<code>String</code>, read-only)</dt>
<dd>
<p>The value used to select a shard for document storage.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-index-field.html"><code>ctx['_index'</a></code>] (<code>String</code>, read-only)</dt>
<dd>
<p>The name of the index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-type-field.html"><code>ctx['_type'</a></code>] (<code>String</code>, read-only)</dt>
<dd>
<p>The type of document within an index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-id-field.html"><code>ctx['_id'</a></code>] (<code>int</code>, read-only)</dt>
<dd>
<p>The unique document id.</p>
</dd>
<dt class="hdlist1"><code>ctx['_version']</code> (<code>int</code>, read-only)</dt>
<dd>
<p>The current version of the document.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-source-field.html"><code>ctx['_source'</a></code>] (<code>Map</code>)</dt>
<dd>
<p>Contains extracted JSON in a <code>Map</code> and <code>List</code> structure for the fields
existing in a stored document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Side Effects</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ctx['op']</code></dt>
<dd>
<p>Use the default of <code>index</code> to update a document. Set to <code>none</code> to
specify no operation or <code>delete</code> to delete the current document from
the index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-source-field.html"><code>ctx['_source'</a></code>]</dt>
<dd>
<p>Modify the values in the <code>Map/List</code> structure to add, modify, or delete
the fields of a document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>void</code></dt>
<dd>
<p>No expected return value.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>To run this example, first follow the steps in
<a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>The following query finds all seats in a specific section that have not been
sold and lowers the price by 2:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">POST /seats/_update_by_query
{
  "query": {
    "bool": {
      "filter": [
        {
          "range": {
            "row": {
              "lte": 3
            }
          }
        },
        {
          "match": {
            "sold": false
          }
        }
      ]
    }
  },
  "script": {
    "source": "ctx._source.cost -= params.discount",
    "lang": "painless",
    "params": {
      "discount": 2
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-reindex-context">Reindex context</h3>
<div class="paragraph">
<p>Use a Painless script in a <a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/docs-reindex.html">reindex</a> operation to
add, modify, or delete fields within each document in an original index as its
reindexed into a target index.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>ctx['op']</code> (<code>String</code>)</dt>
<dd>
<p>The name of the operation.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-routing-field.html"><code>ctx['_routing'</a></code>] (<code>String</code>)</dt>
<dd>
<p>The value used to select a shard for document storage.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-index-field.html"><code>ctx['_index'</a></code>] (<code>String</code>)</dt>
<dd>
<p>The name of the index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-type-field.html"><code>ctx['_type'</a></code>] (<code>String</code>)</dt>
<dd>
<p>The type of document within an index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-id-field.html"><code>ctx['_id'</a></code>] (<code>int</code>, read-only)</dt>
<dd>
<p>The unique document id.</p>
</dd>
<dt class="hdlist1"><code>ctx['_version']</code> (<code>int</code>)</dt>
<dd>
<p>The current version of the document.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-source-field.html"><code>ctx['_source'</a></code>] (<code>Map</code>)</dt>
<dd>
<p>Contains extracted JSON in a <code>Map</code> and <code>List</code> structure for the fields
existing in a stored document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Side Effects</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ctx['op']</code></dt>
<dd>
<p>Use the default of <code>index</code> to update a document. Set to <code>none</code> to
specify no operation or <code>delete</code> to delete the current document from
the index.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-routing-field.html"><code>ctx['_routing'</a></code>]</dt>
<dd>
<p>Modify this to change the routing value for the current document.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-index-field.html"><code>ctx['_index'</a></code>]</dt>
<dd>
<p>Modify this to change the destination index for the current document.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-type-field.html"><code>ctx['_type'</a></code>]</dt>
<dd>
<p>Modify this to change the type for the current document.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-id-field.html"><code>ctx['_id'</a></code>]</dt>
<dd>
<p>Modify this to change the id for the current document.</p>
</dd>
<dt class="hdlist1"><code>ctx['_version']</code> (<code>int</code>)</dt>
<dd>
<p>Modify this to modify the version for the current document.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-source-field.html"><code>ctx['_source'</a></code>]</dt>
<dd>
<p>Modify the values in the <code>Map/List</code> structure to add, modify, or delete
the fields of a document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>void</code></dt>
<dd>
<p>No expected return value.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
<div class="sect2">
<h3 id="painless-sort-context">Sort context</h3>
<div class="paragraph">
<p>Use a Painless script to
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/sort-search-results.html">sort</a> the documents in a query.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>doc</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>Contains the fields of the current document.  For single-valued fields,
the value can be accessed via <code>doc['fieldname'].value</code>.  For multi-valued
fields, this returns the first value; other values can be accessed
via <code>doc['fieldname'].get(index)</code></p>
</dd>
<dt class="hdlist1"><code>_score</code> (<code>double</code> read-only)</dt>
<dd>
<p>The similarity score of the current document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>double</code></dt>
<dd>
<p>The score for the specified document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>To run this example, first follow the steps in
<a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>To sort results by the length of the <code>theatre</code> field, submit the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "term": {
      "sold": "true"
    }
  },
  "sort": {
    "_script": {
      "type": "number",
      "script": {
        "lang": "painless",
        "source": "doc['theatre'].value.length() * params.factor",
        "params": {
          "factor": 1.1
        }
      },
      "order": "asc"
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-similarity-context">Similarity context</h3>
<div class="paragraph">
<p>Use a Painless script to create a
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/index-modules-similarity.html">similarity</a> equation for scoring
documents in a query.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>weight</code> (<code>float</code>, read-only)</dt>
<dd>
<p>The weight as calculated by a <a href="painless-contexts.html#painless-weight-context">weight script</a></p>
</dd>
<dt class="hdlist1"><code>query.boost</code> (<code>float</code>, read-only)</dt>
<dd>
<p>The boost value if provided by the query.  If this is not provided the
value is <code>1.0f</code>.</p>
</dd>
<dt class="hdlist1"><code>field.docCount</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The number of documents that have a value for the current field.</p>
</dd>
<dt class="hdlist1"><code>field.sumDocFreq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The sum of all terms that exist for the current field.  If this is not
available the value is <code>-1</code>.</p>
</dd>
<dt class="hdlist1"><code>field.sumTotalTermFreq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The sum of occurrences in the index for all the terms that exist in the
current field.  If this is not available the value is <code>-1</code>.</p>
</dd>
<dt class="hdlist1"><code>term.docFreq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The number of documents that contain the current term in the index.</p>
</dd>
<dt class="hdlist1"><code>term.totalTermFreq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The total occurrences of the current term in the index.</p>
</dd>
<dt class="hdlist1"><code>doc.length</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The number of tokens the current document has in the current field.  This
is decoded from the stored <a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/norms.html">norms</a> and may be approximate for
long fields</p>
</dd>
<dt class="hdlist1"><code>doc.freq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The number of occurrences of the current term in the current
document for the current field.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Note that the <code>query</code>, <code>field</code>, and <code>term</code> variables are also available to the
<a href="painless-contexts.html#painless-weight-context">weight context</a>. They are more efficiently used
there, as they are constant for all documents.</p>
</div>
<div class="paragraph">
<p>For queries that contain multiple terms, the script is called once for each
term with that term&#8217;s calculated weight, and the results are summed.  Note that some
terms might have a <code>doc.freq</code> value of <code>0</code> on a document, for example if a query
uses synonyms.</p>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>double</code></dt>
<dd>
<p>The similarity score for the current document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
<div class="sect2">
<h3 id="painless-weight-context">Weight context</h3>
<div class="paragraph">
<p>Use a Painless script to create a
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/index-modules-similarity.html">weight</a> for use in a
<a href="painless-contexts.html#painless-similarity-context">similarity script</a>.  The weight makes up the
part of the similarity calculation that is independent of the document being
scored, and so can be built up front and cached.</p>
</div>
<div class="paragraph">
<p>Queries that contain multiple terms calculate a separate weight for each term.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>query.boost</code> (<code>float</code>, read-only)</dt>
<dd>
<p>The boost value if provided by the query.  If this is not provided the
value is <code>1.0f</code>.</p>
</dd>
<dt class="hdlist1"><code>field.docCount</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The number of documents that have a value for the current field.</p>
</dd>
<dt class="hdlist1"><code>field.sumDocFreq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The sum of all terms that exist for the current field.  If this is not
available the value is <code>-1</code>.</p>
</dd>
<dt class="hdlist1"><code>field.sumTotalTermFreq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The sum of occurrences in the index for all the terms that exist in the
current field.  If this is not available the value is <code>-1</code>.</p>
</dd>
<dt class="hdlist1"><code>term.docFreq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The number of documents that contain the current term in the index.</p>
</dd>
<dt class="hdlist1"><code>term.totalTermFreq</code> (<code>long</code>, read-only)</dt>
<dd>
<p>The total occurrences of the current term in the index.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>double</code></dt>
<dd>
<p>A scoring factor used across all documents.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
<div class="sect2">
<h3 id="painless-score-context">Score context</h3>
<div class="paragraph">
<p>Use a Painless script in a
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/query-dsl-function-score-query.html">function score</a> to apply a new
score to documents returned from a query.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>doc</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>Contains the fields of the current document.  For single-valued fields,
the value can be accessed via <code>doc['fieldname'].value</code>.  For multi-valued
fields, this returns the first value; other values can be accessed
via <code>doc['fieldname'].get(index)</code></p>
</dd>
<dt class="hdlist1"><code>_score</code> (<code>double</code> read-only)</dt>
<dd>
<p>The similarity score of the current document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>double</code></dt>
<dd>
<p>The score for the current document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>To run this example, first follow the steps in
<a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>The following query finds all unsold seats, with lower 'row' values
scored higher.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /seats/_search
{
  "query": {
    "function_score": {
      "query": {
        "match": {
          "sold": "false"
        }
      },
      "script_score": {
        "script": {
          "source": "1.0 / doc['row'].value"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-field-context">Field context</h3>
<div class="paragraph">
<p>Use a Painless script to create a
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-fields.html#script-fields">script field</a> to return
a customized value for each document in the results of a query.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>doc</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>Contains the fields of the specified document where each field is a
<code>List</code> of values.</p>
</dd>
<dt class="hdlist1"><a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/mapping-source-field.html"><code>params['_source'</a></code>] (<code>Map</code>, read-only)</dt>
<dd>
<p>Contains extracted JSON in a <code>Map</code> and <code>List</code> structure for the fields
existing in a stored document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Object</code></dt>
<dd>
<p>The customized value for each document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>To run this example, first follow the steps in
<a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>You can then use these two example scripts to compute custom information
for each search hit and output it to two new fields.</p>
</div>
<div class="paragraph">
<p>The first script gets the doc value for the <code>datetime</code> field and calls
the <code>getDayOfWeek</code> function to determine the corresponding day of the week.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Painless" data-lang="Painless">doc['datetime'].value.getDayOfWeek();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The second script calculates the number of actors. Actors' names are stored
as a text array in the <code>actors</code> field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Painless" data-lang="Painless">params['_source']['actors'].length;                        <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>By default, doc values are not available for text fields. However,
you can still calculate the number of actors by extracting actors
from <code>_source</code>. Note that <code>params['_source']['actors']</code> is a list.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Submit the following request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET seats/_search
{
  "query": {
    "match_all": {}
  },
  "script_fields": {
    "day-of-week": {
      "script": {
        "source": "doc['datetime'].value.getDayOfWeek()"
      }
    },
    "number-of-actors": {
      "script": {
        "source": "params['_source']['actors'].length"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-filter-context">Filter context</h3>
<div class="paragraph">
<p>Use a Painless script as a <a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/query-dsl-script-query.html">filter</a> in a
query to include and exclude documents.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>doc</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>Contains the fields of the current document where each field is a
<code>List</code> of values.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>boolean</code></dt>
<dd>
<p>Return <code>true</code> if the current document should be returned as a result of
the query, and <code>false</code> otherwise.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>To run this example, first follow the steps in
<a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>This script finds all unsold documents that cost less than $18.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Painless" data-lang="Painless">doc['sold'].value == false &amp;&amp; doc['cost'].value &lt; 18</code></pre>
</div>
</div>
<div class="paragraph">
<p>Defining cost as a script parameter enables the cost to be configured
in the script query request. For example, the following request finds
all available theatre seats for evening performances that are under $18.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET seats/_search
{
  "query": {
    "bool": {
      "filter": {
        "script": {
          "script": {
            "source": "doc['sold'].value == false &amp;&amp; doc['cost'].value &lt; params.cost",
            "params": {
              "cost": 18
            }
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-min-should-match-context">Minimum should match context</h3>
<div class="paragraph">
<p>Use a Painless script to specify the
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/query-dsl-terms-set-query.html">minimum</a> number of terms that a
specified field needs to match with for a document to be part of the query
results.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>params['num_terms']</code> (<code>int</code>, read-only)</dt>
<dd>
<p>The number of terms specified to match with.</p>
</dd>
<dt class="hdlist1"><code>doc</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>Contains the fields of the current document where each field is a
<code>List</code> of values.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>int</code></dt>
<dd>
<p>The minimum number of terms required to match the current document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>To run this example, first follow the steps in
<a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>Imagine that you want to find seats to performances by your favorite
actors. You have a list of favorite actors in mind, and you want
to find performances where the cast includes at least a certain
number of them. <code>terms_set</code> query with <code>minimum_should_match_script</code>
is a way to accomplish this. To make the query request more configurable,
you can define <code>min_actors_to_see</code> as a script parameter.</p>
</div>
<div class="paragraph">
<p>To ensure that the parameter <code>min_actors_to_see</code> doesn&#8217;t exceed
the number of favorite actors, you can use <code>num_term`s to get
the number of actors in the list and `Math.min</code> to get the lesser
of the two.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Painless" data-lang="Painless">Math.min(params['num_terms'], params['min_actors_to_see'])</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following request finds seats to performances with at least
two of the three specified actors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET seats/_search
{
  "query": {
    "terms_set": {
      "actors": {
        "terms": [
          "smith",
          "earns",
          "black"
        ],
        "minimum_should_match_script": {
          "source": "Math.min(params['num_terms'], params['min_actors_to_see'])",
          "params": {
            "min_actors_to_see": 2
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-metric-agg-init-context">Metric aggregation initialization context</h3>
<div class="paragraph">
<p>Use a Painless script to
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-metrics-scripted-metric-aggregation.html">initialize</a>
values for use in a scripted metric aggregation. An initialization script is
run prior to document collection once per shard and is optional as part of the
full metric aggregation.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>state</code> (<code>Map</code>)</dt>
<dd>
<p>Empty <code>Map</code> used to add values for use in a
<a href="painless-contexts.html#painless-metric-agg-map-context">map script</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Side Effects</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>state</code> (<code>Map</code>)</dt>
<dd>
<p>Add values to this <code>Map</code> to for use in a map.  Additional values must
be of the type <code>Map</code>, <code>List</code>, <code>String</code> or primitive.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>void</code></dt>
<dd>
<p>No expected return value.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
<div class="sect2">
<h3 id="painless-metric-agg-map-context">Metric aggregation map context</h3>
<div class="paragraph">
<p>Use a Painless script to
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-metrics-scripted-metric-aggregation.html">map</a>
values for use in a scripted metric aggregation. A map script is run once per
collected document following an optional
<a href="painless-contexts.html#painless-metric-agg-init-context">initialization script</a> and is required as
part of a full metric aggregation.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>state</code> (<code>Map</code>)</dt>
<dd>
<p><code>Map</code> used to add values for processing in a
<a href="painless-contexts.html#painless-metric-agg-map-context">combine script</a> or to be returned from the aggregation.</p>
</dd>
<dt class="hdlist1"><code>doc</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>Contains the fields of the current document where each field is a
<code>List</code> of values.</p>
</dd>
<dt class="hdlist1"><code>_score</code> (<code>double</code> read-only)</dt>
<dd>
<p>The similarity score of the current document.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Side Effects</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>state</code> (<code>Map</code>)</dt>
<dd>
<p>Use this <code>Map</code> to add values for processing in a combine script.
Additional values must be of the type <code>Map</code>, <code>List</code>, <code>String</code> or
primitive. The same <code>state</code> <code>Map</code> is shared between all aggregated documents
on a given shard. If an initialization script is provided as part of the
aggregation then values added from the initialization script are
available.  If no combine script is specified, values must be
directly stored in <code>state</code> in a usable form. If no combine script and no
<a href="painless-contexts.html#painless-metric-agg-reduce-context">reduce script</a> are specified, the
<code>state</code> values are used as the result.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>void</code></dt>
<dd>
<p>No expected return value.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
<div class="sect2">
<h3 id="painless-metric-agg-combine-context">Metric aggregation combine context</h3>
<div class="paragraph">
<p>Use a Painless script to
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-metrics-scripted-metric-aggregation.html">combine</a>
values for use in a scripted metric aggregation. A combine script is run once
per shard following a <a href="painless-contexts.html#painless-metric-agg-map-context">map script</a> and is
optional as part of a full metric aggregation.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>state</code> (<code>Map</code>)</dt>
<dd>
<p><code>Map</code> with values available from the prior map script.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>List</code>, <code>Map</code>, <code>String</code>, or primitive</dt>
<dd>
<p>A value collected for use in a
<a href="painless-contexts.html#painless-metric-agg-reduce-context">reduce script</a>. If no reduce
script is specified, the value is used as part of the result.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
<div class="sect2">
<h3 id="painless-metric-agg-reduce-context">Metric aggregation reduce context</h3>
<div class="paragraph">
<p>Use a Painless script to
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-metrics-scripted-metric-aggregation.html">reduce</a>
values to produce the result of a scripted metric aggregation. A reduce script
is run once on the coordinating node following a
<a href="painless-contexts.html#painless-metric-agg-combine-context">combine script</a> (or a
<a href="painless-contexts.html#painless-metric-agg-map-context">map script</a> if no combine script is
specified) and is optional as part of a full metric aggregation.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>states</code> (<code>Map</code>)</dt>
<dd>
<p><code>Map</code> with values available from the prior combine script (or a map
script if no combine script is specified).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>List</code>, <code>Map</code>, <code>String</code>, or primitive</dt>
<dd>
<p>A value used as the result.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
<div class="sect2">
<h3 id="painless-bucket-script-agg-context">Bucket script aggregation context</h3>
<div class="paragraph">
<p>Use a Painless script in an
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-pipeline-bucket-script-aggregation.html"><code>bucket_script</code> pipeline aggregation</a>
to calculate a value as a result in a bucket.</p>
</div>
<div class="sect3">
<h4 id="_variables">Variables</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query. The parameters
include values defined as part of the <code>buckets_path</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_return">Return</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">numeric</dt>
<dd>
<p>The calculated value as the result.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_api">API</h4>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
<div class="sect3">
<h4 id="_example">Example</h4>
<div class="paragraph">
<p>To run this example, first follow the steps in <a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>The painless context in a <code>bucket_script</code> aggregation provides a <code>params</code> map.  This map contains both
user-specified custom values, as well as the values from other aggregations specified in the <code>buckets_path</code>
property.</p>
</div>
<div class="paragraph">
<p>This example takes the values from a min and max aggregation, calculates the difference,
and adds the user-specified base_cost to the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Painless" data-lang="Painless">(params.max - params.min) + params.base_cost</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the values are extracted from the <code>params</code> map.  In context, the aggregation looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /seats/_search
{
  "size": 0,
  "aggs": {
    "theatres": {
      "terms": {
        "field": "theatre",
        "size": 10
      },
      "aggs": {
        "min_cost": {
          "min": {
            "field": "cost"
          }
        },
        "max_cost": {
          "max": {
            "field": "cost"
          }
        },
        "spread_plus_base": {
          "bucket_script": {
            "buckets_path": { <b class="conum">(1)</b>
              "min": "min_cost",
              "max": "max_cost"
            },
            "script": {
              "params": {
                "base_cost": 5 <b class="conum">(2)</b>
              },
              "source": "(params.max - params.min) + params.base_cost"
            }
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>buckets_path</code> points to two aggregations (<code>min_cost</code>, <code>max_cost</code>) and adds <code>min</code>/<code>max</code> variables
to the <code>params</code> map</p>
</li>
<li>
<p>The user-specified <code>base_cost</code> is also added to the script&#8217;s <code>params</code> map</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-bucket-selector-agg-context">Bucket selector aggregation context</h3>
<div class="paragraph">
<p>Use a Painless script in an
<a href="https://www.opensearch.org/guide/en/opensearch/reference/{branch}/search-aggregations-pipeline-bucket-selector-aggregation.html"><code>bucket_selector</code> aggregation</a>
to determine if a bucket should be retained or filtered out.</p>
</div>
<div class="sect3">
<h4 id="_variables_2">Variables</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query. The parameters
include values defined as part of the <code>buckets_path</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_return_2">Return</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">boolean</dt>
<dd>
<p>True if the bucket should be retained, false if the bucket should be filtered out.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_api_2">API</h4>
<div class="paragraph">
<p>To run this example, first follow the steps in <a href="painless-contexts.html#painless-context-examples">context examples</a>.</p>
</div>
<div class="paragraph">
<p>The painless context in a <code>bucket_selector</code> aggregation provides a <code>params</code> map.  This map contains both
user-specified custom values, as well as the values from other aggregations specified in the <code>buckets_path</code>
property.</p>
</div>
<div class="paragraph">
<p>Unlike some other aggregation contexts, the <code>bucket_selector</code> context must return a boolean <code>true</code> or <code>false</code>.</p>
</div>
<div class="paragraph">
<p>This example finds the max of each bucket, adds a user-specified base_cost, and retains all of the
buckets that are greater than <code>10</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-Painless" data-lang="Painless">params.max + params.base_cost &gt; 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the values are extracted from the <code>params</code> map. The script is in the form of an expression
that returns <code>true</code> or <code>false</code>.  In context, the aggregation looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /seats/_search
{
  "size": 0,
  "aggs": {
    "theatres": {
      "terms": {
        "field": "theatre",
        "size": 10
      },
      "aggs": {
        "max_cost": {
          "max": {
            "field": "cost"
          }
        },
        "filtering_agg": {
          "bucket_selector": {
            "buckets_path": { <b class="conum">(1)</b>
              "max": "max_cost"
            },
            "script": {
              "params": {
                "base_cost": 5 <b class="conum">(2)</b>
              },
              "source": "params.max + params.base_cost &gt; 10"
            }
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>buckets_path</code> points to the max aggregations (<code>max_cost</code>) and adds <code>max</code> variables
to the <code>params</code> map</p>
</li>
<li>
<p>The user-specified <code>base_cost</code> is also added to the <code>params</code> map</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="painless-analysis-predicate-context">Analysis Predicate Context</h3>
<div class="paragraph">
<p>Use a painless script to determine whether or not the current token in an
analysis chain matches a predicate.</p>
</div>
<div class="paragraph">
<p><strong>Variables</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>params</code> (<code>Map</code>, read-only)</dt>
<dd>
<p>User-defined parameters passed in as part of the query.</p>
</dd>
<dt class="hdlist1"><code>token.term</code> (<code>CharSequence</code>, read-only)</dt>
<dd>
<p>The characters of the current token</p>
</dd>
<dt class="hdlist1"><code>token.position</code> (<code>int</code>, read-only)</dt>
<dd>
<p>The position of the current token</p>
</dd>
<dt class="hdlist1"><code>token.positionIncrement</code> (<code>int</code>, read-only)</dt>
<dd>
<p>The position increment of the current token</p>
</dd>
<dt class="hdlist1"><code>token.positionLength</code> (<code>int</code>, read-only)</dt>
<dd>
<p>The position length of the current token</p>
</dd>
<dt class="hdlist1"><code>token.startOffset</code> (<code>int</code>, read-only)</dt>
<dd>
<p>The start offset of the current token</p>
</dd>
<dt class="hdlist1"><code>token.endOffset</code> (<code>int</code>, read-only)</dt>
<dd>
<p>The end offset of the current token</p>
</dd>
<dt class="hdlist1"><code>token.type</code> (<code>String</code>, read-only)</dt>
<dd>
<p>The type of the current token</p>
</dd>
<dt class="hdlist1"><code>token.keyword</code> ('boolean`, read-only)</dt>
<dd>
<p>Whether or not the current token is marked as a keyword</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>Return</strong></p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>boolean</code></dt>
<dd>
<p>Whether or not the current token matches the predicate</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><strong>API</strong></p>
</div>
<div class="paragraph">
<p>The standard <a href="painless-api-reference.html">Painless API</a> is available.</p>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>← Previous: <a href="painless-lang-spec.html">Painless Language Specification</a> | ↑ Up: <a href="index.html">Painless Scripting Language</a> | Next: <a href="painless-api-reference.html">Painless API Reference</a> →</p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-03-22 21:56:08 -0700
</div>
</div>
</body>
</html>