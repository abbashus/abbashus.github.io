<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>OpenSearch Reference</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="highlighting" class="book toc2 toc-left">
<div id="header">
<h1>OpenSearch Reference</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">OpenSearch Reference</a></span></p><ul class="sectlevel1">
<li><a href="opensearch-intro.html">What is OpenSearch?</a>
</li>
<li><a href="getting-started.html">Getting started with OpenSearch</a>
</li>
<li><a href="setup.html">Set up OpenSearch</a>
</li>
<li><a href="setup-upgrade.html">Upgrade OpenSearch</a>
</li>
<li><a href="index-modules.html">Index modules</a>
</li>
<li><a href="mapping.html">Mapping</a>
</li>
<li><a href="analysis.html">Text analysis</a>
</li>
<li><a href="index-templates.html">Index templates</a>
</li>
<li><a href="ingest.html">Ingest node</a>
</li>
<li><a href="search-your-data.html">Search your data</a>
<ul class="sectlevel1">
<li><a href="collapse-search-results.html">Collapse search results</a>
</li>
<li><a href="filter-search-results.html">Filter search results</a>
</li>
<li><a href="highlighting.html"><span class="toc-current">Highlighting</span></a>
</li>
<li><a href="near-real-time.html">Near real-time search</a>
</li>
<li><a href="paginate-search-results.html">Paginate search results</a>
</li>
<li><a href="inner-hits.html">Retrieve inner hits</a>
</li>
<li><a href="search-fields.html">Retrieve selected fields from a search</a>
</li>
<li><a href="modules-cross-cluster-search.html">Search across clusters</a>
</li>
<li><a href="search-multiple-indices.html">Search multiple indices</a>
</li>
<li><a href="search-shard-routing.html">Search shard routing</a>
</li>
<li><a href="sort-search-results.html">Sort search results</a>
</li>
</ul>
</li>
<li><a href="query-dsl.html">Query DSL</a>
</li>
<li><a href="search-aggregations.html">Aggregations</a>
</li>
<li><a href="modules-scripting.html">Scripting</a>
</li>
<li><a href="high-availability.html">Set up a cluster for high availability</a>
</li>
<li><a href="snapshot-restore.html">Snapshot and restore</a>
</li>
<li><a href="commands.html">Command line tools</a>
</li>
<li><a href="how-to.html">How To</a>
</li>
<li><a href="glossary.html">Glossary of terms</a>
</li>
<li><a href="rest-apis.html">REST APIs</a>
</li>
<li><a href="breaking-changes.html">Migration guide</a>
</li>
<li><a href="opensearch-release-notes.html">Release notes</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="highlighting">Highlighting</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Highlighters enable you to get highlighted snippets from one or more fields
in your search results so you can show users where the query matches are.
When you request highlights, the response contains an additional <code>highlight</code>
element for each search hit that includes the highlighted fields and the
highlighted fragments.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Highlighters don&#8217;t reflect the boolean logic of a query when extracting
 terms to highlight. Thus, for some complex boolean queries (e.g nested boolean
 queries, queries using <code>minimum_should_match</code> etc.), parts of documents may be
 highlighted that don&#8217;t correspond to query matches.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Highlighting requires the actual content of a field. If the field is not
stored (the mapping does not set <code>store</code> to <code>true</code>), the actual <code>_source</code> is
loaded and the relevant field is extracted from <code>_source</code>.</p>
</div>
<div class="paragraph">
<p>For example, to get highlights for the <code>content</code> field in each search hit
using the default highlighter, include a <code>highlight</code> object in
the request body that specifies the <code>content</code> field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "match": { "content": "bilbo" }
  },
  "highlight": {
    "fields": {
      "content": {}
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>OpenSearch supports three highlighters: <code>unified</code>, <code>plain</code>, and <code>fvh</code> (fast vector
highlighter). You can specify the highlighter <code>type</code> you want to use
for each field.</p>
</div>
<h3 id="unified-highlighter" class="discrete">Unified highlighter</h3>
<div class="paragraph">
<p>The <code>unified</code> highlighter uses the Lucene Unified Highlighter. This
highlighter breaks the text into sentences and uses the BM25 algorithm to score
individual sentences as if they were documents in the corpus. It also supports
accurate phrase and multi-term (fuzzy, prefix, regex) highlighting. This is the
default highlighter.</p>
</div>
<h3 id="plain-highlighter" class="discrete">Plain highlighter</h3>
<div class="paragraph">
<p>The <code>plain</code> highlighter uses the standard Lucene highlighter. It attempts to
reflect the query matching logic in terms of understanding word importance and
any word positioning criteria in phrase queries.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The <code>plain</code> highlighter works best for highlighting simple query matches in a
single field. To accurately reflect query logic, it creates a tiny in-memory
index and re-runs the original query criteria through Lucene&#8217;s query execution
planner to get access to low-level match information for the current document.
This is repeated for every field and every document that needs to be highlighted.
If you want to highlight a lot of fields in a lot of documents with complex
queries, we recommend using the <code>unified</code> highlighter on <code>postings</code> or <code>term_vector</code> fields.
</td>
</tr>
</table>
</div>
<h3 id="fast-vector-highlighter" class="discrete">Fast vector highlighter</h3>
<div class="paragraph">
<p>The <code>fvh</code> highlighter uses the Lucene Fast Vector highlighter.
This highlighter can be used on fields with <code>term_vector</code> set to
<code>with_positions_offsets</code> in the mapping. The fast vector highlighter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Can be customized with  a <a href="highlighting.html#boundary-scanners"><code>boundary_scanner</code></a>.</p>
</li>
<li>
<p>Requires setting <code>term_vector</code> to <code>with_positions_offsets</code> which
increases the size of the index</p>
</li>
<li>
<p>Can combine matches from multiple fields into one result.  See
<code>matched_fields</code></p>
</li>
<li>
<p>Can assign different weights to matches at different positions allowing
for things like phrase matches being sorted above term matches when
highlighting a Boosting Query that boosts phrase matches over term matches</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The <code>fvh</code> highlighter does not support span queries. If you need support for
span queries, try an alternative highlighter, such as the <code>unified</code> highlighter.
</td>
</tr>
</table>
</div>
<h3 id="offsets-strategy" class="discrete">Offsets strategy</h3>
<div class="paragraph">
<p>To create meaningful search snippets from the terms being queried,
the highlighter needs to know the start and end character offsets of each word
in the original text. These offsets can be obtained from:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The postings list. If <code>index_options</code> is set to <code>offsets</code> in the mapping,
the <code>unified</code> highlighter uses this information to highlight documents without
re-analyzing the text. It re-runs the original query directly on the postings
and extracts the matching offsets from the index, limiting the collection to
the highlighted documents. This is important if you have large fields because
it doesn&#8217;t require reanalyzing the text to be highlighted. It also requires less
disk space than using <code>term_vectors</code>.</p>
</li>
<li>
<p>Term vectors. If <code>term_vector</code> information is provided by setting
<code>term_vector</code> to <code>with_positions_offsets</code> in the mapping, the <code>unified</code>
highlighter automatically uses the <code>term_vector</code> to highlight the field.
It&#8217;s fast especially for large fields (&gt; <code>1MB</code>) and for highlighting multi-term queries like
<code>prefix</code> or <code>wildcard</code> because it can access the dictionary of terms for each document.
The <code>fvh</code> highlighter always uses term vectors.</p>
</li>
<li>
<p>Plain highlighting. This mode is used by the <code>unified</code> when there is no other alternative.
It creates a tiny in-memory index and re-runs the original query criteria through
Lucene&#8217;s query execution planner to get access to low-level match information on
the current document. This is repeated for every field and every document that
needs highlighting. The <code>plain</code> highlighter always uses plain highlighting.</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Plain highlighting for large texts may require substantial amount of time and memory.
To protect against this, the maximum number of text characters that will be analyzed has been
limited to 1000000. This default limit can be changed
for a particular index with the index setting <code>index.highlight.max_analyzed_offset</code>.
</td>
</tr>
</table>
</div>
<h3 id="highlighting-settings" class="discrete">Highlighting settings</h3>
<div class="paragraph">
<p>Highlighting settings can be set on a global level and overridden at
the field level.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">boundary_chars</dt>
<dd>
<p>A string that contains each boundary character.
Defaults to <code>.,!? \t\n</code>.</p>
</dd>
<dt class="hdlist1">boundary_max_scan</dt>
<dd>
<p>How far to scan for boundary characters. Defaults to <code>20</code>.</p>
</dd>
</dl>
</div>
<div id="boundary-scanners" class="dlist">
<dl>
<dt class="hdlist1">boundary_scanner</dt>
<dd>
<p>Specifies how to break the highlighted fragments: <code>chars</code>,
<code>sentence</code>, or <code>word</code>. Only valid for the <code>unified</code> and <code>fvh</code> highlighters.
Defaults to <code>sentence</code> for the <code>unified</code> highlighter. Defaults to <code>chars</code> for
the <code>fvh</code> highlighter.</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>chars</code></dt>
<dd>
<p>Use the characters specified by <code>boundary_chars</code> as highlighting
boundaries.  The <code>boundary_max_scan</code> setting controls how far to scan for
boundary characters. Only valid for the <code>fvh</code> highlighter.</p>
</dd>
<dt class="hdlist1"><code>sentence</code></dt>
<dd>
<p>Break highlighted fragments at the next sentence boundary, as
determined by Java&#8217;s
<a href="https://docs.oracle.com/javase/8/docs/api/java/text/BreakIterator.html">BreakIterator</a>.
You can specify the locale to use with <code>boundary_scanner_locale</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When used with the <code>unified</code> highlighter, the <code>sentence</code> scanner splits
sentences bigger than <code>fragment_size</code> at the first word boundary next to
<code>fragment_size</code>. You can set <code>fragment_size</code> to 0 to never split any sentence.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1"><code>word</code></dt>
<dd>
<p>Break highlighted fragments at the next word boundary, as determined
by Java&#8217;s <a href="https://docs.oracle.com/javase/8/docs/api/java/text/BreakIterator.html">BreakIterator</a>.
You can specify the locale to use with <code>boundary_scanner_locale</code>.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">boundary_scanner_locale</dt>
<dd>
<p>Controls which locale is used to search for sentence
and word boundaries. This parameter takes a form of a language tag,
e.g. <code>"en-US"</code>,  <code>"fr-FR"</code>, <code>"ja-JP"</code>. More info can be found in the
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Locale.html#forLanguageTag-java.lang.String-">Locale Language Tag</a>
documentation. The default value is <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Locale.html#ROOT"> Locale.ROOT</a>.</p>
</dd>
<dt class="hdlist1">encoder</dt>
<dd>
<p>Indicates if the snippet should be HTML encoded:
<code>default</code> (no encoding) or <code>html</code> (HTML-escape the snippet text and then
insert the highlighting tags)</p>
</dd>
<dt class="hdlist1">fields</dt>
<dd>
<p>Specifies the fields to retrieve highlights for. You can use wildcards
to specify fields. For example, you could specify <code>comment_*</code> to
get highlights for all <a href="mapping-types.html#text">text</a> and <a href="mapping-types.html#keyword">keyword</a> fields
that start with <code>comment_</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Only text and keyword fields are highlighted when you use wildcards.
If you use a custom mapper and want to highlight on a field anyway, you
must explicitly specify that field name.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">force_source</dt>
<dd>
<p>Highlight based on the source even if the field is
stored separately. Defaults to <code>false</code>.</p>
</dd>
<dt class="hdlist1">fragmenter</dt>
<dd>
<p>Specifies how text should be broken up in highlight
snippets: <code>simple</code> or <code>span</code>. Only valid for the <code>plain</code> highlighter.
Defaults to <code>span</code>.</p>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>simple</code></dt>
<dd>
<p>Breaks up text into same-sized fragments.</p>
</dd>
<dt class="hdlist1"><code>span</code></dt>
<dd>
<p>Breaks up text into same-sized fragments, but tries to avoid
breaking up text between highlighted terms. This is helpful when you&#8217;re
querying for phrases. Default.</p>
</dd>
</dl>
</div>
</dd>
<dt class="hdlist1">fragment_offset</dt>
<dd>
<p>Controls the margin from which you want to start
highlighting. Only valid when using the <code>fvh</code> highlighter.</p>
</dd>
<dt class="hdlist1">fragment_size</dt>
<dd>
<p>The size of the highlighted fragment in characters. Defaults
to 100.</p>
</dd>
<dt class="hdlist1">highlight_query</dt>
<dd>
<p>Highlight matches for a query other than the search
query. This is especially useful if you use a rescore query because
those are not taken into account by highlighting by default.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
OpenSearch does not validate that <code>highlight_query</code> contains
the search query in any way so it is possible to define it so
legitimate query results are not highlighted. Generally, you should
include the search query as part of the <code>highlight_query</code>.
</td>
</tr>
</table>
</div>
</dd>
<dt class="hdlist1">matched_fields</dt>
<dd>
<p>Combine matches on multiple fields to highlight a single field.
This is most intuitive for multifields that analyze the same string in different
ways.  All <code>matched_fields</code> must have <code>term_vector</code> set to
<code>with_positions_offsets</code>, but only the field to which
the matches are combined is loaded so only that field benefits from having
<code>store</code> set to <code>yes</code>. Only valid for the <code>fvh</code> highlighter.</p>
</dd>
<dt class="hdlist1">no_match_size</dt>
<dd>
<p>The amount of text you want to return from the beginning
of the field if there are no matching fragments to highlight. Defaults
to 0 (nothing is returned).</p>
</dd>
<dt class="hdlist1">number_of_fragments</dt>
<dd>
<p>The maximum number of fragments to return. If the
number of fragments is set to 0, no fragments are returned. Instead,
the entire field contents are highlighted and returned. This can be
handy when you need to highlight short texts such as a title or
address, but fragmentation is not required. If <code>number_of_fragments</code>
is 0, <code>fragment_size</code> is ignored. Defaults to 5.</p>
</dd>
<dt class="hdlist1">order</dt>
<dd>
<p>Sorts highlighted fragments by score when set to <code>score</code>.  By default,
fragments will be output in the order they appear in the field (order: <code>none</code>).
Setting this option to <code>score</code> will output the most relevant fragments first.
Each highlighter applies its own logic to compute relevancy scores. See
the document <a href="highlighting.html#how-opensearch-highlighters-work-internally">How highlighters work internally</a>
for more details how different highlighters find the best fragments.</p>
</dd>
<dt class="hdlist1">phrase_limit</dt>
<dd>
<p>Controls the number of matching phrases in a document that are
considered. Prevents the <code>fvh</code> highlighter from analyzing too many phrases
and consuming too much memory. When using <code>matched_fields</code>, <code>phrase_limit</code>
phrases per matched field are considered. Raising the limit increases query
time and consumes more memory. Only supported by the <code>fvh</code> highlighter.
Defaults to 256.</p>
</dd>
<dt class="hdlist1">pre_tags</dt>
<dd>
<p>Use in conjunction with <code>post_tags</code> to define the HTML tags
to use for the highlighted text. By default, highlighted text is wrapped
in <code>&lt;em&gt;</code> and <code>&lt;/em&gt;</code> tags. Specify as an array of strings.</p>
</dd>
<dt class="hdlist1">post_tags</dt>
<dd>
<p>Use in conjunction with <code>pre_tags</code> to define the HTML tags
to use for the highlighted text. By default, highlighted text is wrapped
in <code>&lt;em&gt;</code> and <code>&lt;/em&gt;</code> tags. Specify as an array of strings.</p>
</dd>
<dt class="hdlist1">require_field_match</dt>
<dd>
<p>By default, only fields that contains a query match are
highlighted. Set <code>require_field_match</code> to <code>false</code> to highlight all fields.
Defaults to <code>true</code>.</p>
</dd>
<dt class="hdlist1">tags_schema</dt>
<dd>
<p>Set to <code>styled</code> to use the built-in tag schema. The <code>styled</code>
schema defines the following <code>pre_tags</code> and defines <code>post_tags</code> as
<code>&lt;/em&gt;</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;em class="hlt1"&gt;, &lt;em class="hlt2"&gt;, &lt;em class="hlt3"&gt;,
&lt;em class="hlt4"&gt;, &lt;em class="hlt5"&gt;, &lt;em class="hlt6"&gt;,
&lt;em class="hlt7"&gt;, &lt;em class="hlt8"&gt;, &lt;em class="hlt9"&gt;,
&lt;em class="hlt10"&gt;</code></pre>
</div>
</div>
</dd>
</dl>
</div>
<div id="highlighter-type" class="dlist">
<dl>
<dt class="hdlist1">type</dt>
<dd>
<p>The highlighter to use: <code>unified</code>, <code>plain</code>, or <code>fvh</code>. Defaults to
<code>unified</code>.</p>
</dd>
</dl>
</div>
<h3 id="highlighting-examples" class="discrete">Highlighting examples</h3>
<div class="ulist">
<ul>
<li>
<p><a href="highlighting.html#override-global-settings">Override global settings</a></p>
</li>
<li>
<p><a href="highlighting.html#specify-highlight-query">Specify a highlight query</a></p>
</li>
<li>
<p><a href="highlighting.html#set-highlighter-type">Set highlighter type</a></p>
</li>
<li>
<p><a href="highlighting.html#configure-tags">Configure highlighting tags</a></p>
</li>
<li>
<p><a href="highlighting.html#highlight-source">Highlight source</a></p>
</li>
<li>
<p><a href="highlighting.html#highlight-all">Highlight all fields</a></p>
</li>
<li>
<p><a href="highlighting.html#matched-fields">Combine matches on multiple fields</a></p>
</li>
<li>
<p><a href="highlighting.html#explicit-field-order">Explicitly order highlighted fields</a></p>
</li>
<li>
<p><a href="highlighting.html#control-highlighted-frags">Control highlighted fragments</a></p>
</li>
<li>
<p><a href="highlighting.html#highlight-postings-list">Highlight using the postings list</a></p>
</li>
<li>
<p><a href="highlighting.html#specify-fragmenter">Specify a fragmenter for the plain highlighter</a></p>
</li>
</ul>
</div>
<h2 id="override-global-settings" class="discrete">Override global settings</h2>
<div class="paragraph">
<p>You can specify highlighter settings globally and selectively override them for
individual fields.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "number_of_fragments" : 3,
    "fragment_size" : 150,
    "fields" : {
      "body" : { "pre_tags" : ["&lt;em&gt;"], "post_tags" : ["&lt;/em&gt;"] },
      "blog.title" : { "number_of_fragments" : 0 },
      "blog.author" : { "number_of_fragments" : 0 },
      "blog.comment" : { "number_of_fragments" : 5, "order" : "score" }
    }
  }
}</code></pre>
</div>
</div>
<h2 id="specify-highlight-query" class="discrete">Specify a highlight query</h2>
<div class="paragraph">
<p>You can specify a <code>highlight_query</code> to take additional information into account
when highlighting. For example, the following query includes both the search
query and rescore query in the <code>highlight_query</code>. Without the <code>highlight_query</code>,
highlighting would only take the search query into account.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "match": {
      "comment": {
        "query": "foo bar"
      }
    }
  },
  "rescore": {
    "window_size": 50,
    "query": {
      "rescore_query": {
        "match_phrase": {
          "comment": {
            "query": "foo bar",
            "slop": 1
          }
        }
      },
      "rescore_query_weight": 10
    }
  },
  "_source": false,
  "highlight": {
    "order": "score",
    "fields": {
      "comment": {
        "fragment_size": 150,
        "number_of_fragments": 3,
        "highlight_query": {
          "bool": {
            "must": {
              "match": {
                "comment": {
                  "query": "foo bar"
                }
              }
            },
            "should": {
              "match_phrase": {
                "comment": {
                  "query": "foo bar",
                  "slop": 1,
                  "boost": 10.0
                }
              }
            },
            "minimum_should_match": 0
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<h2 id="set-highlighter-type" class="discrete">Set highlighter type</h2>
<div class="paragraph">
<p>The <code>type</code> field allows to force a specific highlighter type.
The allowed values are: <code>unified</code>, <code>plain</code> and <code>fvh</code>.
The following is an example that forces the use of the plain highlighter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "match": { "user.id": "bilbo" }
  },
  "highlight": {
    "fields": {
      "comment": { "type": "plain" }
    }
  }
}</code></pre>
</div>
</div>
<h2 id="configure-tags" class="discrete">Configure highlighting tags</h2>
<div class="paragraph">
<p>By default, the highlighting will wrap highlighted text in <code>&lt;em&gt;</code> and
<code>&lt;/em&gt;</code>. This can be controlled by setting <code>pre_tags</code> and <code>post_tags</code>,
for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "pre_tags" : ["&lt;tag1&gt;"],
    "post_tags" : ["&lt;/tag1&gt;"],
    "fields" : {
      "body" : {}
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using the fast vector highlighter, you can specify additional tags and the
"importance" is ordered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "pre_tags" : ["&lt;tag1&gt;", "&lt;tag2&gt;"],
    "post_tags" : ["&lt;/tag1&gt;", "&lt;/tag2&gt;"],
    "fields" : {
      "body" : {}
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use the built-in <code>styled</code> tag schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "tags_schema" : "styled",
    "fields" : {
      "comment" : {}
    }
  }
}</code></pre>
</div>
</div>
<h2 id="highlight-source" class="discrete">Highlight on source</h2>
<div class="paragraph">
<p>Forces the highlighting to highlight fields based on the source even if fields
are stored separately. Defaults to <code>false</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "fields" : {
      "comment" : {"force_source" : true}
    }
  }
}</code></pre>
</div>
</div>
<h2 id="highlight-all" class="discrete">Highlight in all fields</h2>
<div class="paragraph">
<p>By default, only fields that contains a query match are highlighted. Set
<code>require_field_match</code> to <code>false</code> to highlight all fields.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "require_field_match": false,
    "fields": {
      "body" : { "pre_tags" : ["&lt;em&gt;"], "post_tags" : ["&lt;/em&gt;"] }
    }
  }
}</code></pre>
</div>
</div>
<h2 id="matched-fields" class="discrete">Combine matches on multiple fields</h2>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
This is only supported by the <code>fvh</code> highlighter
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Fast Vector Highlighter can combine matches on multiple fields to
highlight a single field.  This is most intuitive for multifields that
analyze the same string in different ways.  All <code>matched_fields</code> must have
<code>term_vector</code> set to <code>with_positions_offsets</code> but only the field to which
the matches are combined is loaded so only that field would benefit from having
<code>store</code> set to <code>yes</code>.</p>
</div>
<div class="paragraph">
<p>In the following examples, <code>comment</code> is analyzed by the <code>english</code>
analyzer and <code>comment.plain</code> is analyzed by the <code>standard</code> analyzer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "query_string": {
      "query": "comment.plain:running scissors",
      "fields": [ "comment" ]
    }
  },
  "highlight": {
    "order": "score",
    "fields": {
      "comment": {
        "matched_fields": [ "comment", "comment.plain" ],
        "type": "fvh"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above matches both "run with scissors" and "running with scissors"
and would highlight "running" and "scissors" but not "run". If both
phrases appear in a large document then "running with scissors" is
sorted above "run with scissors" in the fragments list because there
are more matches in that fragment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "query_string": {
      "query": "running scissors",
      "fields": ["comment", "comment.plain^10"]
    }
  },
  "highlight": {
    "order": "score",
    "fields": {
      "comment": {
        "matched_fields": ["comment", "comment.plain"],
        "type" : "fvh"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above highlights "run" as well as "running" and "scissors" but
still sorts "running with scissors" above "run with scissors" because
the plain match ("running") is boosted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "query_string": {
      "query": "running scissors",
      "fields": [ "comment", "comment.plain^10" ]
    }
  },
  "highlight": {
    "order": "score",
    "fields": {
      "comment": {
        "matched_fields": [ "comment.plain" ],
        "type": "fvh"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above query wouldn&#8217;t highlight "run" or "scissor" but shows that
it is just fine not to list the field to which the matches are combined
(<code>comment</code>) in the matched fields.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Technically it is also fine to add fields to <code>matched_fields</code> that
don&#8217;t share the same underlying string as the field to which the matches
are combined.  The results might not make much sense and if one of the
matches is off the end of the text then the whole query will fail.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>There is a small amount of overhead involved with setting
<code>matched_fields</code> to a non-empty array so always prefer</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">    "highlight": {
        "fields": {
            "comment": {}
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>to</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">    "highlight": {
        "fields": {
            "comment": {
                "matched_fields": ["comment"],
                "type" : "fvh"
            }
        }
    }</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<h2 id="explicit-field-order" class="discrete">Explicitly order highlighted fields</h2>
<div class="paragraph">
<p>OpenSearch highlights the fields in the order that they are sent, but per the
JSON spec, objects are unordered.  If you need to be explicit about the order
in which fields are highlighted specify the <code>fields</code> as an array:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "highlight": {
    "fields": [
      { "title": {} },
      { "text": {} }
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>None of the highlighters built into OpenSearch care about the order that the
fields are highlighted but a plugin might.</p>
</div>
<h2 id="control-highlighted-frags" class="discrete">Control highlighted fragments</h2>
<div class="paragraph">
<p>Each field highlighted can control the size of the highlighted fragment
in characters (defaults to <code>100</code>), and the maximum number of fragments
to return (defaults to <code>5</code>).
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "fields" : {
      "comment" : {"fragment_size" : 150, "number_of_fragments" : 3}
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>On top of this it is possible to specify that highlighted fragments need
to be sorted by score:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "order" : "score",
    "fields" : {
      "comment" : {"fragment_size" : 150, "number_of_fragments" : 3}
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>number_of_fragments</code> value is set to <code>0</code> then no fragments are
produced, instead the whole content of the field is returned, and of
course it is highlighted. This can be very handy if short texts (like
document title or address) need to be highlighted but no fragmentation
is required. Note that <code>fragment_size</code> is ignored in this case.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query" : {
    "match": { "user.id": "bilbo" }
  },
  "highlight" : {
    "fields" : {
      "body" : {},
      "blog.title" : {"number_of_fragments" : 0}
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using <code>fvh</code> one can use <code>fragment_offset</code>
parameter to control the margin to start highlighting from.</p>
</div>
<div class="paragraph">
<p>In the case where there is no matching fragment to highlight, the default is
to not return anything. Instead, we can return a snippet of text from the
beginning of the field by setting <code>no_match_size</code> (default <code>0</code>) to the length
of the text that you want returned. The actual length may be shorter or longer than
specified as it tries to break on a word boundary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "match": { "user.id": "bilbo" }
  },
  "highlight": {
    "fields": {
      "comment": {
        "fragment_size": 150,
        "number_of_fragments": 3,
        "no_match_size": 150
      }
    }
  }
}</code></pre>
</div>
</div>
<h2 id="highlight-postings-list" class="discrete">Highlight using the postings list</h2>
<div class="paragraph">
<p>Here is an example of setting the <code>comment</code> field in the index mapping to
allow for highlighting using the postings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /example
{
  "mappings": {
    "properties": {
      "comment" : {
        "type": "text",
        "index_options" : "offsets"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is an example of setting the <code>comment</code> field to allow for
highlighting using the <code>term_vectors</code> (this will cause the index to be bigger):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /example
{
  "mappings": {
    "properties": {
      "comment" : {
        "type": "text",
        "term_vector" : "with_positions_offsets"
      }
    }
  }
}</code></pre>
</div>
</div>
<h2 id="specify-fragmenter" class="discrete">Specify a fragmenter for the plain highlighter</h2>
<div class="paragraph">
<p>When using the <code>plain</code> highlighter, you can choose between the <code>simple</code> and
<code>span</code> fragmenters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET my-index-000001/_search
{
  "query": {
    "match_phrase": { "message": "number 1" }
  },
  "highlight": {
    "fields": {
      "message": {
        "type": "plain",
        "fragment_size": 15,
        "number_of_fragments": 3,
        "fragmenter": "simple"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console-result" data-lang="console-result">{
  ...
  "hits": {
    "total": {
      "value": 1,
      "relation": "eq"
    },
    "max_score": 1.6011951,
    "hits": [
      {
        "_index": "my-index-000001",
        "_type": "_doc",
        "_id": "1",
        "_score": 1.6011951,
        "_source": {
          "message": "some message with the number 1"
        },
        "highlight": {
          "message": [
            " with the &lt;em&gt;number&lt;/em&gt;",
            " &lt;em&gt;1&lt;/em&gt;"
          ]
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET my-index-000001/_search
{
  "query": {
    "match_phrase": { "message": "number 1" }
  },
  "highlight": {
    "fields": {
      "message": {
        "type": "plain",
        "fragment_size": 15,
        "number_of_fragments": 3,
        "fragmenter": "span"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console-result" data-lang="console-result">{
  ...
  "hits": {
    "total": {
      "value": 1,
      "relation": "eq"
    },
    "max_score": 1.6011951,
    "hits": [
      {
        "_index": "my-index-000001",
        "_type": "_doc",
        "_id": "1",
        "_score": 1.6011951,
        "_source": {
          "message": "some message with the number 1"
        },
        "highlight": {
          "message": [
            " with the &lt;em&gt;number&lt;/em&gt; &lt;em&gt;1&lt;/em&gt;"
          ]
        }
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>number_of_fragments</code> option is set to <code>0</code>,
<code>NullFragmenter</code> is used which does not fragment the text at all.
This is useful for highlighting the entire contents of a document or field.</p>
</div>
<h2 id="how-opensearch-highlighters-work-internally" class="discrete">How highlighters work internally</h2>
<div class="paragraph">
<p>Given a query and a text (the content of a document field), the goal of a
highlighter is to find the best text fragments for the query, and highlight
the query terms in the found fragments. For this, a highlighter needs to
address several questions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How break a text into fragments?</p>
</li>
<li>
<p>How to find the best fragments among all fragments?</p>
</li>
<li>
<p>How to highlight the query terms in a fragment?</p>
</li>
</ul>
</div>
<h3 id="_how_to_break_a_text_into_fragments" class="discrete">How to break a text into fragments?</h3>
<div class="paragraph">
<p>Relevant settings: <code>fragment_size</code>, <code>fragmenter</code>, <code>type</code> of highlighter,
<code>boundary_chars</code>, <code>boundary_max_scan</code>, <code>boundary_scanner</code>, <code>boundary_scanner_locale</code>.</p>
</div>
<div class="paragraph">
<p>Plain highlighter begins with analyzing the text using the given analyzer,
and creating a token stream from it. Plain highlighter uses a very simple
algorithm to break the token stream into fragments. It loops through terms in the token stream,
and every time the current term&#8217;s end_offset exceeds <code>fragment_size</code> multiplied by the number of
created fragments, a new fragment is created. A little more computation is done with using <code>span</code>
fragmenter to avoid breaking up text between highlighted terms. But overall, since the breaking is
done only by <code>fragment_size</code>, some fragments can be quite odd, e.g. beginning
with a punctuation mark.</p>
</div>
<div class="paragraph">
<p>Unified or FVH highlighters do a better job of breaking up a text into
fragments by utilizing Java&#8217;s <code>BreakIterator</code>. This ensures that a fragment
is a valid sentence as long as <code>fragment_size</code> allows for this.</p>
</div>
<h3 id="_how_to_find_the_best_fragments" class="discrete">How to find the best fragments?</h3>
<div class="paragraph">
<p>Relevant settings: <code>number_of_fragments</code>.</p>
</div>
<div class="paragraph">
<p>To find the best, most relevant, fragments, a highlighter needs to score
each fragment in respect to the given query. The goal is to score only those
terms that participated in generating the 'hit' on the document.
For some complex queries, this is still work in progress.</p>
</div>
<div class="paragraph">
<p>The plain highlighter creates an in-memory index from the current token stream,
and re-runs the original query criteria through Lucene&#8217;s query execution planner
to get access to low-level match information for the current text.
For more complex queries the original query could be converted to a span query,
as span queries can handle phrases more accurately. Then this obtained low-level match
information is used to score each individual fragment. The scoring method of the plain
highlighter is quite simple. Each fragment is scored by the number of unique
query terms found in this fragment. The score of individual term is equal to its boost,
which is by default is 1. Thus, by default, a fragment that contains one unique query term,
will get a score of 1; and a fragment that contains two unique query terms,
will get a score of 2 and so on. The fragments are then sorted by their scores,
so the highest scored fragments will be output first.</p>
</div>
<div class="paragraph">
<p>FVH doesn&#8217;t need to analyze the text and build an in-memory index, as it uses
pre-indexed document term vectors, and finds among them terms that correspond to the query.
FVH scores each fragment by the number of query terms found in this fragment.
Similarly to plain highlighter, score of individual term is equal to its boost value.
In contrast to plain highlighter, all query terms are counted, not only unique terms.</p>
</div>
<div class="paragraph">
<p>Unified highlighter can use pre-indexed term vectors or pre-indexed terms offsets,
if they are available. Otherwise, similar to Plain Highlighter, it has to create
an in-memory index from the text. Unified highlighter uses the BM25 scoring model
to score fragments.</p>
</div>
<h3 id="_how_to_highlight_the_query_terms_in_a_fragment" class="discrete">How to highlight the query terms in a fragment?</h3>
<div class="paragraph">
<p>Relevant settings:  <code>pre-tags</code>, <code>post-tags</code>.</p>
</div>
<div class="paragraph">
<p>The goal is to highlight only those terms that participated in generating the 'hit' on the document.
For some complex boolean queries, this is still work in progress, as highlighters don&#8217;t reflect
the boolean logic of a query and only extract leaf (terms, phrases, prefix etc) queries.</p>
</div>
<div class="paragraph">
<p>Plain highlighter given the token stream and the original text, recomposes the original text to
highlight only terms from the token stream that are contained in the low-level match information
structure from the previous step.</p>
</div>
<div class="paragraph">
<p>FVH and unified highlighter use intermediate data structures to represent
fragments in some raw form, and then populate them with actual text.</p>
</div>
<div class="paragraph">
<p>A highlighter uses <code>pre-tags</code>, <code>post-tags</code> to encode highlighted terms.</p>
</div>
<h3 id="_an_example_of_the_work_of_the_unified_highlighter" class="discrete">An example of the work of the unified highlighter</h3>
<div class="paragraph">
<p>Let&#8217;s look in more details how unified highlighter works.</p>
</div>
<div class="paragraph">
<p>First, we create a index with a text field <code>content</code>, that will be indexed
using <code>english</code> analyzer, and will be indexed without offsets or term vectors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">PUT test_index
{
  "mappings": {
    "properties": {
      "content": {
        "type": "text",
        "analyzer": "english"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We put the following document into the index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">PUT test_index/_doc/doc1
{
  "content" : "For you I'm only a fox like a hundred thousand other foxes. But if you tame me, we'll need each other. You'll be the only boy in the world for me. I'll be the only fox in the world for you."
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And we ran the following query with a highlight request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">GET test_index/_search
{
  "query": {
    "match_phrase" : {"content" : "only fox"}
  },
  "highlight": {
    "type" : "unified",
    "number_of_fragments" : 3,
    "fields": {
      "content": {}
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After <code>doc1</code> is found as a hit for this query, this hit will be passed to the
unified highlighter for highlighting the field <code>content</code> of the document.
Since the field <code>content</code> was not indexed either with offsets or term vectors,
its raw field value will be analyzed, and in-memory index will be built from
the terms that match the query:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{"token":"onli","start_offset":12,"end_offset":16,"position":3},
{"token":"fox","start_offset":19,"end_offset":22,"position":5},
{"token":"fox","start_offset":53,"end_offset":58,"position":11},
{"token":"onli","start_offset":117,"end_offset":121,"position":24},
{"token":"onli","start_offset":159,"end_offset":163,"position":34},
{"token":"fox","start_offset":164,"end_offset":167,"position":35}</pre>
</div>
</div>
<div class="paragraph">
<p>Our complex phrase query will be converted to the span query:
<code>spanNear([text:onli, text:fox], 0, true)</code>, meaning that we are looking for
terms "onli: and "fox" within 0 distance from each other, and in the given
order. The span query will be run against the created before in-memory index,
to find the following match:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>{"term":"onli", "start_offset":159, "end_offset":163},
{"term":"fox", "start_offset":164, "end_offset":167}</pre>
</div>
</div>
<div class="paragraph">
<p>In our example, we have got a single match, but there could be several matches.
Given the matches, the unified highlighter breaks the text of the field into
so called "passages". Each passage must contain at least one match.
The unified highlighter with the use of Java&#8217;s <code>BreakIterator</code> ensures that each
passage represents a full sentence as long as it doesn&#8217;t exceed <code>fragment_size</code>.
For our example, we have got a single passage with the following properties
(showing only a subset of the properties here):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Passage:
    startOffset: 147
    endOffset: 189
    score: 3.7158387
    matchStarts: [159, 164]
    matchEnds: [163, 167]
    numMatches: 2</pre>
</div>
</div>
<div class="paragraph">
<p>Notice how a passage has a score, calculated using the BM25 scoring formula
adapted for passages. Scores allow us to choose the best scoring
passages if there are more passages available than the requested
by the user <code>number_of_fragments</code>. Scores also let us to sort passages by
<code>order: "score"</code> if requested by the user.</p>
</div>
<div class="paragraph">
<p>As the final step, the unified highlighter will extract from the field&#8217;s text
a string corresponding to each passage:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"I'll be the only fox in the world for you."</pre>
</div>
</div>
<div class="paragraph">
<p>and will format with the tags &lt;em&gt; and &lt;/em&gt; all matches in this string
using the passages&#8217;s <code>matchStarts</code> and <code>matchEnds</code> information:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>I'll be the &lt;em&gt;only&lt;/em&gt; &lt;em&gt;fox&lt;/em&gt; in the world for you.</pre>
</div>
</div>
<div class="paragraph">
<p>This kind of formatted strings are the final result of the highlighter returned
to the user.</p>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>← Previous: <a href="filter-search-results.html">Filter search results</a> | ↑ Up: <a href="search-your-data.html">Search your data</a> | ⌂ Home: <a href="index.html">OpenSearch Reference</a> | Next: <a href="near-real-time.html">Near real-time search</a> →</p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-04-12 14:08:20 -0700
</div>
</div>
</body>
</html>