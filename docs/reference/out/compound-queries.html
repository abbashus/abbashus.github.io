<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>OpenSearch Reference</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="compound-queries" class="book toc2 toc-left">
<div id="header">
<h1>OpenSearch Reference</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">OpenSearch Reference</a></span></p><ul class="sectlevel1">
<li><a href="opensearch-intro.html">What is OpenSearch?</a>
</li>
<li><a href="getting-started.html">Getting started with OpenSearch</a>
</li>
<li><a href="setup.html">Set up OpenSearch</a>
</li>
<li><a href="setup-upgrade.html">Upgrade OpenSearch</a>
</li>
<li><a href="index-modules.html">Index modules</a>
</li>
<li><a href="mapping.html">Mapping</a>
</li>
<li><a href="analysis.html">Text analysis</a>
</li>
<li><a href="index-templates.html">Index templates</a>
</li>
<li><a href="ingest.html">Ingest node</a>
</li>
<li><a href="search-your-data.html">Search your data</a>
</li>
<li><a href="query-dsl.html">Query DSL</a>
<ul class="sectlevel1">
<li><a href="query-filter-context.html">Query and filter context</a>
</li>
<li><a href="compound-queries.html"><span class="toc-current">Compound queries</span></a>
<ul class="sectlevel2">
<li><a href="compound-queries.html#query-dsl-bool-query">Boolean query</a>
</li>
<li><a href="compound-queries.html#query-dsl-boosting-query">Boosting query</a>
</li>
<li><a href="compound-queries.html#query-dsl-constant-score-query">Constant score query</a>
</li>
<li><a href="compound-queries.html#query-dsl-dis-max-query">Disjunction max query</a>
</li>
<li><a href="compound-queries.html#query-dsl-function-score-query">Function score query</a>
</li>
</ul>
</li>
<li><a href="full-text-queries.html">Full text queries</a>
</li>
<li><a href="geo-queries.html">Geo queries</a>
</li>
<li><a href="joining-queries.html">Joining queries</a>
</li>
<li><a href="query-dsl-match-all-query.html">Match all query</a>
</li>
<li><a href="span-queries.html">Span queries</a>
</li>
<li><a href="specialized-queries.html">Specialized queries</a>
</li>
<li><a href="term-level-queries.html">Term-level queries</a>
</li>
<li><a href="query-dsl-minimum-should-match.html"><code>minimum_should_match</code> parameter</a>
</li>
<li><a href="query-dsl-multi-term-rewrite.html"><code>rewrite</code> parameter</a>
</li>
<li><a href="regexp-syntax.html">Regular expression syntax</a>
</li>
</ul>
</li>
<li><a href="search-aggregations.html">Aggregations</a>
</li>
<li><a href="modules-scripting.html">Scripting</a>
</li>
<li><a href="high-availability.html">Set up a cluster for high availability</a>
</li>
<li><a href="snapshot-restore.html">Snapshot and restore</a>
</li>
<li><a href="commands.html">Command line tools</a>
</li>
<li><a href="how-to.html">How To</a>
</li>
<li><a href="glossary.html">Glossary of terms</a>
</li>
<li><a href="rest-apis.html">REST APIs</a>
</li>
<li><a href="breaking-changes.html">Migration guide</a>
</li>
<li><a href="opensearch-release-notes.html">Release notes</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="compound-queries">Compound queries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Compound queries wrap other compound or leaf queries, either to combine their
results and scores, to change their behaviour, or to switch from query to
filter context.</p>
</div>
<div class="paragraph">
<p>The queries in this group are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="compound-queries.html#query-dsl-bool-query"><code>bool</code> query</a></dt>
<dd>
<p>The default query for combining multiple leaf or compound query clauses, as
<code>must</code>, <code>should</code>, <code>must_not</code>, or <code>filter</code> clauses.  The <code>must</code> and <code>should</code>
clauses have their scores combined&#8201;&#8212;&#8201;the more matching clauses, the better&#8201;&#8212;&#8201;while the <code>must_not</code> and <code>filter</code> clauses are executed in filter context.</p>
</dd>
<dt class="hdlist1"><a href="compound-queries.html#query-dsl-boosting-query"><code>boosting</code> query</a></dt>
<dd>
<p>Return documents which match a <code>positive</code> query, but reduce the score of
documents which also match a <code>negative</code> query.</p>
</dd>
<dt class="hdlist1"><a href="compound-queries.html#query-dsl-constant-score-query"><code>constant_score</code> query</a></dt>
<dd>
<p>A query which wraps another query, but executes it in filter context.  All
matching documents are given the same <code>`constant'' `_score</code>.</p>
</dd>
<dt class="hdlist1"><a href="compound-queries.html#query-dsl-dis-max-query"><code>dis_max</code> query</a></dt>
<dd>
<p>A query which accepts multiple queries, and returns any documents which match
any of the query clauses.  While the <code>bool</code> query combines the scores from all
matching queries, the <code>dis_max</code> query uses the score of the single best-
matching query clause.</p>
</dd>
<dt class="hdlist1"><a href="compound-queries.html#query-dsl-function-score-query"><code>function_score</code> query</a></dt>
<dd>
<p>Modify the scores returned by the main query with functions to take into
account factors like popularity, recency, distance, or custom algorithms
implemented with scripting.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="query-dsl-bool-query">Boolean query</h3>
<titleabbrev>Boolean</titleabbrev>
<div class="paragraph">
<p>A query that matches documents matching boolean combinations of other
queries. The bool query maps to Lucene <code>BooleanQuery</code>. It is built using
one or more boolean clauses, each clause with a typed occurrence. The
occurrence types are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Occur</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>must</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The clause (query) must appear in matching documents and will
contribute to the score.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>filter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The clause (query) must appear in matching documents. However unlike
<code>must</code> the score of the query will be ignored. Filter clauses are executed
in <a href="query-filter-context.html">filter context</a>, meaning that scoring is ignored
and clauses are considered for caching.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>should</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The clause (query) should appear in the matching document.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>must_not</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The clause (query) must not appear in the matching
documents.  Clauses are executed in <a href="query-filter-context.html">filter context</a> meaning
that scoring is ignored and clauses are considered for caching. Because scoring is
ignored, a score of <code>0</code> for all documents is returned.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>bool</code> query takes a <em>more-matches-is-better</em> approach, so the score from
each matching <code>must</code> or <code>should</code> clause will be added together to provide the
final <code>_score</code> for each document.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">POST _search
{
  "query": {
    "bool" : {
      "must" : {
        "term" : { "user.id" : "bilbo" }
      },
      "filter": {
        "term" : { "tags" : "production" }
      },
      "must_not" : {
        "range" : {
          "age" : { "gte" : 10, "lte" : 20 }
        }
      },
      "should" : [
        { "term" : { "tags" : "env1" } },
        { "term" : { "tags" : "deployed" } }
      ],
      "minimum_should_match" : 1,
      "boost" : 1.0
    }
  }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="bool-min-should-match">Using <code>minimum_should_match</code></h4>
<div class="paragraph">
<p>You can use the <code>minimum_should_match</code> parameter to specify the number or
percentage of <code>should</code> clauses returned documents <em>must</em> match.</p>
</div>
<div class="paragraph">
<p>If the <code>bool</code> query includes at least one <code>should</code> clause and no <code>must</code> or
<code>filter</code> clauses, the default value is <code>1</code>.
Otherwise, the default value is <code>0</code>.</p>
</div>
<div class="paragraph">
<p>For other valid values, see the
<a href="query-dsl-minimum-should-match.html"><code>minimum_should_match</code> parameter</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="score-bool-filter">Scoring with <code>bool.filter</code></h4>
<div class="paragraph">
<p>Queries specified under the <code>filter</code> element have no effect on scoring&#8201;&#8212;&#8201;scores are returned as <code>0</code>.  Scores are only affected by the query that has
been specified.  For instance, all three of the following queries return
all documents where the <code>status</code> field contains the term <code>active</code>.</p>
</div>
<div class="paragraph">
<p>This first query assigns a score of <code>0</code> to all documents, as no scoring
query has been specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET _search
{
  "query": {
    "bool": {
      "filter": {
        "term": {
          "status": "active"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <code>bool</code> query has a <code>match_all</code> query, which assigns a score of <code>1.0</code> to
all documents.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET _search
{
  "query": {
    "bool": {
      "must": {
        "match_all": {}
      },
      "filter": {
        "term": {
          "status": "active"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <code>constant_score</code> query behaves in exactly the same way as the second example above.
The <code>constant_score</code> query assigns a score of <code>1.0</code> to all documents matched
by the filter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET _search
{
  "query": {
    "constant_score": {
      "filter": {
        "term": {
          "status": "active"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="named-queries">Named queries</h4>
<div class="paragraph">
<p>Each query accepts a <code>_name</code> in its top level definition. You can use named
queries to track which queries matched returned documents. If named queries are
used, the response includes a <code>matched_queries</code> property for each hit.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "bool": {
      "should": [
        { "match": { "name.first": { "query": "john", "_name": "first" } } },
        { "match": { "name.last": { "query": "doe", "_name": "last" } } }
      ],
      "filter": {
        "terms": {
          "name.last": [ "doe", "roe" ],
          "_name": "test"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="query-dsl-boosting-query">Boosting query</h3>
<titleabbrev>Boosting</titleabbrev>
<div class="paragraph">
<p>Returns documents matching a <code>positive</code> query while reducing the
<a href="query-filter-context.html#relevance-scores">relevance score</a> of documents that also match a
<code>negative</code> query.</p>
</div>
<div class="paragraph">
<p>You can use the <code>boosting</code> query to demote certain documents without
excluding them from the search results.</p>
</div>
<div class="sect3">
<h4 id="boosting-query-ex-request">Example request</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "boosting": {
      "positive": {
        "term": {
          "text": "apple"
        }
      },
      "negative": {
        "term": {
          "text": "pie tart fruit crumble tree"
        }
      },
      "negative_boost": 0.5
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="boosting-top-level-params">Top-level parameters for <code>boosting</code></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>positive</code></dt>
<dd>
<p>(Required, query object) Query you wish to run. Any returned documents must
match this query.</p>
</dd>
<dt class="hdlist1"><code>negative</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(Required, query object) Query used to decrease the <a href="query-filter-context.html#relevance-scores">relevance
score</a> of matching documents.</p>
</div>
<div class="paragraph">
<p>If a returned document matches the <code>positive</code> query and this query, the
<code>boosting</code> query calculates the final <a href="query-filter-context.html#relevance-scores">relevance score</a> for
the document as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Take the original relevance score from the <code>positive</code> query.</p>
</li>
<li>
<p>Multiply the score by the <code>negative_boost</code> value.</p>
</li>
</ol>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>negative_boost</code></dt>
<dd>
<p>(Required, float) Floating point number between <code>0</code> and <code>1.0</code> used to decrease
the <a href="query-filter-context.html#relevance-scores">relevance scores</a> of documents matching the
<code>negative</code> query.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="query-dsl-constant-score-query">Constant score query</h3>
<titleabbrev>Constant score</titleabbrev>
<div class="paragraph">
<p>Wraps a <a href="compound-queries.html#query-dsl-bool-query">filter query</a> and returns every matching
document with a <a href="query-filter-context.html#relevance-scores">relevance score</a> equal to the <code>boost</code>
parameter value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "constant_score": {
      "filter": {
        "term": { "user.id": "bilbo" }
      },
      "boost": 1.2
    }
  }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="constant-score-top-level-params">Top-level parameters for <code>constant_score</code></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>filter</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(Required, query object) <a href="compound-queries.html#query-dsl-bool-query">Filter query</a> you wish to run.
Any returned documents must match this query.</p>
</div>
<div class="paragraph">
<p>Filter queries do not calculate <a href="query-filter-context.html#relevance-scores">relevance scores</a>. To
speed up performance, OpenSearch automatically caches frequently used filter queries.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>boost</code></dt>
<dd>
<p>(Optional, float) Floating point number used as the constant
<a href="query-filter-context.html#relevance-scores">relevance score</a> for every document matching the
<code>filter</code> query. Defaults to <code>1.0</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="query-dsl-dis-max-query">Disjunction max query</h3>
<titleabbrev>Disjunction max</titleabbrev>
<div class="paragraph">
<p>Returns documents matching one or more wrapped queries, called query clauses or
clauses.</p>
</div>
<div class="paragraph">
<p>If a returned document matches multiple query clauses, the <code>dis_max</code> query
assigns the document the highest relevance score from any matching clause, plus
a tie breaking increment for any additional matching subqueries.</p>
</div>
<div class="paragraph">
<p>You can use the <code>dis_max</code> to search for a term in fields mapped with different
<a href="mapping-params.html#mapping-boost">boost</a> factors.</p>
</div>
<div class="sect3">
<h4 id="query-dsl-dis-max-query-ex-request">Example request</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "dis_max": {
      "queries": [
        { "term": { "title": "Quick pets" } },
        { "term": { "body": "Quick pets" } }
      ],
      "tie_breaker": 0.7
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="query-dsl-dis-max-query-top-level-params">Top-level parameters for <code>dis_max</code></h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>queries</code></dt>
<dd>
<p>(Required, array of query objects) Contains one or more query clauses. Returned
documents <strong>must match one or more</strong> of these queries. If a document matches
multiple queries, OpenSearch uses the highest <a href="query-filter-context.html">relevance
score</a>.</p>
</dd>
<dt class="hdlist1"><code>tie_breaker</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(Optional, float) Floating point number between <code>0</code> and <code>1.0</code> used to increase
the <a href="query-filter-context.html#relevance-scores">relevance scores</a> of documents matching multiple
query clauses. Defaults to <code>0.0</code>.</p>
</div>
<div class="paragraph">
<p>You can use the <code>tie_breaker</code> value to assign higher relevance scores to
documents that contain the same term in multiple fields than documents that
contain this term in only the best of those multiple fields, without confusing
this with the better case of two different terms in the multiple fields.</p>
</div>
<div class="paragraph">
<p>If a document matches multiple clauses, the <code>dis_max</code> query calculates the
relevance score for the document as follows:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Take the relevance score from a matching clause with the highest score.</p>
</li>
<li>
<p>Multiply the score from any other matching clauses by the <code>tie_breaker</code> value.</p>
</li>
<li>
<p>Add the highest score to the multiplied scores.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the <code>tie_breaker</code> value is greater than <code>0.0</code>, all matching clauses count,
but the clause with the highest score counts most.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="query-dsl-function-score-query">Function score query</h3>
<titleabbrev>Function score</titleabbrev>
<div class="paragraph">
<p>The <code>function_score</code> allows you to modify the score of documents that are
retrieved by a query. This can be useful if, for example, a score
function is computationally expensive and it is sufficient to compute
the score on a filtered set of documents.</p>
</div>
<div class="paragraph">
<p>To use <code>function_score</code>, the user has to define a query and one or
more functions, that compute a new score for each document returned
by the query.</p>
</div>
<div class="paragraph">
<p><code>function_score</code> can be used with only one function like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "function_score": {
      "query": { "match_all": {} },
      "boost": "5",
      "random_score": {}, <b class="conum">(1)</b>
      "boost_mode": "multiply"
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>See <a href="compound-queries.html#score-functions">[score-functions]</a> for a list of supported functions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Furthermore, several functions can be combined. In this case one can
optionally choose to apply the function only if a document matches a
given filtering query</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "function_score": {
      "query": { "match_all": {} },
      "boost": "5", <b class="conum">(1)</b>
      "functions": [
        {
          "filter": { "match": { "test": "bar" } },
          "random_score": {}, <b class="conum">(2)</b>
          "weight": 23
        },
        {
          "filter": { "match": { "test": "cat" } },
          "weight": 42
        }
      ],
      "max_boost": 42,
      "score_mode": "max",
      "boost_mode": "multiply",
      "min_score": 42
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Boost for the whole query.</p>
</li>
<li>
<p>See <a href="compound-queries.html#score-functions">[score-functions]</a> for a list of supported functions.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The scores produced by the filtering query of each function do not matter.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If no filter is given with a function this is equivalent to specifying
<code>"match_all": {}</code></p>
</div>
<div class="paragraph">
<p>First, each document is scored by the defined functions. The parameter
<code>score_mode</code> specifies how the computed scores are combined:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>multiply</code>
</td>
<td class="hdlist2">
<p>scores are multiplied (default)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>sum</code>
</td>
<td class="hdlist2">
<p>scores are summed</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>avg</code>
</td>
<td class="hdlist2">
<p>scores are averaged</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>first</code>
</td>
<td class="hdlist2">
<p>the first function that has a matching filter
is applied</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>max</code>
</td>
<td class="hdlist2">
<p>maximum score is used</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>min</code>
</td>
<td class="hdlist2">
<p>minimum score is used</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Because scores can be on different scales (for example, between 0 and 1 for decay functions but arbitrary for <code>field_value_factor</code>) and also
because sometimes a different impact of functions on the score is desirable, the score of each function can be adjusted with a user defined
<code>weight</code>. The <code>weight</code> can be defined per function in the <code>functions</code> array (example above) and is multiplied with the score computed by
the respective function.
If weight is given without any other function declaration, <code>weight</code> acts as a function that simply returns the <code>weight</code>.</p>
</div>
<div class="paragraph">
<p>In case <code>score_mode</code> is set to <code>avg</code> the individual scores will be combined by a <strong>weighted</strong> average.
For example, if two functions return score 1 and 2 and their respective weights are 3 and 4, then their scores will be combined as
<code>(1*3+2*4)/(3+4)</code> and <strong>not</strong> <code>(1*3+2*4)/2</code>.</p>
</div>
<div class="paragraph">
<p>The new score can be restricted to not exceed a certain limit by setting
the <code>max_boost</code> parameter. The default for <code>max_boost</code> is FLT_MAX.</p>
</div>
<div class="paragraph">
<p>The newly computed score is combined with the score of the
query. The parameter <code>boost_mode</code> defines how:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>multiply</code>
</td>
<td class="hdlist2">
<p>query score and function score is multiplied (default)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>replace</code>
</td>
<td class="hdlist2">
<p>only function score is used, the query score is ignored</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>sum</code>
</td>
<td class="hdlist2">
<p>query score and function score are added</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>avg</code>
</td>
<td class="hdlist2">
<p>average</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>max</code>
</td>
<td class="hdlist2">
<p>max of query score and function score</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>min</code>
</td>
<td class="hdlist2">
<p>min of query score and function score</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, modifying the score does not change which documents match. To exclude
documents that do not meet a certain score threshold the <code>min_score</code> parameter can be set to the desired score threshold.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For <code>min_score</code> to work, <strong>all</strong> documents returned by the query need to be scored and then filtered out one by one.
</td>
</tr>
</table>
</div>
<div id="score-functions" class="paragraph">
<p>The <code>function_score</code> query provides several types of score functions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="compound-queries.html#function-script-score"><code>script_score</code></a></p>
</li>
<li>
<p><a href="compound-queries.html#function-weight"><code>weight</code></a></p>
</li>
<li>
<p><a href="compound-queries.html#function-random"><code>random_score</code></a></p>
</li>
<li>
<p><a href="compound-queries.html#function-field-value-factor"><code>field_value_factor</code></a></p>
</li>
<li>
<p><a href="compound-queries.html#function-decay">decay functions</a>: <code>gauss</code>, <code>linear</code>, <code>exp</code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="function-script-score">Script score</h4>
<div class="paragraph">
<p>The <code>script_score</code> function allows you to wrap another query and customize
the scoring of it optionally with a computation derived from other numeric
field values in the doc using a script expression. Here is a
simple sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "function_score": {
      "query": {
        "match": { "message": "opensearch" }
      },
      "script_score": {
        "script": {
          "source": "Math.log(2 + doc['my-int'].value)"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>In OpenSearch, all document scores are positive 32-bit floating point numbers.</p>
</div>
<div class="paragraph">
<p>If the <code>script_score</code> function produces a score with greater precision, it is
converted to the nearest 32-bit float.</p>
</div>
<div class="paragraph">
<p>Similarly, scores must be non-negative. Otherwise, OpenSearch returns an error.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On top of the different scripting field values and expression, the
<code>_score</code> script parameter can be used to retrieve the score based on the
wrapped query.</p>
</div>
<div class="paragraph">
<p>Scripts compilation is cached for faster execution. If the script has
parameters that it needs to take into account, it is preferable to reuse the
same script, and provide parameters to it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "function_score": {
      "query": {
        "match": { "message": "opensearch" }
      },
      "script_score": {
        "script": {
          "params": {
            "a": 5,
            "b": 1.2
          },
          "source": "params.a / Math.pow(params.b, doc['my-int'].value)"
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that unlike the <code>custom_score</code> query, the
score of the query is multiplied with the result of the script scoring. If
you wish to inhibit this, set <code>"boost_mode": "replace"</code></p>
</div>
</div>
<div class="sect3">
<h4 id="function-weight">Weight</h4>
<div class="paragraph">
<p>The <code>weight</code> score allows you to multiply the score by the provided
<code>weight</code>. This can sometimes be desired since boost value set on
specific queries gets normalized, while for this score function it does
not. The number value is of type float.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">"weight" : number</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="function-random">Random</h4>
<div class="paragraph">
<p>The <code>random_score</code> generates scores that are uniformly distributed from 0 up to
but not including 1. By default, it uses the internal Lucene doc ids as a
source of randomness, which is very efficient but unfortunately not
reproducible since documents might be renumbered by merges.</p>
</div>
<div class="paragraph">
<p>In case you want scores to be reproducible, it is possible to provide a <code>seed</code>
and <code>field</code>. The final score will then be computed based on this seed, the
minimum value of <code>field</code> for the considered document and a salt that is computed
based on the index name and shard id so that documents that have the same
value but are stored in different indexes get different scores. Note that
documents that are within the same shard and have the same value for <code>field</code>
will however get the same score, so it is usually desirable to use a field that
has unique values for all documents. A good default choice might be to use the
<code>_seq_no</code> field, whose only drawback is that scores will change if the document
is updated since update operations also update the value of the <code>_seq_no</code> field.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It was possible to set a seed without setting a field, but this has been
deprecated as this requires loading fielddata on the <code>_id</code> field which consumes
a lot of memory.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "function_score": {
      "random_score": {
        "seed": 10,
        "field": "_seq_no"
      }
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="function-field-value-factor">Field Value factor</h4>
<div class="paragraph">
<p>The <code>field_value_factor</code> function allows you to use a field from a document to
influence the score. It&#8217;s similar to using the <code>script_score</code> function, however,
it avoids the overhead of scripting. If used on a multi-valued field, only the
first value of the field is used in calculations.</p>
</div>
<div class="paragraph">
<p>As an example, imagine you have a document indexed with a numeric <code>my-int</code>
field and wish to influence the score of a document with this field, an example
doing so would look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "function_score": {
      "field_value_factor": {
        "field": "my-int",
        "factor": 1.2,
        "modifier": "sqrt",
        "missing": 1
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which will translate into the following formula for scoring:</p>
</div>
<div class="paragraph">
<p><code>sqrt(1.2 * doc['my-int'].value)</code></p>
</div>
<div class="paragraph">
<p>There are a number of options for the <code>field_value_factor</code> function:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>field</code>
</td>
<td class="hdlist2">
<p>Field to be extracted from the document.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>factor</code>
</td>
<td class="hdlist2">
<p>Optional factor to multiply the field value with, defaults to <code>1</code>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>modifier</code>
</td>
<td class="hdlist2">
<p>Modifier to apply to the field value, can be one of: <code>none</code>, <code>log</code>,
<code>log1p</code>, <code>log2p</code>, <code>ln</code>, <code>ln1p</code>, <code>ln2p</code>, <code>square</code>, <code>sqrt</code>, or <code>reciprocal</code>.
Defaults to <code>none</code>.</p>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Modifier</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>none</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do not apply any multiplier to the field value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Take the <a href="https://en.wikipedia.org/wiki/Common_logarithm">common logarithm</a> of the field value.
          Because this function will return a negative value and cause an error if used on values
          between 0 and 1, it is recommended to use <code>log1p</code> instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log1p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add 1 to the field value and take the common logarithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log2p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add 2 to the field value and take the common logarithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ln</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Take the <a href="https://en.wikipedia.org/wiki/Natural_logarithm">natural logarithm</a> of the field value.
         Because this function will return a negative value and cause an error if used on values
         between 0 and 1, it is recommended to use <code>ln1p</code> instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ln1p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add 1 to the field value and take the natural logarithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ln2p</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add 2 to the field value and take the natural logarithm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>square</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Square the field value (multiply it by itself)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sqrt</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Take the <a href="https://en.wikipedia.org/wiki/Square_root">square root</a> of the field value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>reciprocal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/Multiplicative_inverse">Reciprocate</a> the field value, same as <code>1/x</code> where <code>x</code> is the field&#8217;s value</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>missing</code></dt>
<dd>
<p>Value used if the document doesn&#8217;t have that field. The modifier
and factor are still applied to it as though it were read from the document.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Scores produced by the <code>field_value_score</code> function must be
non-negative, otherwise an error will be thrown. The <code>log</code> and <code>ln</code> modifiers
will produce negative values if used on values between 0 and 1. Be sure to limit
the values of the field with a range filter to avoid this, or use <code>log1p</code> and
<code>ln1p</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Keep in mind that taking the log() of 0, or the square root of a
negative number is an illegal operation, and an exception will be thrown. Be
sure to limit the values of the field with a range filter to avoid this, or use
<code>log1p</code> and <code>ln1p</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="function-decay">Decay functions</h4>
<div class="paragraph">
<p>Decay functions score a document with a function that decays depending
on the distance of a numeric field value of the document from a user
given origin. This is similar to a range query, but with smooth edges
instead of boxes.</p>
</div>
<div class="paragraph">
<p>To use distance scoring on a query that has numerical fields, the user
has to define an <code>origin</code> and a <code>scale</code> for each field. The <code>origin</code>
is needed to define the <code>`central point'' from which the distance
is calculated, and the `scale</code> to define the rate of decay. The
decay function is specified as</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">"DECAY_FUNCTION": { <b class="conum">(1)</b>
    "FIELD_NAME": { <b class="conum">(2)</b>
          "origin": "11, 12",
          "scale": "2km",
          "offset": "0km",
          "decay": 0.33
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The <code>DECAY_FUNCTION</code> should be one of <code>linear</code>, <code>exp</code>, or <code>gauss</code>.</p>
</li>
<li>
<p>The specified field must be a numeric, date, or geo-point field.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the above example, the field is a <a href="mapping-types.html#geo-point"><code>geo_point</code></a> and origin can
be provided in geo format. <code>scale</code> and <code>offset</code> must be given with a unit in
this case. If your field is a date field, you can set <code>scale</code> and <code>offset</code> as
days, weeks, and so on. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_search
{
  "query": {
    "function_score": {
      "gauss": {
        "@timestamp": {
          "origin": "2013-09-17", <b class="conum">(1)</b>
          "scale": "10d",
          "offset": "5d",         <b class="conum">(2)</b>
          "decay": 0.5            <b class="conum">(2)</b>
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The date format of the origin depends on the <a href="mapping-params.html#mapping-date-format"><code>format</code></a> defined in
your mapping. If you do not define the origin, the current time is used.</p>
</li>
<li>
<p>The <code>offset</code> and <code>decay</code> parameters are optional.</p>
</li>
</ol>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>origin</code>
</td>
<td class="hdlist2">
<p>The point of origin used for calculating distance. Must be given as a
number for numeric field, date for date fields and geo point for geo fields.
Required for geo and numeric field. For date fields the default is <code>now</code>. Date
math (for example <code>now-1h</code>) is supported for origin.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>scale</code>
</td>
<td class="hdlist2">
<p>Required for all types. Defines the distance from origin + offset at which the computed
score will equal <code>decay</code> parameter. For geo fields: Can be defined as number+unit (1km, 12m,&#8230;&#8203;).
Default unit is meters. For date fields: Can to be defined as a number+unit ("1h", "10d",&#8230;&#8203;).
Default unit is milliseconds. For numeric field: Any number.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>offset</code>
</td>
<td class="hdlist2">
<p>If an <code>offset</code> is defined, the decay function will only compute the
decay function for documents with a distance greater than the defined
<code>offset</code>. The default is 0.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>decay</code>
</td>
<td class="hdlist2">
<p>The <code>decay</code> parameter defines how documents are scored at the distance
given at <code>scale</code>. If no <code>decay</code> is defined, documents at the distance
<code>scale</code> will be scored 0.5.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the first example, your documents might represents hotels and contain a geo
location field. You want to compute a decay function depending on how
far the hotel is from a given location. You might not immediately see
what scale to choose for the gauss function, but you can say something
like: "At a distance of 2km from the desired location, the score should
be reduced to one third."
The parameter "scale" will then be adjusted automatically to assure that
the score function computes a score of 0.33 for hotels that are 2km away
from the desired location.</p>
</div>
<div class="paragraph">
<p>In the second example, documents with a field value between 2013-09-12 and 2013-09-22 would get a weight of 1.0 and documents which are 15 days from that date a weight of 0.5.</p>
</div>
<div class="sect4">
<h5 id="_supported_decay_functions">Supported decay functions</h5>
<div class="paragraph">
<p>The <code>DECAY_FUNCTION</code> determines the shape of the decay:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gauss</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Normal decay, computed as:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/Gaussian.png" alt="Gaussian"></span></p>
</div>
<div class="paragraph">
<p>where <span class="image"><img src="images/sigma.png" alt="sigma"></span> is computed to assure that the score takes the value <code>decay</code> at distance <code>scale</code> from <code>origin</code>+-<code>offset</code></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/sigma_calc.png" alt="sigma calc"></span></p>
</div>
<div class="paragraph">
<p>See <a href="#gauss-decay">[gauss-decay]</a> for graphs demonstrating the curve generated by the <code>gauss</code> function.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>exp</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Exponential decay, computed as:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/Exponential.png" alt="Exponential"></span></p>
</div>
<div class="paragraph">
<p>where again the parameter <span class="image"><img src="images/lambda.png" alt="lambda"></span> is computed to assure that the score takes the value <code>decay</code> at distance <code>scale</code> from <code>origin</code>+-<code>offset</code></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/lambda_calc.png" alt="lambda calc"></span></p>
</div>
<div class="paragraph">
<p>See <a href="#exp-decay">[exp-decay]</a> for graphs demonstrating the curve generated by the <code>exp</code> function.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>linear</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Linear decay, computed as:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/Linear.png" alt="Linear"></span>.</p>
</div>
<div class="paragraph">
<p>where again the parameter <code>s</code> is computed to assure that the score takes the value <code>decay</code> at distance <code>scale</code> from <code>origin</code>+-<code>offset</code></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/s_calc.png" alt="s calc"></span></p>
</div>
<div class="paragraph">
<p>In contrast to the normal and exponential decay, this function actually
sets the score to 0 if the field value exceeds twice the user given
scale value.</p>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For single functions the three decay functions together with their parameters can be visualized like this (the field in this example called "age"):</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="images/decay_2d.png" alt="decay 2d" width="600"></span></p>
</div>
</div>
<div class="sect4">
<h5 id="_multi_values_fields">Multi-values fields</h5>
<div class="paragraph">
<p>If a field used for computing the decay contains multiple values, per default the value closest to the origin is chosen for determining the distance.
This can be changed by setting <code>multi_value_mode</code>.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>min</code>
</td>
<td class="hdlist2">
<p>Distance is the minimum distance</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>max</code>
</td>
<td class="hdlist2">
<p>Distance is the maximum distance</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>avg</code>
</td>
<td class="hdlist2">
<p>Distance is the average distance</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>sum</code>
</td>
<td class="hdlist2">
<p>Distance is the sum of all distances</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">    "DECAY_FUNCTION": {
        "FIELD_NAME": {
              "origin": ...,
              "scale": ...
        },
        "multi_value_mode": "avg"
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_supported_fields_for_decay_functions">Supported fields for decay functions</h4>
<div class="paragraph">
<p>Only numeric, date, and geo-point fields are supported.</p>
</div>
</div>
<div class="sect3">
<h4 id="_what_if_a_field_is_missing">What if a field is missing?</h4>
<div class="paragraph">
<p>If the numeric field is missing in the document, the function will
return 1.</p>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>Previous:<a href="query-filter-context.html">Query and filter context</a>| Up:<a href="query-dsl.html">Query DSL</a>| Home:<a href="index.html">OpenSearch Reference</a>| Next:<a href="full-text-queries.html">Full text queries</a></p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-04-12 14:08:20 -0700
</div>
</div>
</body>
</html>