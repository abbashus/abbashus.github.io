<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>OpenSearch Reference</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="settings" class="book toc2 toc-left">
<div id="header">
<h1>OpenSearch Reference</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">OpenSearch Reference</a></span></p><ul class="sectlevel1">
<li><a href="opensearch-intro.html">What is OpenSearch?</a>
</li>
<li><a href="getting-started.html">Getting started with OpenSearch</a>
</li>
<li><a href="setup.html">Set up OpenSearch</a>
<ul class="sectlevel1">
<li><a href="install-opensearch.html">Installing OpenSearch</a>
</li>
<li><a href="settings.html"><span class="toc-current">Configuring OpenSearch</span></a>
<ul class="sectlevel2">
<li><a href="settings.html#jvm-options">Setting JVM options</a>
</li>
<li><a href="settings.html#secure-settings">Secure settings</a>
</li>
<li><a href="settings.html#circuit-breaker">Circuit breaker settings</a>
</li>
<li><a href="settings.html#modules-cluster">Cluster-level shard allocation and routing settings</a>
</li>
<li><a href="settings.html#modules-discovery-settings">Discovery and cluster formation settings</a>
</li>
<li><a href="settings.html#modules-fielddata">Field data cache settings</a>
</li>
<li><a href="settings.html#modules-http">HTTP</a>
</li>
<li><a href="settings.html#index-management-settings">Index management settings</a>
</li>
<li><a href="settings.html#recovery">Index recovery settings</a>
</li>
<li><a href="settings.html#indexing-buffer">Indexing buffer settings</a>
</li>
<li><a href="settings.html#modules-gateway">Local gateway settings</a>
</li>
<li><a href="settings.html#logging">Logging</a>
</li>
<li><a href="settings.html#modules-node">Node</a>
</li>
<li><a href="settings.html#modules-network">Network settings</a>
</li>
<li><a href="settings.html#query-cache">Node query cache settings</a>
</li>
<li><a href="settings.html#search-settings">Search settings</a>
</li>
<li><a href="settings.html#shard-request-cache">Shard request cache settings</a>
</li>
<li><a href="settings.html#modules-transport">Transport</a>
</li>
<li><a href="settings.html#modules-threadpool">Thread pools</a>
</li>
</ul>
</li>
<li><a href="important-settings.html">Important OpenSearch configuration</a>
</li>
<li><a href="system-config.html">Important System Configuration</a>
</li>
<li><a href="bootstrap-checks.html">Bootstrap Checks</a>
</li>
<li><a href="starting-opensearch.html">Starting OpenSearch</a>
</li>
<li><a href="stopping-opensearch.html">Stopping OpenSearch</a>
</li>
<li><a href="modules-discovery.html">Discovery and cluster formation</a>
</li>
<li><a href="add-opensearch-nodes.html">Add and remove nodes in your cluster</a>
</li>
<li><a href="restart-cluster.html">Full-cluster restart and rolling restart</a>
</li>
<li><a href="modules-remote-clusters.html">Remote clusters</a>
</li>
<li><a href="modules-plugins.html">Plugins</a>
</li>
</ul>
</li>
<li><a href="setup-upgrade.html">Upgrade OpenSearch</a>
</li>
<li><a href="index-modules.html">Index modules</a>
</li>
<li><a href="mapping.html">Mapping</a>
</li>
<li><a href="analysis.html">Text analysis</a>
</li>
<li><a href="index-templates.html">Index templates</a>
</li>
<li><a href="ingest.html">Ingest node</a>
</li>
<li><a href="search-your-data.html">Search your data</a>
</li>
<li><a href="query-dsl.html">Query DSL</a>
</li>
<li><a href="search-aggregations.html">Aggregations</a>
</li>
<li><a href="modules-scripting.html">Scripting</a>
</li>
<li><a href="high-availability.html">Set up a cluster for high availability</a>
</li>
<li><a href="snapshot-restore.html">Snapshot and restore</a>
</li>
<li><a href="commands.html">Command line tools</a>
</li>
<li><a href="how-to.html">How To</a>
</li>
<li><a href="glossary.html">Glossary of terms</a>
</li>
<li><a href="rest-apis.html">REST APIs</a>
</li>
<li><a href="breaking-changes.html">Migration guide</a>
</li>
<li><a href="opensearch-release-notes.html">Release notes</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="settings">Configuring OpenSearch</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenSearch ships with good defaults and requires very little configuration.
Most settings can be changed on a running cluster using the
<a href="cluster.html#cluster-update-settings">Cluster update settings API</a> API.</p>
</div>
<div class="paragraph">
<p>The configuration files should contain settings which are node-specific (such
as <code>node.name</code> and paths), or settings which a node requires in order to be
able to join a cluster, such as <code>cluster.name</code> and <code>network.host</code>.</p>
</div>
<h3 id="config-files-location" class="discrete">Config files location</h3>
<div class="paragraph">
<p>OpenSearch has three configuration files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>opensearch.yml</code> for configuring OpenSearch</p>
</li>
<li>
<p><code>jvm.options</code> for configuring OpenSearch JVM settings</p>
</li>
<li>
<p><code>log4j2.properties</code> for configuring OpenSearch logging</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These files are located in the config directory, whose default location depends
on whether or not the installation is from an archive distribution (<code>tar.gz</code> or
<code>zip</code>) or a package distribution (Debian or RPM packages).</p>
</div>
<div class="paragraph">
<p>For the archive distributions, the config directory location defaults to
<code>$OPENSEARCH_HOME/config</code>. The location of the config directory can be changed via the
<code>OPENSEARCH_PATH_CONF</code> environment variable as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">OPENSEARCH_PATH_CONF=/path/to/my/config ./bin/opensearch</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can <code>export</code> the <code>OPENSEARCH_PATH_CONF</code> environment variable via the
command line or via your shell profile.</p>
</div>
<div class="paragraph">
<p>For the package distributions, the config directory location defaults to
<code>/etc/opensearch</code>. The location of the config directory can also be changed
via the <code>OPENSEARCH_PATH_CONF</code> environment variable, but note that setting this in your
shell is not sufficient. Instead, this variable is sourced from
<code>/etc/default/opensearch</code> (for the Debian package) and
<code>/etc/sysconfig/opensearch</code> (for the RPM package). You will need to edit the
<code>OPENSEARCH_PATH_CONF=/etc/opensearch</code> entry in one of these files accordingly to
change the config directory location.</p>
</div>
<h3 id="_config_file_format" class="discrete">Config file format</h3>
<div class="paragraph">
<p>The configuration format is <a href="https://yaml.org/">YAML</a>. Here is an
example of changing the path of the data and logs directories:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">path:
    data: /var/lib/opensearch
    logs: /var/log/opensearch</code></pre>
</div>
</div>
<div class="paragraph">
<p>Settings can also be flattened as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">path.data: /var/lib/opensearch
path.logs: /var/log/opensearch</code></pre>
</div>
</div>
<div class="paragraph">
<p>In YAML, you can format non-scalar values as sequences:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">discovery.seed_hosts:
   - 192.168.1.10:9300
   - 192.168.1.11
   - seeds.mydomain.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>Though less common, you can also format non-scalar values as arrays:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">discovery.seed_hosts: ["192.168.1.10:9300", "192.168.1.11", "seeds.mydomain.com"]</code></pre>
</div>
</div>
<h3 id="_environment_variable_substitution" class="discrete">Environment variable substitution</h3>
<div class="paragraph">
<p>Environment variables referenced with the <code>${&#8230;&#8203;}</code> notation within the
configuration file will be replaced with the value of the environment
variable. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">node.name:    ${HOSTNAME}
network.host: ${OPENSEARCH_NETWORK_HOST}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Values for environment variables must be simple strings. Use a comma-separated string to provide values that OpenSearch will parse as a list. For example, OpenSearch will split the following string into a list of values for the <code>${HOSTNAME}</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">export HOSTNAME=“host1,host2"</code></pre>
</div>
</div>
<h3 id="cluster-setting-types" class="discrete">Cluster and node setting types</h3>
<div class="paragraph">
<p>Cluster and node settings can be categorized based on how they are configured:</p>
</div>
<div id="dynamic-cluster-setting" class="dlist">
<dl>
<dt class="hdlist1">Dynamic</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>You can configure and update dynamic settings on a running cluster using the
<a href="cluster.html#cluster-update-settings">cluster update settings API</a>. You can also configure
dynamic settings locally on an unstarted or shut down node using
<code>opensearch.yml</code>.</p>
</div>
<div class="paragraph">
<p>Updates made using the cluster update settings API can be <em>persistent</em>, which
apply across cluster restarts, or <em>transient</em>, which reset after a cluster
restart. You can also reset transient or persistent settings by assigning them
a <code>null</code> value using the API.</p>
</div>
<div class="paragraph">
<p>If you configure the same setting using multiple methods, OpenSearch applies the
settings in following order of precedence:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Transient setting</p>
</li>
<li>
<p>Persistent setting</p>
</li>
<li>
<p><code>opensearch.yml</code> setting</p>
</li>
<li>
<p>Default setting value</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For example, you can apply a transient setting to override a persistent setting
or <code>opensearch.yml</code> setting. However, a change to an <code>opensearch.yml</code>
setting will not override a defined transient or persistent setting.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
It’s best to set dynamic, cluster-wide settings with the cluster update
settings API and use <code>opensearch.yml</code> only for local configurations. Using
the cluster update settings API ensures the setting is the same on all nodes. If
you accidentally configure different settings in <code>opensearch.yml</code> on
different nodes, it can be difficult to notice discrepancies.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div id="static-cluster-setting" class="dlist">
<dl>
<dt class="hdlist1">Static</dt>
<dd>
<p>Static settings can only be configured on an unstarted or shut down node using
<code>opensearch.yml</code>.</p>
<div class="paragraph">
<p>Static settings must be set on every relevant node in the cluster.</p>
</div>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="jvm-options">Setting JVM options</h3>
<div class="paragraph">
<p>You should rarely need to change Java Virtual Machine (JVM) options. If you do,
the most likely change is setting the <a href="redirects.html#heap-size">heap size</a>. The remainder of
this document explains in detail how to set JVM options. You can set options
either with <code>jvm.options</code> files or with the <code>OPENSEARCH_JAVA_OPTS</code> environment variable.</p>
</div>
<div class="paragraph">
<p>The preferred method of setting or overriding JVM options is via JVM options
files. When installing from the tar or zip distributions, the root <code>jvm.options</code>
configuration file is <code>config/jvm.options</code> and custom JVM options files can be
added to <code>config/jvm.options.d/</code>. When installing from the Debian or RPM
packages, the root <code>jvm.options</code> configuration file is
<code>/etc/opensearch/jvm.options</code> and custom JVM options files can be added to
<code>/etc/opensearch/jvm.options.d/</code>. When using the <a href="install-opensearch.html#docker">Docker
distribution of OpenSearch</a> you can bind mount custom JVM options files into
<code>/usr/share/opensearch/config/jvm.options.d/</code>. You should never need to
modify the root <code>jvm.options</code> file instead preferring to use custom JVM options
files. The processing ordering of custom JVM options is lexicographic.</p>
</div>
<div class="paragraph">
<p>JVM options files must have the suffix '.options' and contain a line-delimited
list of JVM arguments following a special syntax:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>lines consisting of whitespace only are ignored</p>
</li>
<li>
<p>lines beginning with <code>#</code> are treated as comments and are ignored</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text"># this is a comment</code></pre>
</div>
</div>
</li>
<li>
<p>lines beginning with a <code>-</code> are treated as a JVM option that applies
independent of the version of the JVM</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">-Xmx2g</code></pre>
</div>
</div>
</li>
<li>
<p>lines beginning with a number followed by a <code>:</code> followed by a <code>-</code> are treated
as a JVM option that applies only if the version of the JVM matches the number</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">8:-Xmx2g</code></pre>
</div>
</div>
</li>
<li>
<p>lines beginning with a number followed by a <code>-</code> followed by a <code>:</code> are treated
as a JVM option that applies only if the version of the JVM is greater than or
equal to the number</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">8-:-Xmx2g</code></pre>
</div>
</div>
</li>
<li>
<p>lines beginning with a number followed by a <code>-</code> followed by a number followed
by a <code>:</code> are treated as a JVM option that applies only if the version of the
JVM falls in the range of the two numbers</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">8-9:-Xmx2g</code></pre>
</div>
</div>
</li>
<li>
<p>all other lines are rejected</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An alternative mechanism for setting Java Virtual Machine options is via the
<code>OPENSEARCH_JAVA_OPTS</code> environment variable. For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">export OPENSEARCH_JAVA_OPTS="$OPENSEARCH_JAVA_OPTS -Djava.io.tmpdir=/path/to/temp/dir"
./bin/opensearch</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using the RPM or Debian packages, <code>OPENSEARCH_JAVA_OPTS</code> can be specified in the
<a href="system-config.html#sysconfig">system configuration file</a>.</p>
</div>
<div class="paragraph">
<p>The JVM has a built-in mechanism for observing the <code>JAVA_TOOL_OPTIONS</code>
environment variable. We intentionally ignore this environment variable in our
packaging scripts. The primary reason for this is that on some OS (e.g., Ubuntu)
there are agents installed by default via this environment variable that we do
not want interfering with OpenSearch.</p>
</div>
<div class="paragraph">
<p>Additionally, some other Java programs support the <code>JAVA_OPTS</code> environment
variable. This is <strong>not</strong> a mechanism built into the JVM but instead a convention
in the ecosystem. However, we do not support this environment variable, instead
supporting setting JVM options via the <code>jvm.options</code> file or the environment
variable <code>OPENSEARCH_JAVA_OPTS</code> as above.</p>
</div>
</div>
<div class="sect2">
<h3 id="secure-settings">Secure settings</h3>
<div class="paragraph">
<p>Some settings are sensitive, and relying on filesystem permissions to protect
their values is not sufficient. For this use case, OpenSearch provides a
keystore and the <a href="opensearch-keystore.html"><code>opensearch-keystore</code> tool</a> to
manage the settings in the keystore.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Only some settings are designed to be read from the keystore. However,
the keystore has no validation to block unsupported settings. Adding unsupported
settings to the keystore causes OpenSearch to fail to start. To see whether a setting
is supported in the keystore, look for a "Secure" qualifier the setting
reference.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All the modifications to the keystore take effect only after restarting OpenSearch.</p>
</div>
<div class="paragraph">
<p>These settings, just like the regular ones in the <code>opensearch.yml</code> config file,
need to be specified on each node in the cluster. Currently, all secure settings
are node-specific settings that must have the same value on every node.</p>
</div>
<h3 id="reloadable-secure-settings" class="discrete">Reloadable secure settings</h3>
<div class="paragraph">
<p>Just like the settings values in <code>opensearch.yml</code>, changes to the keystore
contents are not automatically applied to the running OpenSearch node. Re-reading
settings requires a node restart. However, certain secure settings are marked as
<strong>reloadable</strong>. Such settings can be <a href="cluster.html#cluster-nodes-reload-secure-settings">re-read and applied on a running node</a>.</p>
</div>
<div class="paragraph">
<p>The values of all secure settings, <strong>reloadable</strong> or not, must be identical
across all cluster nodes. After making the desired secure settings changes,
using the <code>bin/opensearch-keystore add</code> command, call:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">POST _nodes/reload_secure_settings
{
  "secure_settings_password": "s3cr3t" <b class="conum">(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The password that the OpenSearch keystore is encrypted with.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This API decrypts and re-reads the entire keystore, on every cluster node,
but only the <strong>reloadable</strong> secure settings are applied. Changes to other
settings do not go into effect until the next restart. Once the call returns,
the reload has been completed, meaning that all internal data structures
dependent on these settings have been changed. Everything should look as if the
settings had the new value from the start.</p>
</div>
<div class="paragraph">
<p>When changing multiple <strong>reloadable</strong> secure settings, modify all of them on each
cluster node, then issue a <a href="cluster.html#cluster-nodes-reload-secure-settings"><code>reload_secure_settings</code></a>
call instead of reloading after each modification.</p>
</div>
<div class="paragraph">
<p>There are reloadable secure settings for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.opensearch.org/guide/en/opensearch/plugins/{branch}/repository-azure-client-settings.html">The Azure repository plugin</a></p>
</li>
<li>
<p><a href="https://www.opensearch.org/guide/en/opensearch/plugins/{branch}/discovery-ec2-usage.html#_configuring_ec2_discovery">The EC2 discovery plugin</a></p>
</li>
<li>
<p><a href="https://www.opensearch.org/guide/en/opensearch/plugins/{branch}/repository-gcs-client.html">The GCS repository plugin</a></p>
</li>
<li>
<p><a href="https://www.opensearch.org/guide/en/opensearch/plugins/{branch}/repository-s3-client.html">The S3 repository plugin</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="circuit-breaker">Circuit breaker settings</h3>
<div id="circuit-breaker-description" class="paragraph">
<p>OpenSearch contains multiple circuit breakers used to prevent operations from causing an OutOfMemoryError. Each breaker specifies a limit for how much memory it can use. Additionally, there is a parent-level breaker that specifies the total amount of memory that can be used across all breakers.</p>
</div>
<div class="paragraph">
<p>Except where noted otherwise, these settings can be dynamically updated on a
live cluster with the <a href="cluster.html#cluster-update-settings">cluster-update-settings</a> API.</p>
</div>
<h4 id="parent-circuit-breaker" class="discrete">Parent circuit breaker</h4>
<div class="paragraph">
<p>The parent-level breaker can be configured with the following settings:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>indices.breaker.total.use_real_memory</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Determines whether the parent breaker should take real
memory usage into account (<code>true</code>) or only consider the amount that is
reserved by child circuit breakers (<code>false</code>). Defaults to <code>true</code>.</p>
</dd>
</dl>
</div>
<div id="indices-breaker-total-limit" class="dlist">
<dl>
<dt class="hdlist1"><code>indices.breaker.total.limit</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Starting limit for overall parent breaker. Defaults to 70% of JVM heap if
<code>indices.breaker.total.use_real_memory</code> is <code>false</code>. If <code>indices.breaker.total.use_real_memory</code>
is <code>true</code>, defaults to 95% of the JVM heap.</p>
</dd>
</dl>
</div>
<h4 id="fielddata-circuit-breaker" class="discrete">Field data circuit breaker</h4>
<div class="paragraph">
<p>The field data circuit breaker estimates the heap memory required to load a
field into the <a href="settings.html#modules-fielddata">field data cache</a>. If loading the field would
cause the cache to exceed a predefined memory limit, the circuit breaker stops the
operation and returns an error.</p>
</div>
<div id="fielddata-circuit-breaker-limit" class="dlist">
<dl>
<dt class="hdlist1"><code>indices.breaker.fielddata.limit</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Limit for fielddata breaker. Defaults to 40% of JVM heap.</p>
</dd>
</dl>
</div>
<div id="fielddata-circuit-breaker-overhead" class="dlist">
<dl>
<dt class="hdlist1"><code>indices.breaker.fielddata.overhead</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
A constant that all field data estimations are multiplied with to determine a
final estimation. Defaults to <code>1.03</code>.</p>
</dd>
</dl>
</div>
<h4 id="request-circuit-breaker" class="discrete">Request circuit breaker</h4>
<div class="paragraph">
<p>The request circuit breaker allows OpenSearch to prevent per-request data
structures (for example, memory used for calculating aggregations during a
request) from exceeding a certain amount of memory.</p>
</div>
<div id="request-breaker-limit" class="dlist">
<dl>
<dt class="hdlist1"><code>indices.breaker.request.limit</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Limit for request breaker, defaults to 60% of JVM heap.</p>
</dd>
</dl>
</div>
<div id="request-breaker-overhead" class="dlist">
<dl>
<dt class="hdlist1"><code>indices.breaker.request.overhead</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
A constant that all request estimations are multiplied with to determine a
final estimation. Defaults to <code>1</code>.</p>
</dd>
</dl>
</div>
<h4 id="in-flight-circuit-breaker" class="discrete">In flight requests circuit breaker</h4>
<div class="paragraph">
<p>The in flight requests circuit breaker allows OpenSearch to limit the memory usage of all
currently active incoming requests on transport or HTTP level from exceeding a certain amount of
memory on a node. The memory usage is based on the content length of the request itself. This
circuit breaker also considers that memory is not only needed for representing the raw request but
also as a structured object which is reflected by default overhead.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>network.breaker.inflight_requests.limit</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Limit for in flight requests breaker, defaults to 100% of JVM heap. This means that it is bound
by the limit configured for the parent circuit breaker.</p>
</dd>
<dt class="hdlist1"><code>network.breaker.inflight_requests.overhead</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
A constant that all in flight requests estimations are multiplied with to determine a
final estimation. Defaults to 2.</p>
</dd>
</dl>
</div>
<h4 id="accounting-circuit-breaker" class="discrete">Accounting requests circuit breaker</h4>
<div class="paragraph">
<p>The accounting circuit breaker allows OpenSearch to limit the memory
usage of things held in memory that are not released when a request is
completed. This includes things like the Lucene segment memory.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>indices.breaker.accounting.limit</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Limit for accounting breaker, defaults to 100% of JVM heap. This means that it is bound
by the limit configured for the parent circuit breaker.</p>
</dd>
<dt class="hdlist1"><code>indices.breaker.accounting.overhead</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
A constant that all accounting estimations are multiplied with to determine a
final estimation. Defaults to 1</p>
</dd>
</dl>
</div>
<h4 id="script-compilation-circuit-breaker" class="discrete">Script compilation circuit breaker</h4>
<div class="paragraph">
<p>Slightly different than the previous memory-based circuit breaker, the script
compilation circuit breaker limits the number of inline script compilations
within a period of time.</p>
</div>
<div class="paragraph">
<p>See the "prefer-parameters" section of the <a href="modules-scripting-using.html">scripting</a>
documentation for more information.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>script.context.$CONTEXT.max_compilations_rate</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Limit for the number of unique dynamic scripts within a certain interval
that are allowed to be compiled for a given context. Defaults to <code>75/5m</code>,
meaning 75 every 5 minutes.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="modules-cluster">Cluster-level shard allocation and routing settings</h3>
<div class="paragraph">
<p><em>Shard allocation</em> is the process of allocating shards to nodes. This can
happen during initial recovery, replica allocation, rebalancing, or
when nodes are added or removed.</p>
</div>
<div class="paragraph">
<p>One of the main roles of the master is to decide which shards to allocate to
which nodes, and when to move shards between nodes in order to rebalance the
cluster.</p>
</div>
<div class="paragraph">
<p>There are a number of settings available to control the shard allocation process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="settings.html#cluster-shard-allocation-settings">Cluster-level shard allocation settings</a> control allocation and
rebalancing operations.</p>
</li>
<li>
<p><a href="settings.html#disk-based-shard-allocation">Disk-based shard allocation settings</a> explains how OpenSearch takes available
disk space into account, and the related settings.</p>
</li>
<li>
<p><a href="settings.html#shard-allocation-awareness">Shard allocation awareness</a> and <a href="settings.html#forced-awareness">Forced awareness</a> control how shards
can be distributed across different racks or availability zones.</p>
</li>
<li>
<p><a href="settings.html#cluster-shard-allocation-filtering">Cluster-level shard allocation filtering</a> allows certain nodes or groups of
nodes excluded from allocation so that they can be decommissioned.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Besides these, there are a few other <a href="settings.html#misc-cluster-settings">miscellaneous cluster-level settings</a>.</p>
</div>
<div class="sect3">
<h4 id="cluster-shard-allocation-settings">Cluster-level shard allocation settings</h4>
<div class="paragraph">
<p>You can use the following settings to control shard allocation and recovery:</p>
</div>
<div id="cluster-routing-allocation-enable" class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.routing.allocation.enable</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Enable or disable allocation for specific kinds of shards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>all</code> -             (default) Allows shard allocation for all kinds of shards.</p>
</li>
<li>
<p><code>primaries</code> -       Allows shard allocation only for primary shards.</p>
</li>
<li>
<p><code>new_primaries</code> -   Allows shard allocation only for primary shards for new indices.</p>
</li>
<li>
<p><code>none</code> -            No shard allocations of any kind are allowed for any indices.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This setting does not affect the recovery of local primary shards when
restarting a node.  A restarted node that has a copy of an unassigned primary
shard will recover that primary immediately, assuming that its allocation id matches
one of the active allocation ids in the cluster state.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.node_concurrent_incoming_recoveries</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
How many concurrent incoming shard recoveries are allowed to happen on a node. Incoming recoveries are the recoveries
where the target shard (most likely the replica unless a shard is relocating) is allocated on the node. Defaults to <code>2</code>.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.node_concurrent_outgoing_recoveries</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
How many concurrent outgoing shard recoveries are allowed to happen on a node. Outgoing recoveries are the recoveries
where the source shard (most likely the primary unless a shard is relocating) is allocated on the node. Defaults to <code>2</code>.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.node_concurrent_recoveries</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
A shortcut to set both <code>cluster.routing.allocation.node_concurrent_incoming_recoveries</code> and
<code>cluster.routing.allocation.node_concurrent_outgoing_recoveries</code>.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.node_initial_primaries_recoveries</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
While the recovery of replicas happens over the network, the recovery of
an unassigned primary after node restart uses data from the local disk.
These should be fast so more initial primary recoveries can happen in
parallel on the same node.  Defaults to <code>4</code>.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.same_shard.host</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Allows to perform a check to prevent allocation of multiple instances of
the same shard on a single host, based on host name and host address.
Defaults to <code>false</code>, meaning that no check is performed by default. This
setting only applies if multiple nodes are started on the same machine.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="shards-rebalancing-settings">Shard rebalancing settings</h4>
<div class="paragraph">
<p>A cluster is <em>balanced</em> when it has an equal number of shards on each node
without having a concentration of shards from any index on any node. OpenSearch runs
an automatic process called <em>rebalancing</em> which moves shards between the nodes
in your cluster to improve its balance. Rebalancing obeys all other shard
allocation rules such as <a href="settings.html#cluster-shard-allocation-filtering">allocation
filtering</a> and <a href="settings.html#forced-awareness">forced awareness</a> which may prevent it from
completely balancing the cluster. In that case, rebalancing strives to acheve
the most balanced cluster possible within the rules you have configured.</p>
</div>
<div class="paragraph">
<p>You can use the following settings to control the rebalancing of shards across
the cluster:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.routing.rebalance.enable</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Enable or disable rebalancing for specific kinds of shards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>all</code> -         (default) Allows shard balancing for all kinds of shards.</p>
</li>
<li>
<p><code>primaries</code> -   Allows shard balancing only for primary shards.</p>
</li>
<li>
<p><code>replicas</code> -    Allows shard balancing only for replica shards.</p>
</li>
<li>
<p><code>none</code> -        No shard balancing of any kind are allowed for any indices.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.allow_rebalance</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Specify when shard rebalancing is allowed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>always</code> -                    Always allow rebalancing.</p>
</li>
<li>
<p><code>indices_primaries_active</code> -  Only when all primaries in the cluster are allocated.</p>
</li>
<li>
<p><code>indices_all_active</code> -        (default) Only when all shards (primaries and replicas) in the cluster are allocated.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.cluster_concurrent_rebalance</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Allow to control how many concurrent shard rebalances are
allowed cluster wide. Defaults to <code>2</code>. Note that this setting
only controls the number of concurrent shard relocations due
to imbalances in the cluster. This setting does not limit shard
relocations due to <a href="settings.html#cluster-shard-allocation-filtering">allocation
filtering</a> or <a href="settings.html#forced-awareness">forced awareness</a>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="shards-rebalancing-heuristics">Shard balancing heuristics settings</h4>
<div class="paragraph">
<p>Rebalancing works by computing a <em>weight</em> for each node based on its allocation
of shards, and then moving shards between nodes to reduce the weight of the
heavier nodes and increase the weight of the lighter ones. The cluster is
balanced when there is no possible shard movement that can bring the weight of
any node closer to the weight of any other node by more than a configurable
threshold. The following settings allow you to control the details of these
calculations.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.routing.allocation.balance.shard</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Defines the weight factor for the total number of shards allocated on a node
(float). Defaults to <code>0.45f</code>.  Raising this raises the tendency to
equalize the number of shards across all nodes in the cluster.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.balance.index</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Defines the weight factor for the number of shards per index allocated
 on a specific node (float). Defaults to <code>0.55f</code>.  Raising this raises the
 tendency to equalize the number of shards per index across all nodes in
 the cluster.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.balance.threshold</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Minimal optimization value of operations that should be performed (non
 negative float). Defaults to <code>1.0f</code>.  Raising this will cause the cluster
 to be less aggressive about optimizing the shard balance.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Regardless of the result of the balancing algorithm, rebalancing might
not be allowed due to forced awareness or allocation filtering.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="disk-based-shard-allocation">Disk-based shard allocation settings</h4>
<div id="disk-based-shard-allocation-description" class="paragraph">
<p>The disk-based shard allocator ensures that all nodes have enough disk space
without performing more shard movements than necessary. It allocates shards
based on a pair of thresholds known as the <em>low watermark</em> and the <em>high
watermark</em>. Its primary goal is to ensure that no node exceeds the high
watermark, or at least that any such overage is only temporary. If a node
exceeds the high watermark then OpenSearch will solve this by moving some of its
shards onto other nodes in the cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is normal for nodes to temporarily exceed the high watermark from time
to time.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The allocator also tries to keep nodes clear of the high watermark by
forbidding the allocation of more shards to a node that exceeds the low
watermark. Importantly, if all of your nodes have exceeded the low watermark
then no new shards can be allocated and OpenSearch will not be able to move any
shards between nodes in order to keep the disk usage below the high watermark.
You must ensure that your cluster has enough disk space in total and that there
are always some nodes below the low watermark.</p>
</div>
<div class="paragraph">
<p>Shard movements triggered by the disk-based shard allocator must also satisfy
all other shard allocation rules such as
<a href="settings.html#cluster-shard-allocation-filtering">allocation filtering</a> and
<a href="settings.html#forced-awareness">forced awareness</a>. If these rules are too strict then they
can also prevent the shard movements needed to keep the nodes' disk usage under
control.</p>
</div>
<div class="paragraph">
<p>If a node is filling up its disk faster than OpenSearch can move shards elsewhere
then there is a risk that the disk will completely fill up. To prevent this, as
a last resort, once the disk usage reaches the <em>flood-stage</em> watermark OpenSearch
will block writes to indices with a shard on the affected node. It will also
continue to move shards onto the other nodes in the cluster.  When disk usage
on the affected node drops below the high watermark, OpenSearch automatically removes
the write block.</p>
</div>
<div id="disk-based-shard-allocation-does-not-balance" class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>It is normal for the nodes in your cluster to be using very different amounts
of disk space. The <a href="settings.html#shards-rebalancing-settings">balance</a> of the cluster
depends only on the number of shards on each node and the indices to which
those shards belong. It considers neither the sizes of these shards nor the
available disk space on each node, for the following reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Disk usage changes over time. Balancing the disk usage of individual nodes
would require a lot more shard movements, perhaps even wastefully undoing
earlier movements. Moving a shard consumes resources such as I/O and network
bandwidth and may evict data from the filesystem cache. These resources are
better spent handling your searches and indexing where possible.</p>
</li>
<li>
<p>A cluster with equal disk usage on every node typically performs no better
than one that has unequal disk usage, as long as no disk is too full.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use the following settings to control disk-based allocation:</p>
</div>
<div id="cluster-routing-disk-threshold" class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.routing.allocation.disk.threshold_enabled</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Defaults to <code>true</code>.  Set to <code>false</code> to disable the disk allocation decider.</p>
</dd>
</dl>
</div>
<div id="cluster-routing-watermark-low" class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.routing.allocation.disk.watermark.low</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Controls the low watermark for disk usage. It defaults to <code>85%</code>, meaning that OpenSearch will not allocate shards to nodes that have more than 85% disk used. It can also be set to an absolute byte value (like <code>500mb</code>) to prevent OpenSearch from allocating shards if less than the specified amount of space is available. This setting has no effect on the primary shards of newly-created indices but will prevent their replicas from being allocated.</p>
</dd>
</dl>
</div>
<div id="cluster-routing-watermark-high" class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.routing.allocation.disk.watermark.high</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Controls the high watermark. It defaults to <code>90%</code>, meaning that OpenSearch will attempt to relocate shards away from a node whose disk usage is above 90%. It can also be set to an absolute byte value (similarly to the low watermark) to relocate shards away from a node if it has less than the specified amount of free space. This setting affects the allocation of all shards, whether previously allocated or not.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.disk.watermark.enable_for_single_data_node</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
For a single data node, the default is to disregard disk watermarks when
making an allocation decision. This is deprecated behavior and will be
changed in 8.0. This setting can be set to <code>true</code> to enable the
disk watermarks for a single data node cluster (will become default in 8.0).</p>
</dd>
</dl>
</div>
<div id="cluster-routing-flood-stage" class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.routing.allocation.disk.watermark.flood_stage</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Controls the flood stage watermark, which defaults to 95%. OpenSearch enforces a read-only index block (<code>index.blocks.read_only_allow_delete</code>) on every index that has one or more shards allocated on the node, and that has at least one disk exceeding the flood stage. This setting is a last resort to prevent nodes from running out of disk space. The index block is automatically released when the disk utilization falls below the high watermark.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You cannot mix the usage of percentage values and byte values within
these settings. Either all values are set to percentage values, or all are set to byte values. This enforcement is so that OpenSearch can validate that the settings are internally consistent, ensuring that the low disk threshold is less than the high disk threshold, and the high disk threshold is less than the flood stage threshold.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example of resetting the read-only index block on the <code>my-index-000001</code> index:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /my-index-000001/_settings
{
  "index.blocks.read_only_allow_delete": null
}</code></pre>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>cluster.info.update.interval</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
How often OpenSearch should check on disk usage for each node in the
cluster. Defaults to <code>30s</code>.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.disk.include_relocations</code></dt>
<dd>
<p>Defaults to true, which means that OpenSearch will take into account
shards that are currently being relocated to the target node when computing
a node&#8217;s disk usage. Taking relocating shards' sizes into account may,
however, mean that the disk usage for a node is incorrectly estimated on
the high side, since the relocation could be 90% complete and a recently
retrieved disk usage would include the total size of the relocating shard
as well as the space already used by the running relocation.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Percentage values refer to used disk space, while byte values refer to
free disk space. This can be confusing, since it flips the meaning of high and
low. For example, it makes sense to set the low watermark to 10gb and the high
watermark to 5gb, but not the other way around.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example of updating the low watermark to at least 100 gigabytes free, a high
watermark of at least 50 gigabytes free, and a flood stage watermark of 10
gigabytes free, and updating the information about the cluster every minute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT _cluster/settings
{
  "transient": {
    "cluster.routing.allocation.disk.watermark.low": "100gb",
    "cluster.routing.allocation.disk.watermark.high": "50gb",
    "cluster.routing.allocation.disk.watermark.flood_stage": "10gb",
    "cluster.info.update.interval": "1m"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="shard-allocation-awareness">Shard allocation awareness</h4>
<div class="paragraph">
<p>You can use custom node attributes as <em>awareness attributes</em> to enable OpenSearch
to take your physical hardware configuration into account when allocating shards.
If OpenSearch knows which nodes are on the same physical server, in the same rack, or
in the same zone, it can distribute the primary shard and its replica shards to
minimise the risk of losing all shard copies in the event of a failure.</p>
</div>
<div class="paragraph">
<p>When shard allocation awareness is enabled with the
<a href="settings.html#dynamic-cluster-setting">dynamic</a>
<code>cluster.routing.allocation.awareness.attributes</code> setting, shards are only
allocated to nodes that have values set for the specified awareness attributes.
If you use multiple awareness attributes, OpenSearch considers each attribute
separately when allocating shards.</p>
</div>
<div class="paragraph">
<p>By default OpenSearch uses <a href="search-shard-routing.html#search-adaptive-replica">adaptive replica selection</a>
to route search or GET requests. However, with the presence of allocation awareness
attributes OpenSearch will prefer using shards in the same location (with the same
awareness attribute values) to process these requests. This behavior can be
disabled by specifying <code>export OPENSEARCH_JAVA_OPTS="$OPENSEARCH_JAVA_OPTS -Des.search.ignore_awareness_attributes=true"</code>
system property on every node that is part of the cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The number of attribute values determines how many shard copies are
allocated in each location. If the number of nodes in each location is
unbalanced and there are a lot of replicas, replica shards might be left
unassigned.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="enabling-awareness">Enabling shard allocation awareness</h5>
<div class="paragraph">
<p>To enable shard allocation awareness:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Specify the location of each node with a custom node attribute. For example,
if you want OpenSearch to distribute shards across different racks, you might
set an awareness attribute called <code>rack_id</code> in each node&#8217;s <code>opensearch.yml</code>
config file.</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">node.attr.rack_id: rack_one</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also set custom attributes when you start a node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">`./bin/opensearch -Enode.attr.rack_id=rack_one`</code></pre>
</div>
</div>
</li>
<li>
<p>Tell OpenSearch to take one or more awareness attributes into account when
allocating shards by setting
<code>cluster.routing.allocation.awareness.attributes</code> in <strong>every</strong> master-eligible
node&#8217;s <code>opensearch.yml</code> config file.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">cluster.routing.allocation.awareness.attributes: rack_id <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Specify multiple attributes as a comma-separated list.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="paragraph">
<p>You can also use the
<a href="cluster.html#cluster-update-settings">cluster-update-settings</a> API to set or update
a cluster&#8217;s awareness attributes.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>With this example configuration, if you start two nodes with
<code>node.attr.rack_id</code> set to <code>rack_one</code> and create an index with 5 primary
shards and 1 replica of each primary, all primaries and replicas are
allocated across the two nodes.</p>
</div>
<div class="paragraph">
<p>If you add two nodes with <code>node.attr.rack_id</code> set to <code>rack_two</code>,
OpenSearch moves shards to the new nodes, ensuring (if possible)
that no two copies of the same shard are in the same rack.</p>
</div>
<div class="paragraph">
<p>If <code>rack_two</code> fails and takes down both its nodes, by default OpenSearch
allocates the lost shard copies to nodes in <code>rack_one</code>. To prevent multiple
copies of a particular shard from being allocated in the same location, you can
enable forced awareness.</p>
</div>
</div>
<div class="sect4">
<h5 id="forced-awareness">Forced awareness</h5>
<div class="paragraph">
<p>By default, if one location fails, OpenSearch assigns all of the missing
replica shards to the remaining locations. While you might have sufficient
resources across all locations to host your primary and replica shards, a single
location might be unable to host <strong>ALL</strong> of the shards.</p>
</div>
<div class="paragraph">
<p>To prevent a single location from being overloaded in the event of a failure,
you can set <code>cluster.routing.allocation.awareness.force</code> so no replicas are
allocated until nodes are available in another location.</p>
</div>
<div class="paragraph">
<p>For example, if you have an awareness attribute called <code>zone</code> and configure nodes
in <code>zone1</code> and <code>zone2</code>, you can use forced awareness to prevent OpenSearch
from allocating replicas if only one zone is available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">cluster.routing.allocation.awareness.attributes: zone
cluster.routing.allocation.awareness.force.zone.values: zone1,zone2 <b class="conum">(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Specify all possible values for the awareness attribute.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>With this example configuration, if you start two nodes with <code>node.attr.zone</code> set
to <code>zone1</code> and create an index with 5 shards and 1 replica, OpenSearch creates
the index and allocates the 5 primary shards but no replicas. Replicas are
only allocated once nodes with <code>node.attr.zone</code> set to <code>zone2</code> are available.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cluster-shard-allocation-filtering">Cluster-level shard allocation filtering</h4>
<div class="paragraph">
<p>You can use cluster-level shard allocation filters to control where OpenSearch
allocates shards from any index. These cluster wide filters are applied in
conjunction with <a href="index-modules-allocation.html#shard-allocation-filtering">per-index allocation filtering</a>
and <a href="settings.html#shard-allocation-awareness">allocation awareness</a>.</p>
</div>
<div class="paragraph">
<p>Shard allocation filters can be based on custom node attributes or the built-in
<code>_name</code>, <code>_host_ip</code>, <code>_publish_ip</code>, <code>_ip</code>, <code>_host</code> and <code>_id</code> attributes.</p>
</div>
<div class="paragraph">
<p>The <code>cluster.routing.allocation</code> settings are <a href="settings.html#dynamic-cluster-setting">dynamic</a>, enabling live indices to
be moved from one set of nodes to another. Shards are only relocated if it is
possible to do so without breaking another routing constraint, such as never
allocating a primary and replica shard on the same node.</p>
</div>
<div class="paragraph">
<p>The most common use case for cluster-level shard allocation filtering is when
you want to decommission a node. To move shards off of a node prior to shutting
it down, you could create a filter that excludes the node by its IP address:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT _cluster/settings
{
  "transient" : {
    "cluster.routing.allocation.exclude._ip" : "10.0.0.1"
  }
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="cluster-routing-settings">Cluster routing settings</h5>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.routing.allocation.include.{attribute}</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Allocate shards to a node whose <code>{attribute}</code> has at least one of the
comma-separated values.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.require.{attribute}</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Only allocate shards to a node whose <code>{attribute}</code> has <em>all</em> of the
comma-separated values.</p>
</dd>
<dt class="hdlist1"><code>cluster.routing.allocation.exclude.{attribute}</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Do not allocate shards to a node whose <code>{attribute}</code> has <em>any</em> of the
comma-separated values.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The cluster allocation settings support the following built-in attributes:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
<code>_name</code>
</td>
<td class="hdlist2">
<p>Match nodes by node name</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>_host_ip</code>
</td>
<td class="hdlist2">
<p>Match nodes by host IP address (IP associated with hostname)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>_publish_ip</code>
</td>
<td class="hdlist2">
<p>Match nodes by publish IP address</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>_ip</code>
</td>
<td class="hdlist2">
<p>Match either <code>_host_ip</code> or <code>_publish_ip</code></p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>_host</code>
</td>
<td class="hdlist2">
<p>Match nodes by hostname</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>_id</code>
</td>
<td class="hdlist2">
<p>Match nodes by node id</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use wildcards when specifying attribute values, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT _cluster/settings
{
  "transient": {
    "cluster.routing.allocation.exclude._ip": "192.168.2.*"
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="misc-cluster-settings">Miscellaneous cluster settings</h4>
<div class="sect4">
<h5 id="cluster-read-only">Metadata</h5>
<div class="paragraph">
<p>An entire cluster may be set to read-only with the following setting:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.blocks.read_only</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Make the whole cluster read only (indices do not accept write
operations), metadata is not allowed to be modified (create or delete
indices).</p>
</dd>
<dt class="hdlist1"><code>cluster.blocks.read_only_allow_delete</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Identical to <code>cluster.blocks.read_only</code> but allows to delete indices
to free up resources.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Don&#8217;t rely on this setting to prevent changes to your cluster. Any
user with access to the <a href="cluster.html#cluster-update-settings">cluster-update-settings</a>
API can make the cluster read-write again.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="cluster-shard-limit">Cluster shard limit</h5>
<div class="paragraph">
<p>There is a soft limit on the number of shards in a cluster, based on the number
of nodes in the cluster. This is intended to prevent operations which may
unintentionally destabilize the cluster.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This limit is intended as a safety net, not a sizing recommendation. The
exact number of shards your cluster can safely support depends on your hardware
configuration and workload, but should remain well below this limit in almost
all cases, as the default limit is set quite high.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If an operation, such as creating a new index, restoring a snapshot of an index,
or opening a closed index would lead to the number of shards in the cluster
going over this limit, the operation will fail with an error indicating the
shard limit.</p>
</div>
<div class="paragraph">
<p>If the cluster is already over the limit, due to changes in node membership or
setting changes, all operations that create or open indices will fail until
either the limit is increased as described below, or some indices are
<a href="indices.html#indices-open-close">closed</a> or <a href="indices.html#indices-delete-index">deleted</a> to bring the
number of shards below the limit.</p>
</div>
<div class="paragraph">
<p>The cluster shard limit defaults to 1,000 shards per data node.
Both primary and replica shards of all open indices count toward the limit,
including unassigned shards.
For example, an open index with 5 primary shards and 2 replicas counts as 15 shards.
Closed indices do not contribute to the shard count.</p>
</div>
<div class="paragraph">
<p>You can dynamically adjust the cluster shard limit with the following setting:</p>
</div>
<div id="cluster-max-shards-per-node" class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.max_shards_per_node</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Limits the total number of primary and replica shards for the cluster. OpenSearch
calculates the limit as follows:</p>
</div>
<div class="paragraph">
<p><code>cluster.max_shards_per_node * number of data nodes</code></p>
</div>
<div class="paragraph">
<p>Shards for closed indices do not count toward this limit. Defaults to <code>1000</code>.
A cluster with no data nodes is unlimited.</p>
</div>
<div class="paragraph">
<p>OpenSearch rejects any request that creates more shards than this limit allows. For
example, a cluster with a <code>cluster.max_shards_per_node</code> setting of <code>100</code> and
three data nodes has a shard limit of 300. If the cluster already contains 296
shards, OpenSearch rejects any request that adds five or more shards to the cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This setting does not limit shards for individual nodes. To limit the
number of shards for each node, use the
<a href="index-modules-allocation.html#cluster-total-shards-per-node"><code>cluster.routing.allocation.total_shards_per_node</code></a>
setting.
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect4">
<h5 id="user-defined-data">User-defined cluster metadata</h5>
<div class="paragraph">
<p>User-defined metadata can be stored and retrieved using the Cluster Settings API.
This can be used to store arbitrary, infrequently-changing data about the cluster
without the need to create an index to store it. This data may be stored using
any key prefixed with <code>cluster.metadata.</code>.  For example, to store the email
address of the administrator of a cluster under the key <code>cluster.metadata.administrator</code>,
issue this request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /_cluster/settings
{
  "persistent": {
    "cluster.metadata.administrator": "sysadmin@example.com"
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
User-defined cluster metadata is not intended to store sensitive or
confidential information. Any information stored in user-defined cluster
metadata will be viewable by anyone with access to the
<a href="cluster.html#cluster-get-settings">Cluster Get Settings</a> API, and is recorded in the
OpenSearch logs.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="cluster-max-tombstones">Index tombstones</h5>
<div class="paragraph">
<p>The cluster state maintains index tombstones to explicitly denote indices that
have been deleted.  The number of tombstones maintained in the cluster state is
controlled by the following setting:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.indices.tombstones.size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Index tombstones prevent nodes that are not part of the cluster when a delete
occurs from joining the cluster and reimporting the index as though the delete
was never issued. To keep the cluster state from growing huge we only keep the
last <code>cluster.indices.tombstones.size</code> deletes, which defaults to 500. You can
increase it if you expect nodes to be absent from the cluster and miss more
than 500 deletes. We think that is rare, thus the default. Tombstones don&#8217;t take
up much space, but we also think that a number like 50,000 is probably too big.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If OpenSearch encounters index data that is absent from the current cluster
state, those indices are considered to be dangling. For example,
this can happen if you delete more than
<code>cluster.indices.tombstones.size</code> indices while an OpenSearch node is offline.
You can use the <a href="indices.html#dangling-indices-api">Dangling indices API</a> to manage
this situation.</p>
</div>
</div>
<div class="sect4">
<h5 id="cluster-logger">Logger</h5>
<div class="paragraph">
<p>The settings which control logging can be updated <a href="settings.html#dynamic-cluster-setting">dynamically</a> with the
<code>logger.</code> prefix.  For instance, to increase the logging level of the
<code>indices.recovery</code> module to <code>DEBUG</code>, issue this request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /_cluster/settings
{
  "transient": {
    "logger.org.opensearch.indices.recovery": "DEBUG"
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="persistent-tasks-allocation">Persistent tasks allocation</h5>
<div class="paragraph">
<p>Plugins can create a kind of tasks called persistent tasks. Those tasks are
usually long-lived tasks and are stored in the cluster state, allowing the
tasks to be revived after a full cluster restart.</p>
</div>
<div class="paragraph">
<p>Every time a persistent task is created, the master node takes care of
assigning the task to a node of the cluster, and the assigned node will then
pick up the task and execute it locally. The process of assigning persistent
tasks to nodes is controlled by the following settings:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.persistent_tasks.allocation.enable</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Enable or disable allocation for persistent tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>all</code> -             (default) Allows persistent tasks to be assigned to nodes</p>
</li>
<li>
<p><code>none</code> -            No allocations are allowed for any type of persistent task</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This setting does not affect the persistent tasks that are already being executed.
Only newly created persistent tasks, or tasks that must be reassigned (after a node
left the cluster, for example), are impacted by this setting.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>cluster.persistent_tasks.allocation.recheck_interval</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
The master node will automatically check whether persistent tasks need to
be assigned when the cluster state changes significantly. However, there
may be other factors, such as memory usage, that affect whether persistent
tasks can be assigned to nodes but do not cause the cluster state to change.
This setting controls how often assignment checks are performed to react to
these factors. The default is 30 seconds. The minimum permitted value is 10
seconds.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modules-discovery-settings">Discovery and cluster formation settings</h3>
<div class="paragraph">
<p><a href="modules-discovery.html">Discovery and cluster formation</a> are affected by the
following settings:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>discovery.seed_hosts</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Provides a list of the addresses of the master-eligible nodes in the cluster.
May also be a single string containing the addresses separated by commas. Each
address has the format <code>host:port</code> or <code>host</code>. The <code>host</code> is either a host name
to be resolved by DNS, an IPv4 address, or an IPv6 address. IPv6 addresses
must be enclosed in square brackets. If a host name resolves via DNS to multiple
addresses, OpenSearch uses all of them. DNS lookups are subject to
<a href="system-config.html#networkaddress-cache-ttl">JVM DNS caching</a>. If the <code>port</code> is not given then it
is determined by checking the following settings in order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>transport.profiles.default.port</code></p>
</li>
<li>
<p><code>transport.port</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If neither of these is set then the default port is <code>9300</code>. The default value
for <code>discovery.seed_hosts</code> is <code>["127.0.0.1", "[::1]"]</code>. See <a href="important-settings.html#unicast.hosts"><code>discovery.seed_hosts</code></a>.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>discovery.seed_providers</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Specifies which types of <a href="modules-discovery.html#built-in-hosts-providers">seed hosts provider</a> to
use to obtain the addresses of the seed nodes used to start the discovery
process. By default, it is the
<a href="modules-discovery.html#settings-based-hosts-provider">settings-based seed hosts provider</a> which
obtains the seed node addresses from the <code>discovery.seed_hosts</code> setting.</p>
</dd>
<dt class="hdlist1"><code>discovery.type</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Specifies whether OpenSearch should form a multiple-node cluster. By default, OpenSearch
discovers other nodes when forming a cluster and allows other nodes to join
the cluster later. If <code>discovery.type</code> is set to <code>single-node</code>, OpenSearch forms a
single-node cluster and suppresses the timeout set by
<code>cluster.publish.timeout</code>. For more information about when you might use
this setting, see <a href="bootstrap-checks.html#single-node-discovery">Single-node discovery</a>.</p>
</dd>
<dt class="hdlist1"><code>cluster.initial_master_nodes</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets the initial set of master-eligible nodes in a brand-new cluster. By default
this list is empty, meaning that this node expects to join a cluster that has
already been bootstrapped. See <a href="important-settings.html#initial_master_nodes"><code>cluster.initial_master_nodes</code></a>.</p>
</dd>
</dl>
</div>
<h4 id="_expert_settings" class="discrete">Expert settings</h4>
<div class="paragraph">
<p>Discovery and cluster formation are also affected by the following
<em>expert-level</em> settings, although it is not recommended to change any of these
from their default values.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you adjust these settings then your cluster may not form correctly
or may become unstable or intolerant of certain failures.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>discovery.cluster_formation_warning_timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long a node will try to form a cluster before logging a warning that
the cluster did not form. Defaults to <code>10s</code>. If a cluster has not formed after
<code>discovery.cluster_formation_warning_timeout</code> has elapsed then the node will log
a warning message that starts with the phrase <code>master not discovered</code> which
describes the current state of the discovery process.</p>
</dd>
<dt class="hdlist1"><code>discovery.find_peers_interval</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long a node will wait before attempting another discovery round.
Defaults to <code>1s</code>.</p>
</dd>
<dt class="hdlist1"><code>discovery.probe.connect_timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long to wait when attempting to connect to each address. Defaults to
<code>3s</code>.</p>
</dd>
<dt class="hdlist1"><code>discovery.probe.handshake_timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long to wait when attempting to identify the remote node via a
handshake. Defaults to <code>1s</code>.</p>
</dd>
<dt class="hdlist1"><code>discovery.request_peers_timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long a node will wait after asking its peers again before considering
the request to have failed. Defaults to <code>3s</code>.</p>
</dd>
<dt class="hdlist1"><code>discovery.seed_resolver.max_concurrent_resolvers</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Specifies how many concurrent DNS lookups to perform when resolving the
addresses of seed nodes. Defaults to <code>10</code>.</p>
</dd>
<dt class="hdlist1"><code>discovery.seed_resolver.timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Specifies how long to wait for each DNS lookup performed when resolving the
addresses of seed nodes. Defaults to <code>5s</code>.</p>
</dd>
<dt class="hdlist1"><code>cluster.auto_shrink_voting_configuration</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Controls whether the <a href="modules-discovery.html#modules-discovery-voting">voting configuration</a> sheds
departed nodes automatically, as long as it still contains at least 3 nodes. The
default value is <code>true</code>. If set to <code>false</code>, the voting configuration never
shrinks automatically and you must remove departed nodes manually with the
<a href="cluster.html#voting-config-exclusions">voting configuration exclusions API</a>.</p>
</dd>
<dt class="hdlist1"><a id="master-election-settings"></a><code>cluster.election.back_off_time</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets the amount to increase the upper bound on the wait before an election on
each election failure. Note that this is <em>linear</em> backoff. This defaults to
<code>100ms</code>. Changing this setting from the default may cause your cluster to fail
to elect a master node.</p>
</dd>
<dt class="hdlist1"><code>cluster.election.duration</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long each election is allowed to take before a node considers it to
have failed and schedules a retry. This defaults to <code>500ms</code>.  Changing this
setting from the default may cause your cluster to fail to elect a master node.</p>
</dd>
<dt class="hdlist1"><code>cluster.election.initial_timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets the upper bound on how long a node will wait initially, or after the
elected master fails, before attempting its first election. This defaults to
<code>100ms</code>. Changing this setting from the default may cause your cluster to fail
to elect a master node.</p>
</dd>
<dt class="hdlist1"><code>cluster.election.max_timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets the maximum upper bound on how long a node will wait before attempting an
first election, so that an network partition that lasts for a long time does not
result in excessively sparse elections. This defaults to <code>10s</code>. Changing this
setting from the default may cause your cluster to fail to elect a master node.</p>
</dd>
<dt class="hdlist1"><a id="fault-detection-settings"></a><code>cluster.fault_detection.follower_check.interval</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long the elected master waits between follower checks to each other
node in the cluster. Defaults to <code>1s</code>. Changing this setting from the default
may cause your cluster to become unstable.</p>
</dd>
<dt class="hdlist1"><code>cluster.fault_detection.follower_check.timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long the elected master waits for a response to a follower check before
considering it to have failed. Defaults to <code>10s</code>. Changing this setting from the
default may cause your cluster to become unstable.</p>
</dd>
<dt class="hdlist1"><code>cluster.fault_detection.follower_check.retry_count</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how many consecutive follower check failures must occur to each node before
the elected master considers that node to be faulty and removes it from the
cluster. Defaults to <code>3</code>. Changing this setting from the default may cause your
cluster to become unstable.</p>
</dd>
<dt class="hdlist1"><code>cluster.fault_detection.leader_check.interval</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long each node waits between checks of the elected master. Defaults to
<code>1s</code>. Changing this setting from the default may cause your cluster to become
unstable.</p>
</dd>
<dt class="hdlist1"><code>cluster.fault_detection.leader_check.timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long each node waits for a response to a leader check from the elected
master before considering it to have failed. Defaults to <code>10s</code>. Changing this
setting from the default may cause your cluster to become unstable.</p>
</dd>
<dt class="hdlist1"><code>cluster.fault_detection.leader_check.retry_count</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how many consecutive leader check failures must occur before a node
considers the elected master to be faulty and attempts to find or elect a new
master. Defaults to <code>3</code>. Changing this setting from the default may cause your
cluster to become unstable.</p>
</dd>
<dt class="hdlist1"><code>cluster.follower_lag.timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long the master node waits to receive acknowledgements for cluster
state updates from lagging nodes. The default value is <code>90s</code>. If a node does not
successfully apply the cluster state update within this period of time, it is
considered to have failed and is removed from the cluster. See
<a href="modules-discovery.html#cluster-state-publishing">Publishing the cluster state</a>.</p>
</dd>
<dt class="hdlist1"><code>cluster.max_voting_config_exclusions</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Sets a limit on the number of voting configuration exclusions at any one time.
The default value is <code>10</code>. See <a href="getting-started-modify-data.html#modules-discovery-adding-removing-nodes">Adding and removing nodes</a>.</p>
</dd>
<dt class="hdlist1"><code>cluster.publish.info_timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long the master node waits for each cluster state update to be
completely published to all nodes before logging a message indicating that some
nodes are responding slowly. The default value is <code>10s</code>.</p>
</dd>
<dt class="hdlist1"><code>cluster.publish.timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Sets how long the master node waits for each cluster state update to be
completely published to all nodes, unless <code>discovery.type</code> is set to
<code>single-node</code>. The default value is <code>30s</code>. See <a href="modules-discovery.html#cluster-state-publishing">Publishing the cluster state</a>.</p>
</dd>
</dl>
</div>
<div id="no-master-block" class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.no_master_block</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Specifies which operations are rejected when there is no active master in a
cluster. This setting has three valid values:</p>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>all</code></dt>
<dd>
<p>All operations on the node (both read and write operations) are rejected.
This also applies for API cluster state read or write operations, like the get
index settings, put mapping and cluster state API.</p>
</dd>
<dt class="hdlist1"><code>write</code></dt>
<dd>
<p>(default) Write operations are rejected. Read operations succeed,
based on the last known cluster configuration. This situation may result in
partial reads of stale data as this node may be isolated from the rest of the
cluster.</p>
</dd>
<dt class="hdlist1"><code>metadata_write</code></dt>
<dd>
<p>Only metadata write operations (e.g. mapping updates,
routing table changes) are rejected but regular indexing operations continue
to work. Read and write operations succeed, based on the last known cluster
configuration. This situation may result in partial reads of stale data as
this node may be isolated from the rest of the cluster.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>cluster.no_master_block</code> setting doesn&#8217;t apply to nodes-based APIs
(for example, cluster stats, node info, and node stats APIs). Requests to these
APIs are not be blocked and can run on any available node.</p>
</li>
<li>
<p>For the cluster to be fully operational, it must have an active master.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</dd>
<dt class="hdlist1"><code>monitor.fs.health.enabled</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
If <code>true</code>, the node runs periodic
<a href="modules-discovery.html#cluster-fault-detection-filesystem-health">filesystem health checks</a>. Defaults
to <code>true</code>.</p>
</dd>
<dt class="hdlist1"><code>monitor.fs.health.refresh_interval</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Interval between successive
<a href="modules-discovery.html#cluster-fault-detection-filesystem-health">filesystem health checks</a>. Defaults
to <code>2m</code>.</p>
</dd>
<dt class="hdlist1"><code>monitor.fs.health.slow_path_logging_threshold</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
If a <a href="modules-discovery.html#cluster-fault-detection-filesystem-health">filesystem health checks</a>
takes longer than this threshold then OpenSearch logs a warning. Defaults to <code>5s</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="modules-fielddata">Field data cache settings</h3>
<div class="paragraph">
<p>The field data cache contains <a href="mapping-types.html#fielddata-mapping-param">field data</a> and <a href="mapping-params.html#eager-global-ordinals">global ordinals</a>,
which are both used to support aggregations on certain field types.
Since these are on-heap data structures, it is important to monitor the cache&#8217;s use.</p>
</div>
<h4 id="fielddata-sizing" class="discrete">Cache size</h4>
<div class="paragraph">
<p>The entries in the cache are expensive to build, so the default behavior is
to keep the cache loaded in memory. The default cache size is unlimited,
causing the cache to grow until it reaches the limit set by the <a href="settings.html#fielddata-circuit-breaker">field data circuit breaker</a>. This behavior can be configured.</p>
</div>
<div class="paragraph">
<p>If the cache size limit is set, the cache will begin clearing the least-recently-updated
entries in the cache. This setting can automatically avoid the circuit breaker limit,
at the cost of rebuilding the cache as needed.</p>
</div>
<div class="paragraph">
<p>If the circuit breaker limit is reached, further requests that increase the cache
size will be prevented. In this case you should manually <a href="indices.html#indices-clearcache">clear the cache</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>indices.fielddata.cache.size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The max size of the field data cache, eg <code>38%</code> of node heap space, or an
absolute value, eg <code>12GB</code>. Defaults to unbounded. If you choose to set it,
it should be smaller than <a href="settings.html#fielddata-circuit-breaker">Field data circuit breaker</a> limit.</p>
</dd>
</dl>
</div>
<h4 id="fielddata-monitoring" class="discrete">Monitoring field data</h4>
<div class="paragraph">
<p>You can monitor memory usage for field data as well as the field data circuit
breaker using
the <a href="cluster.html#cluster-nodes-stats">nodes stats API</a> or the <a href="cat.html#cat-fielddata">cat fielddata API</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="modules-http">HTTP</h3>
<div id="modules-http-description" class="paragraph">
<p>The HTTP layer exposes OpenSearch&#8217;s REST APIs over HTTP. Clients send HTTP requests
to a node in the cluster which either handles it locally or else passes it on
to other nodes for further processing using the <a href="settings.html#modules-transport">Transport
layer</a>.</p>
</div>
<div class="paragraph">
<p>When possible, consider using <a href="https://en.wikipedia.org/wiki/Keepalive#HTTP_Keepalive">HTTP keep
alive</a> when connecting for better performance and try to get your favorite
client not to do <a href="https://en.wikipedia.org/wiki/Chunked_transfer_encoding">HTTP chunking</a>.</p>
</div>
<div class="sect3">
<h4 id="_http_settings">HTTP settings</h4>
<div class="paragraph">
<p>The following settings can be configured for HTTP. These settings also use the common <a href="settings.html#modules-network">network settings</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>http.port</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
A bind port range. Defaults to <code>9200-9300</code>.</p>
</dd>
<dt class="hdlist1"><code>http.publish_port</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The port that HTTP clients should use when
communicating with this node. Useful when a cluster node is behind a
proxy or firewall and the <code>http.port</code> is not directly addressable
from the outside. Defaults to the actual port assigned via <code>http.port</code>.</p>
</dd>
<dt class="hdlist1"><code>http.bind_host</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The host address to bind the HTTP service to. Defaults to <code>http.host</code> (if set) or <code>network.bind_host</code>.</p>
</dd>
<dt class="hdlist1"><code>http.publish_host</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The host address to publish for HTTP clients to connect to. Defaults to <code>http.host</code> (if set) or <code>network.publish_host</code>.</p>
</dd>
<dt class="hdlist1"><code>http.host</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Used to set the <code>http.bind_host</code> and the <code>http.publish_host</code>.</p>
</dd>
<dt class="hdlist1"><code>http.max_content_length</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Maximum size of an HTTP request body. Defaults to <code>100mb</code>.</p>
</dd>
<dt class="hdlist1"><code>http.max_initial_line_length</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Maximum size of an HTTP URL. Defaults to <code>4kb</code>.</p>
</dd>
<dt class="hdlist1"><code>http.max_header_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Maximum size of allowed headers. Defaults to <code>8kb</code>.</p>
</dd>
</dl>
</div>
<div id="http-compression" class="dlist">
<dl>
<dt class="hdlist1"><code>http.compression</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Support for compression when possible (with Accept-Encoding). If HTTPS is enabled, defaults to <code>false</code>. Otherwise, defaults to <code>true</code>.</p>
<div class="paragraph">
<p>Disabling compression for HTTPS mitigates potential security risks, such as a
<a href="https://en.wikipedia.org/wiki/BREACH">BREACH attack</a>. To compress HTTPS traffic,
you must explicitly set <code>http.compression</code> to <code>true</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>http.compression_level</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Defines the compression level to use for HTTP responses. Valid values are in the range of 1 (minimum compression) and 9 (maximum compression). Defaults to <code>3</code>.</p>
</dd>
</dl>
</div>
<div id="http-cors-enabled" class="dlist">
<dl>
<dt class="hdlist1"><code>http.cors.enabled</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Enable or disable cross-origin resource sharing, which determines whether a browser on another origin can execute requests against OpenSearch. Set to <code>true</code> to enable OpenSearch to process pre-flight
<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">CORS</a> requests.
OpenSearch will respond to those requests with the <code>Access-Control-Allow-Origin</code> header if the <code>Origin</code> sent in the request is permitted by the <code>http.cors.allow-origin</code> list. Set to <code>false</code> (the default) to make OpenSearch ignore the <code>Origin</code> request header, effectively disabling CORS requests because OpenSearch will never respond with the <code>Access-Control-Allow-Origin</code> response header.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the client does not send a pre-flight request with an <code>Origin</code> header or it does not check the response headers from the server to validate the
<code>Access-Control-Allow-Origin</code> response header, then cross-origin security is
compromised. If CORS is not enabled on OpenSearch, the only way for the client to know is to send a pre-flight request and realize the required response headers are missing.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div id="http-cors-allow-origin" class="dlist">
<dl>
<dt class="hdlist1"><code>http.cors.allow-origin</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Which origins to allow. If you prepend and append a forward slash (<code>/</code>) to the value, this will be treated as a regular expression, allowing you to support HTTP and HTTPs. For example, using <code>/https?:\/\/localhost(:[0-9]+)?/</code> would return the request header appropriately in both cases. Defaults to no origins allowed.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
A wildcard (<code><strong></code>) is a valid value but is considered a security risk, as your OpenSearch instance is open to cross origin requests from *anywhere</strong>.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div id="http-cors-max-age" class="dlist">
<dl>
<dt class="hdlist1"><code>http.cors.max-age</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Browsers send a "preflight" OPTIONS-request to determine CORS settings. <code>max-age</code> defines how long the result should be cached for. Defaults to <code>1728000</code> (20 days).</p>
</dd>
</dl>
</div>
<div id="http-cors-allow-methods" class="dlist">
<dl>
<dt class="hdlist1"><code>http.cors.allow-methods</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Which methods to allow. Defaults to <code>OPTIONS, HEAD, GET, POST, PUT, DELETE</code>.</p>
</dd>
</dl>
</div>
<div id="http-cors-allow-headers" class="dlist">
<dl>
<dt class="hdlist1"><code>http.cors.allow-headers</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Which headers to allow. Defaults to <code>X-Requested-With, Content-Type, Content-Length</code>.</p>
</dd>
</dl>
</div>
<div id="http-cors-allow-credentials" class="dlist">
<dl>
<dt class="hdlist1"><code>http.cors.allow-credentials</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Whether the <code>Access-Control-Allow-Credentials</code> header should be returned. Defaults to <code>false</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This header is only returned when the setting is set to <code>true</code>.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>http.detailed_errors.enabled</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
If <code>true</code>, enables the output of detailed error messages and stack traces in the response output. Defaults to <code>true</code>.</p>
<div class="paragraph">
<p>If <code>false</code>, use the <code>error_trace</code> parameter to <a href="api-conventions.html#common-options-error-options">enable stack traces</a> and return detailed error messages. Otherwise, only a simple message will be returned.</p>
</div>
</dd>
<dt class="hdlist1"><code>http.pipelining.max_events</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The maximum number of events to be queued up in memory before an HTTP connection is closed, defaults to <code>10000</code>.</p>
</dd>
<dt class="hdlist1"><code>http.max_warning_header_count</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The maximum number of warning headers in client HTTP responses. Defaults to <code>unbounded</code>.</p>
</dd>
<dt class="hdlist1"><code>http.max_warning_header_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The maximum total size of warning headers in client HTTP responses. Defaults to <code>unbounded</code>.</p>
</dd>
<dt class="hdlist1"><code>http.tcp.no_delay</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Enable or disable the <a href="https://en.wikipedia.org/wiki/Nagle%27s_algorithm">TCP no delay</a>
setting. Defaults to <code>network.tcp.no_delay</code>.</p>
</dd>
<dt class="hdlist1"><code>http.tcp.keep_alive</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>SO_KEEPALIVE</code> option for this socket, which
determines whether it sends TCP keepalive probes.
Defaults to <code>network.tcp.keep_alive</code>.</p>
</dd>
<dt class="hdlist1"><code>http.tcp.keep_idle</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>) Configures the <code>TCP_KEEPIDLE</code> option for this socket, which
determines the time in seconds that a connection must be idle before
starting to send TCP keepalive probes. Defaults to <code>network.tcp.keep_idle</code>, which
uses the system default. This value cannot exceed <code>300</code> seconds. Only applicable on
Linux and macOS, and requires Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>http.tcp.keep_interval</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>) Configures the <code>TCP_KEEPINTVL</code> option for this socket,
which determines the time in seconds between sending TCP keepalive probes.
Defaults to <code>network.tcp.keep_interval</code>, which uses the system default.
This value cannot exceed <code>300</code> seconds. Only applicable on Linux and macOS, and requires
Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>http.tcp.keep_count</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>) Configures the <code>TCP_KEEPCNT</code> option for this socket, which
determines the number of unacknowledged TCP keepalive probes that may be
sent on a connection before it is dropped. Defaults to <code>network.tcp.keep_count</code>,
which uses the system default. Only applicable on Linux and macOS, and
requires Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>http.tcp.reuse_address</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Should an address be reused or not. Defaults to <code>network.tcp.reuse_address</code>.</p>
</dd>
<dt class="hdlist1"><code>http.tcp.send_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The size of the TCP send buffer (specified with <a href="api-conventions.html#size-units">size units</a>).
Defaults to <code>network.tcp.send_buffer_size</code>.</p>
</dd>
<dt class="hdlist1"><code>http.tcp.receive_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The size of the TCP receive buffer (specified with <a href="api-conventions.html#size-units">size units</a>).
Defaults to <code>network.tcp.receive_buffer_size</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_rest_request_tracer">REST request tracer</h4>
<div class="paragraph">
<p>The HTTP layer has a dedicated tracer logger which, when activated, logs incoming requests. The log can be dynamically activated
by setting the level of the <code>org.opensearch.http.HttpTracer</code> logger to <code>TRACE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT _cluster/settings
{
   "transient" : {
      "logger.org.opensearch.http.HttpTracer" : "TRACE"
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also control which uris will be traced, using a set of include and exclude wildcard patterns. By default every request will be
traced.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT _cluster/settings
{
   "transient" : {
      "http.tracer.include" : "*",
      "http.tracer.exclude" : ""
   }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="index-management-settings">Index management settings</h3>
<div class="paragraph">
<p>You can use the following cluster settings to enable or disable index management
features.</p>
</div>
<div id="auto-create-index" class="dlist">
<dl>
<dt class="hdlist1"><code>action.auto_create_index</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
<a href="docs.html#index-creation">Automatically create an index</a> if it doesn&#8217;t already exist and apply any configured index templates. Defaults to <code>true</code>.</p>
</dd>
</dl>
</div>
<div id="action-destructive-requires-name" class="dlist">
<dl>
<dt class="hdlist1"><code>action.destructive_requires_name</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
When set to <code>true</code>, you must specify the index name to <a href="indices.html#indices-delete-index">delete an index</a>. It is not possible to delete all indices with <code>_all</code> or use wildcards.</p>
</dd>
</dl>
</div>
<div id="cluster-indices-close-enable" class="dlist">
<dl>
<dt class="hdlist1"><code>cluster.indices.close.enable</code></dt>
<dd>
<p>(<a href="settings.html#dynamic-cluster-setting">Dynamic</a>)
Enables <a href="indices.html#indices-open-close">opening of closed indices</a> in OpenSearch. You might enable this setting temporarily to change the analyzer configuration for an existing index. We strongly recommend leaving this set to <code>false</code> (the default) otherwise.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Closed indices are a data loss risk because they are not included when you make cluster configuration changes, such as scaling to a different capacity, failover, and many other operations. Additionally, closed indices can lead to inaccurate disk space counts.
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
<div id="reindex-remote-whitelist" class="dlist">
<dl>
<dt class="hdlist1"><code>reindex.remote.whitelist</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Specifies the hosts that can be <a href="docs.html#reindex-from-remote">reindexed from remotely</a>. Expects a YAML array of <code>host:port</code> strings. Consists of a comma-delimited list of <code>host:port</code> entries. Defaults to <code>["*.io:*", "*.com:*"]</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="recovery">Index recovery settings</h3>
<div class="paragraph">
<p>Peer recovery syncs data from a primary shard to a new or existing shard copy.</p>
</div>
<div class="paragraph">
<p>Peer recovery automatically occurs when OpenSearch:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Recreates a shard lost during node failure</p>
</li>
<li>
<p>Relocates a shard to another node due to a cluster rebalance or changes to the
<a href="settings.html#modules-cluster">shard allocation settings</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can view a list of in-progress and completed recoveries using the
<a href="cat.html#cat-recovery">cat recovery API</a>.</p>
</div>
<h4 id="_recovery_settings" class="discrete">Recovery settings</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>indices.recovery.max_bytes_per_sec</code></dt>
<dd>
<p>(<a href="cluster.html#cluster-update-settings">Dynamic</a>) Limits total inbound and outbound
recovery traffic for each node. Applies to both peer recoveries as well
as snapshot recoveries (i.e., restores from a snapshot). Defaults to <code>40mb</code>.</p>
<div class="paragraph">
<p>This limit applies to each node separately. If multiple nodes in a cluster
perform recoveries at the same time, the cluster&#8217;s total recovery traffic may
exceed this limit.</p>
</div>
<div class="paragraph">
<p>If this limit is too high, ongoing recoveries may consume an excess of bandwidth
and other resources, which can destabilize the cluster.</p>
</div>
<div class="paragraph">
<p>This is a dynamic setting, which means you can set it in each node&#8217;s
<code>opensearch.yml</code> config file and you can update it dynamically using the
<a href="cluster.html#cluster-update-settings">cluster update settings API</a>. If you set it
dynamically then the same limit applies on every node in the cluster. If you do
not set it dynamically then you can set a different limit on each node, which is
useful if some of your nodes have better bandwidth than others.</p>
</div>
</dd>
</dl>
</div>
<h4 id="_expert_peer_recovery_settings" class="discrete">Expert peer recovery settings</h4>
<div class="paragraph">
<p>You can use the following <em>expert</em> setting to manage resources for peer
recoveries.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>indices.recovery.max_concurrent_file_chunks</code></dt>
<dd>
<p>(<a href="cluster.html#cluster-update-settings">Dynamic</a>, Expert) Number of file chunk requests
sent in parallel for each recovery. Defaults to <code>2</code>.</p>
<div class="paragraph">
<p>You can increase the value of this setting when the recovery of a single shard
is not reaching the traffic limit set by <code>indices.recovery.max_bytes_per_sec</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>indices.recovery.max_concurrent_operations</code></dt>
<dd>
<p>(<a href="cluster.html#cluster-update-settings">Dynamic</a>, Expert) Number of operations sent
in parallel for each recovery. Defaults to <code>1</code>.</p>
<div class="paragraph">
<p>Concurrently replaying operations during recovery can be very resource-intensive
and may interfere with indexing, search, and other activities in your cluster.
Do not increase this setting without carefully verifying that your cluster has
the resources available to handle the extra load that will result.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="indexing-buffer">Indexing buffer settings</h3>
<div class="paragraph">
<p>The indexing buffer is used to store newly indexed documents.  When it fills
up, the documents in the buffer are written to a segment on disk. It is divided
between all shards on the node.</p>
</div>
<div class="paragraph">
<p>The following settings are <em>static</em> and must be configured on every data node
in the cluster:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>indices.memory.index_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Accepts either a percentage or a byte size value. It defaults to <code>10%</code>,
meaning that <code>10%</code> of the total heap allocated to a node will be used as the
indexing buffer size shared across all shards.</p>
</dd>
<dt class="hdlist1"><code>indices.memory.min_index_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
If the <code>index_buffer_size</code> is specified as a percentage, then this
setting can be used to specify an absolute minimum.  Defaults to <code>48mb</code>.</p>
</dd>
<dt class="hdlist1"><code>indices.memory.max_index_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
If the <code>index_buffer_size</code> is specified as a percentage, then this
setting can be used to specify an absolute maximum.  Defaults to unbounded.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="modules-gateway">Local gateway settings</h3>
<div class="paragraph">
<p>The local gateway stores the cluster state and shard data across full
cluster restarts.</p>
</div>
<div class="paragraph">
<p>The following <em>static</em> settings, which must be set on every master node,
control how long a freshly elected master should wait before it tries to
recover the cluster state and the cluster&#8217;s data.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These settings only take effect on a full cluster restart.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gateway.expected_nodes</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Deprecated. Use <code>gateway.expected_data_nodes</code> instead.
Number of data or master nodes expected in the cluster.
Recovery of local shards begins when the expected number of
nodes join the cluster. Defaults to <code>0</code>.</p>
</dd>
<dt class="hdlist1"><code>gateway.expected_master_nodes</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Deprecated. Use <code>gateway.expected_data_nodes</code> instead.
Number of master nodes expected in the cluster.
Recovery of local shards begins when the expected number of
master nodes join the cluster. Defaults to <code>0</code>.</p>
</dd>
<dt class="hdlist1"><code>gateway.expected_data_nodes</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Number of data nodes expected in the cluster.
Recovery of local shards begins when the expected number of
data nodes join the cluster. Defaults to <code>0</code>.</p>
</dd>
<dt class="hdlist1"><code>gateway.recover_after_time</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
If the expected number of nodes is not achieved, the recovery process waits
for the configured amount of time before trying to recover.
Defaults to <code>5m</code> if one of the <code>expected_nodes</code> settings is configured.</p>
<div class="paragraph">
<p>Once the <code>recover_after_time</code> duration has timed out, recovery will start
as long as the following conditions are met:</p>
</div>
</dd>
<dt class="hdlist1"><code>gateway.recover_after_nodes</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Deprecated. Use <code>gateway.recover_after_data_nodes</code> instead.
Recover as long as this many data or master nodes have joined the cluster.</p>
</dd>
<dt class="hdlist1"><code>gateway.recover_after_master_nodes</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Deprecated. Use <code>gateway.recover_after_data_nodes</code> instead.
Recover as long as this many master nodes have joined the cluster.</p>
</dd>
<dt class="hdlist1"><code>gateway.recover_after_data_nodes</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Recover as long as this many data nodes have joined the cluster.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="dangling-indices">Dangling indices</h4>
<div class="paragraph">
<p>When a node joins the cluster, if it finds any shards stored in its local data
directory that do not already exist in the cluster, it will consider those
shards to be "dangling". Importing dangling indices
into the cluster using <code>gateway.auto_import_dangling_indices</code> is not safe.
Instead, use the <a href="indices.html#dangling-indices-api">Dangling indices API</a>. Neither
mechanism provides any guarantees as to whether the imported data truly
represents the latest state of the data when the index was still part of
the cluster.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>gateway.auto_import_dangling_indices</code></dt>
<dd>
<p>Deprecated. Use the dedicated dangling indices API instead.
Whether to automatically import dangling indices into the cluster
state, provided no indices already exist with the same name. Defaults
to <code>false</code>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The auto-import functionality was intended as a best effort to help users
who lose all master nodes. For example, if a new master node were to be
started which was unaware of the other indices in the cluster, adding the
old nodes would cause the old indices to be imported, instead of being
deleted. However there are several issues with automatic importing, and
its use is strongly discouraged in favour of the
&lt;&lt;dangling-indices-api,dedicated API&gt;.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Losing all master nodes is a situation that should be avoided at
all costs, as it puts your cluster&#8217;s metadata and data at risk.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logging">Logging</h3>
<style>
.tabs {
  width: 100%;
}
[role="tablist"] {
  margin: 0 0 -0.1em;
  overflow: visible;
}
[role="tab"] {
  position: relative;
  padding: 0.3em 0.5em 0.4em;
  border: 1px solid hsl(219, 1%, 72%);
  border-radius: 0.2em 0.2em 0 0;
  overflow: visible;
  font-family: inherit;
  font-size: inherit;
  background: hsl(220, 20%, 94%);
}
[role="tab"]:hover::before,
[role="tab"]:focus::before,
[role="tab"][aria-selected="true"]::before {
  position: absolute;
  bottom: 100%;
  right: -1px;
  left: -1px;
  border-radius: 0.2em 0.2em 0 0;
  border-top: 3px solid hsl(219, 1%, 72%);
  content: '';
}
[role="tab"][aria-selected="true"] {
  border-radius: 0;
  background: hsl(220, 43%, 99%);
  outline: 0;
}
[role="tab"][aria-selected="true"]:not(:focus):not(:hover)::before {
  border-top: 5px solid hsl(218, 96%, 48%);
}
[role="tab"][aria-selected="true"]::after {
  position: absolute;
  z-index: 3;
  bottom: -1px;
  right: 0;
  left: 0;
  height: 0.3em;
  background: hsl(220, 43%, 99%);
  box-shadow: none;
  content: '';
}
[role="tab"]:hover,
[role="tab"]:focus,
[role="tab"]:active {
  outline: 0;
  border-radius: 0;
  color: inherit;
}
[role="tab"]:hover::before,
[role="tab"]:focus::before {
  border-color: hsl(218, 96%, 48%);
}
[role="tabpanel"] {
  position: relative;
  z-index: 2;
  padding: 1em;
  border: 1px solid hsl(219, 1%, 72%);
  border-radius: 0 0.2em 0.2em 0.2em;
  box-shadow: 0 0 0.2em hsl(219, 1%, 72%);
  background: hsl(220, 43%, 99%);
  margin-bottom: 1em;
}
[role="tabpanel"] p {
  margin: 0;
}
[role="tabpanel"] * + p {
  margin-top: 1em;
}
</style>
<script>
window.addEventListener("DOMContentLoaded", () => {
  const tabs = document.querySelectorAll('[role="tab"]');
  const tabList = document.querySelector('[role="tablist"]');
  // Add a click event handler to each tab
  tabs.forEach(tab => {
    tab.addEventListener("click", changeTabs);
  });
  // Enable arrow navigation between tabs in the tab list
  let tabFocus = 0;
  tabList.addEventListener("keydown", e => {
    // Move right
    if (e.keyCode === 39 || e.keyCode === 37) {
      tabs[tabFocus].setAttribute("tabindex", -1);
      if (e.keyCode === 39) {
        tabFocus++;
        // If we're at the end, go to the start
        if (tabFocus >= tabs.length) {
          tabFocus = 0;
        }
        // Move left
      } else if (e.keyCode === 37) {
        tabFocus--;
        // If we're at the start, move to the end
        if (tabFocus < 0) {
          tabFocus = tabs.length - 1;
        }
      }
      tabs[tabFocus].setAttribute("tabindex", 0);
      tabs[tabFocus].focus();
    }
  });
});
function setActiveTab(target) {
  const parent = target.parentNode;
  const grandparent = parent.parentNode;
  // console.log(grandparent);
  // Remove all current selected tabs
  parent
    .querySelectorAll('[aria-selected="true"]')
    .forEach(t => t.setAttribute("aria-selected", false));
  // Set this tab as selected
  target.setAttribute("aria-selected", true);
  // Hide all tab panels
  grandparent
    .querySelectorAll('[role="tabpanel"]')
    .forEach(p => p.setAttribute("hidden", true));
  // Show the selected panel
  grandparent.parentNode
    .querySelector(`#${target.getAttribute("aria-controls")}`)
    .removeAttribute("hidden");
}
function changeTabs(e) {
  // get the containing list of the tab that was just clicked
  const tabList = e.target.parentNode;

  // get all of the sibling tabs
  const buttons = Array.apply(null, tabList.querySelectorAll('button'));

  // loop over the siblings to discover which index thje clicked one was
  const { index } = buttons.reduce(({ found, index }, button) => {
    if (!found && buttons[index] === e.target) {
      return { found: true, index };
    } else if (!found) {
      return { found, index: index + 1 };
    } else {
      return { found, index };
    }
  }, { found: false, index: 0 });

  // get the tab container
  const container = tabList.parentNode;
  // read the data-tab-group value from the container, e.g. "os"
  const { tabGroup } = container.dataset;
  // get a list of all the tab groups that match this value on the page
  const groups = document.querySelectorAll('[data-tab-group=' + tabGroup + ']');

  // for each of the found tab groups, find the tab button at the previously discovered index and select it for each group
  groups.forEach((group) => {
    const target = group.querySelectorAll('button')[index];
    setActiveTab(target);
  });
}
</script>
<div class="paragraph">
<p>You can use OpenSearch&#8217;s application logs to monitor your cluster and diagnose issues.
If you run OpenSearch as a service, the default location of the logs varies based on
your platform and installation method:</p>
</div>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="logs">
    <button role="tab"
            aria-selected="true"
            aria-controls="docker-tab-logs"
            id="docker-logs">
      Docker
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="deb-tab-logs"
            id="deb-logs">
      Debian (APT)
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="rpm-tab-logs"
            id="rpm-logs"
            tabindex="-1">
      RPM
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="mac-tab-logs"
            id="mac-logs"
            tabindex="-1">
      macOS
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="brew-tab-logs"
            id="brew-logs"
            tabindex="-1">
      Brew
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="linux-tab-logs"
            id="linux-logs"
            tabindex="-1">
      Linux
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="win-zip-tab-logs"
            id="win-zip-logs"
            tabindex="-1">
      Windows .zip
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="docker-tab-logs"
       aria-labelledby="docker-logs">
<div class="paragraph">
<p>On <a href="install-opensearch.html#docker">Docker</a>, log messages go to the console and are handled by the
configured Docker logging driver. To access logs, run <code>docker logs</code>.</p>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="deb-tab-logs"
       aria-labelledby="deb-logs"
       hidden="">
<div class="paragraph">
<p>For <a href="install-opensearch.html#deb">Debian installations</a>, OpenSearch writes logs to <code>/var/log/opensearch</code>.</p>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="rpm-tab-logs"
       aria-labelledby="rpm-logs"
       hidden="">
<div class="paragraph">
<p>For <a href="install-opensearch.html#rpm">RPM installations</a>, OpenSearch writes logs to <code>/var/log/opensearch</code>.</p>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="mac-tab-logs"
       aria-labelledby="mac-logs"
       hidden="">
<div class="paragraph">
<p>For <a href="install-opensearch.html#targz">macOS <code>.tar.gz</code></a> installations, OpenSearch writes logs to
<code>$OPENSEARCH_HOME/logs</code>.</p>
</div>
<div class="paragraph">
<p>Files in <code>$OPENSEARCH_HOME</code> risk deletion during an upgrade. In production, we strongly
recommend you set <code>path.logs</code> to a location outside of <code>$OPENSEARCH_HOME</code>.
See <a href="important-settings.html#path-settings">Path settings</a>.</p>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="brew-tab-logs"
       aria-labelledby="brew-logs"
       hidden="">
<div class="paragraph">
<p>For <a href="install-opensearch.html#brew">macOS Homebrew</a> installations, OpenSearch writes logs to
<code>/usr/local/var/log/opensearch</code>.</p>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="linux-tab-logs"
       aria-labelledby="linux-logs"
       hidden="">
<div class="paragraph">
<p>For <a href="install-opensearch.html#targz">Linux <code>.tar.gz</code></a> installations, OpenSearch writes logs to
<code>$OPENSEARCH_HOME/logs</code>.</p>
</div>
<div class="paragraph">
<p>Files in <code>$OPENSEARCH_HOME</code> risk deletion during an upgrade. In production, we strongly
recommend you set <code>path.logs</code> to a location outside of <code>$OPENSEARCH_HOME</code>.
See <a href="important-settings.html#path-settings">Path settings</a>.</p>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="win-zip-tab-logs"
       aria-labelledby="win-zip-logs"
       hidden="">
<div class="paragraph">
<p>For <a href="install-opensearch.html#zip-windows">Windows <code>.zip</code></a> installations, OpenSearch writes logs to
<code>%OPENSEARCH_HOME%\logs</code>.</p>
</div>
<div class="paragraph">
<p>Files in <code>%OPENSEARCH_HOME%</code> risk deletion during an upgrade. In production, we strongly
recommend you set <code>path.logs</code> to a location outside of <code>%OPENSEARCH_HOME%`</code>.
See <a href="important-settings.html#path-settings">Path settings</a>.</p>
</div>
  </div>
</div>
<div class="paragraph">
<p>If you run OpenSearch from the command line, OpenSearch prints logs to the standard output
(<code>stdout</code>).</p>
</div>
<h3 id="loggin-configuration" class="discrete">Logging configuration</h3>
<div class="paragraph">
<p>OpenSearch uses <a href="https://logging.apache.org/log4j/2.x/">Log4j 2</a> for
logging. Log4j 2 can be configured using the log4j2.properties
file. OpenSearch exposes three properties, <code>${sys:opensearch.logs.base_path}</code>,
<code>${sys:opensearch.logs.cluster_name}</code>, and <code>${sys:opensearch.logs.node_name}</code> that can be
referenced in the configuration file to determine the location of the log
files. The property <code>${sys:opensearch.logs.base_path}</code> will resolve to the log directory,
<code>${sys:opensearch.logs.cluster_name}</code> will resolve to the cluster name (used as the
prefix of log filenames in the default configuration), and
<code>${sys:opensearch.logs.node_name}</code> will resolve to the node name (if the node name is
explicitly set).</p>
</div>
<div class="paragraph">
<p>For example, if your log directory (<code>path.logs</code>) is <code>/var/log/opensearch</code> and
your cluster is named <code>production</code> then <code>${sys:opensearch.logs.base_path}</code> will resolve
to <code>/var/log/opensearch</code> and
<code>${sys:opensearch.logs.base_path}${sys:file.separator}${sys:opensearch.logs.cluster_name}.log</code>
will resolve to <code>/var/log/opensearch/production.log</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">######## Server JSON ############################
appender.rolling.type = RollingFile <b class="conum">(1)</b>
appender.rolling.name = rolling
appender.rolling.fileName = ${sys:opensearch.logs.base_path}${sys:file.separator}${sys:opensearch.logs.cluster_name}_server.json <b class="conum">(2)</b>
appender.rolling.layout.type = OpenSearchJsonLayout <b class="conum">(3)</b>
appender.rolling.layout.type_name = server <b class="conum">(4)</b>
appender.rolling.filePattern = ${sys:opensearch.logs.base_path}${sys:file.separator}${sys:opensearch.logs.cluster_name}-%d{yyyy-MM-dd}-%i.json.gz <b class="conum">(5)</b>
appender.rolling.policies.type = Policies
appender.rolling.policies.time.type = TimeBasedTriggeringPolicy <b class="conum">(6)</b>
appender.rolling.policies.time.interval = 1 <b class="conum">(7)</b>
appender.rolling.policies.time.modulate = true <b class="conum">(8)</b>
appender.rolling.policies.size.type = SizeBasedTriggeringPolicy <b class="conum">(9)</b>
appender.rolling.policies.size.size = 256MB <b class="conum">(10)</b>
appender.rolling.strategy.type = DefaultRolloverStrategy
appender.rolling.strategy.fileIndex = nomax
appender.rolling.strategy.action.type = Delete <b class="conum">(11)</b>
appender.rolling.strategy.action.basepath = ${sys:opensearch.logs.base_path}
appender.rolling.strategy.action.condition.type = IfFileName <b class="conum">(12)</b>
appender.rolling.strategy.action.condition.glob = ${sys:opensearch.logs.cluster_name}-* <b class="conum">(13)</b>
appender.rolling.strategy.action.condition.nested_condition.type = IfAccumulatedFileSize <b class="conum">(14)</b>
appender.rolling.strategy.action.condition.nested_condition.exceeds = 2GB <b class="conum">(15)</b>
################################################</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Configure the <code>RollingFile</code> appender</p>
</li>
<li>
<p>Log to <code>/var/log/opensearch/production_server.json</code></p>
</li>
<li>
<p>Use JSON layout.</p>
</li>
<li>
<p><code>type_name</code> is a flag populating the <code>type</code> field in a <code>OpenSearchJsonLayout</code>.
It can be used to distinguish different types of logs more easily when parsing them.</p>
</li>
<li>
<p>Roll logs to <code>/var/log/opensearch/production-yyyy-MM-dd-i.json</code>; logs
will be compressed on each roll and <code>i</code> will be incremented</p>
</li>
<li>
<p>Use a time-based roll policy</p>
</li>
<li>
<p>Roll logs on a daily basis</p>
</li>
<li>
<p>Align rolls on the day boundary (as opposed to rolling every twenty-four
hours)</p>
</li>
<li>
<p>Using a size-based roll policy</p>
</li>
<li>
<p>Roll logs after 256 MB</p>
</li>
<li>
<p>Use a delete action when rolling logs</p>
</li>
<li>
<p>Only delete logs matching a file pattern</p>
</li>
<li>
<p>The pattern is to only delete the main logs</p>
</li>
<li>
<p>Only delete if we have accumulated too many compressed logs</p>
</li>
<li>
<p>The size condition on the compressed logs is 2 GB</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">######## Server -  old style pattern ###########
appender.rolling_old.type = RollingFile
appender.rolling_old.name = rolling_old
appender.rolling_old.fileName = ${sys:opensearch.logs.base_path}${sys:file.separator}${sys:opensearch.logs.cluster_name}_server.log <b class="conum">(1)</b>
appender.rolling_old.layout.type = PatternLayout
appender.rolling_old.layout.pattern = [%d{ISO8601}][%-5p][%-25c{1.}] [%node_name]%marker %m%n
appender.rolling_old.filePattern = ${sys:opensearch.logs.base_path}${sys:file.separator}${sys:opensearch.logs.cluster_name}-%d{yyyy-MM-dd}-%i.old_log.gz</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>The configuration for <code>old style</code> pattern appenders. These logs will be saved in <code><strong>.log</code> files and if archived will be in <code></strong>
.log.gz</code> files. Note that these should be considered deprecated and will be removed in the future.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Log4j&#8217;s configuration parsing gets confused by any extraneous whitespace;
if you copy and paste any Log4j settings on this page, or enter any Log4j
configuration in general, be sure to trim any leading and trailing whitespace.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note than you can replace <code>.gz</code> by <code>.zip</code> in <code>appender.rolling.filePattern</code> to
compress the rolled logs using the zip format. If you remove the <code>.gz</code>
extension then logs will not be compressed as they are rolled.</p>
</div>
<div class="paragraph">
<p>If you want to retain log files for a specified period of time, you can use a
rollover strategy with a delete action.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">appender.rolling.strategy.type = DefaultRolloverStrategy <b class="conum">(1)</b>
appender.rolling.strategy.action.type = Delete <b class="conum">(2)</b>
appender.rolling.strategy.action.basepath = ${sys:opensearch.logs.base_path} <b class="conum">(3)</b>
appender.rolling.strategy.action.condition.type = IfFileName <b class="conum">(4)</b>
appender.rolling.strategy.action.condition.glob = ${sys:opensearch.logs.cluster_name}-* <b class="conum">(5)</b>
appender.rolling.strategy.action.condition.nested_condition.type = IfLastModified <b class="conum">(6)</b>
appender.rolling.strategy.action.condition.nested_condition.age = 7D <b class="conum">(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Configure the <code>DefaultRolloverStrategy</code></p>
</li>
<li>
<p>Configure the <code>Delete</code> action for handling rollovers</p>
</li>
<li>
<p>The base path to the OpenSearch logs</p>
</li>
<li>
<p>The condition to apply when handling rollovers</p>
</li>
<li>
<p>Delete files from the base path matching the glob
<code>${sys:opensearch.logs.cluster_name}-*</code>; this is the glob that log files are rolled
to; this is needed to only delete the rolled OpenSearch logs but not also
delete the deprecation and slow logs</p>
</li>
<li>
<p>A nested condition to apply to files matching the glob</p>
</li>
<li>
<p>Retain logs for seven days</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Multiple configuration files can be loaded (in which case they will get merged)
as long as they are named <code>log4j2.properties</code> and have the OpenSearch config
directory as an ancestor; this is useful for plugins that expose additional
loggers. The logger section contains the java packages and their corresponding
log level. The appender section contains the destinations for the logs.
Extensive information on how to customize logging and all the supported
appenders can be found on the
<a href="https://logging.apache.org/log4j/2.x/manual/configuration.html">Log4j
documentation</a>.</p>
</div>
<h3 id="configuring-logging-levels" class="discrete">Configuring logging levels</h3>
<div class="paragraph">
<p>Each Java package in the <a href="https://github.com/opensearch-project/OpenSearch">OpenSearch source code</a> has a related logger. For
example, the <code>org.opensearch.discovery</code> package has
<code>logger.org.opensearch.discovery</code> for logs related to the
<a href="modules-discovery.html#modules-discovery-hosts-providers">discovery</a> process.</p>
</div>
<div class="paragraph">
<p>To get more or less verbose logs, use the <a href="cluster.html#cluster-update-settings">cluster
update settings API</a> to change the related logger&#8217;s log level. Each logger
accepts Log4j 2&#8217;s built-in log levels, from least to most verbose: <code>OFF</code>,
<code>FATAL</code>, <code>ERROR</code>, <code>WARN</code>, <code>INFO</code>, <code>DEBUG</code>, and <code>TRACE</code>. The default log level is
<code>INFO</code>. Messages logged at higher verbosity levels (<code>DEBUG</code> and <code>TRACE</code>) are
only intended for expert use.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /_cluster/settings
{
  "transient": {
    "logger.org.opensearch.discovery": "DEBUG"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other ways to change log levels include:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>opensearch.yml</code>:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">logger.org.opensearch.discovery: DEBUG</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is most appropriate when debugging a problem on a single node.</p>
</div>
</div>
</div>
</li>
<li>
<p><code>log4j2.properties</code>:</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logger.discovery.name = org.opensearch.discovery
logger.discovery.level = debug</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is most appropriate when you already need to change your Log4j 2
configuration for other reasons. For example, you may want to send logs for a
particular logger to another file. However, these use cases are rare.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<h3 id="deprecation-logging" class="discrete">Deprecation logging</h3>
<div class="paragraph">
<p>In addition to regular logging, OpenSearch allows you to enable logging
of deprecated actions. For example this allows you to determine early, if
you need to migrate certain functionality in the future. By default,
deprecation logging is enabled at the WARN level, the level at which all
deprecation log messages will be emitted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logger.deprecation.level = warn</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create a daily rolling deprecation log file in your log directory.
Check this file regularly, especially when you intend to upgrade to a new
major version.</p>
</div>
<div class="paragraph">
<p>The default logging configuration has set the roll policy for the deprecation
logs to roll and compress after 1 GB, and to preserve a maximum of five log
files (four rolled logs, and the active log).</p>
</div>
<div class="paragraph">
<p>You can disable it in the <code>config/log4j2.properties</code> file by setting the deprecation
log level to <code>error</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logger.deprecation.name = org.opensearch.deprecation
logger.deprecation.level = error</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can identify what is triggering deprecated functionality if <code>X-Opaque-Id</code> was used as an HTTP header.
The user ID is included in the <code>X-Opaque-ID</code> field in deprecation JSON logs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-js" data-lang="js">{
  "type": "deprecation",
  "timestamp": "2019-08-30T12:07:07,126+02:00",
  "level": "WARN",
  "component": "o.e.d.r.a.a.i.RestCreateIndexAction",
  "cluster.name": "distribution_run",
  "node.name": "node-0",
  "message": "[types removal] Using include_type_name in create index requests is deprecated. The parameter will be removed in the next major version.",
  "x-opaque-id": "MY_USER_ID",
  "cluster.uuid": "Aq-c-PAeQiK3tfBYtig9Bw",
  "node.id": "D7fUYfnfTLa2D7y-xw6tZg"
}</code></pre>
</div>
</div>
<h3 id="json-logging" class="discrete">JSON log format</h3>
<div class="paragraph">
<p>To make parsing OpenSearch logs easier, logs are now printed in a JSON format.
This is configured by a Log4J layout property <code>appender.rolling.layout.type = OpenSearchJsonLayout</code>.
This layout requires a <code>type_name</code> attribute to be set which is used to distinguish
logs streams when parsing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">appender.rolling.layout.type = OpenSearchJsonLayoutLayout
appender.rolling.layout.type_name = server</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each line contains a single JSON document with the properties configured in <code>OpenSearchJsonLayout</code>.
See this class <a href="https://artifacts.opensearch.org/javadoc/org/opensearch/opensearch/{version}/org/opensearch/common/logging/OpenSearchJsonLayout.html">javadoc</a> for more details.
However if a JSON document contains an exception, it will be printed over multiple lines.
The first line will contain regular properties and subsequent lines will contain the
stacktrace formatted as a JSON array.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can still use your own custom layout. To do that replace the line
<code>appender.rolling.layout.type</code> with a different layout. See sample below:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">appender.rolling.type = RollingFile
appender.rolling.name = rolling
appender.rolling.fileName = ${sys:opensearch.logs.base_path}${sys:file.separator}${sys:opensearch.logs.cluster_name}_server.log
appender.rolling.layout.type = PatternLayout
appender.rolling.layout.pattern = [%d{ISO8601}][%-5p][%-25c{1.}] [%node_name]%marker %.-10000m%n
appender.rolling.filePattern = ${sys:opensearch.logs.base_path}${sys:file.separator}${sys:opensearch.logs.cluster_name}-%d{yyyy-MM-dd}-%i.log.gz</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modules-node">Node</h3>
<div class="paragraph">
<p>Any time that you start an instance of OpenSearch, you are starting a <em>node</em>. A
collection of connected nodes is called a <a href="settings.html#modules-cluster">cluster</a>. If you
are running a single node of OpenSearch, then you have a cluster of one node.</p>
</div>
<div class="paragraph">
<p>Every node in the cluster can handle <a href="settings.html#modules-http">HTTP</a> and
<a href="settings.html#modules-transport">Transport</a> traffic by default. The transport layer is used
exclusively for communication between nodes; the HTTP layer is used by REST
clients.</p>
</div>
<div id="modules-node-description" class="paragraph">
<p>All nodes know about all the other nodes in the cluster and can forward client
requests to the appropriate node.</p>
</div>
<div class="paragraph">
<p>By default, a node is all of the following types: master-eligible, data, ingest,
and (if available) machine learning. All data nodes are also transform nodes.</p>
</div>
<div class="sect3">
<h4 id="node-roles">Node roles</h4>
<div class="paragraph">
<p>You can define the roles of a node by setting <code>node.roles</code>. If you don&#8217;t
configure this setting, then the node has the following roles by default:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>master</code></p>
</li>
<li>
<p><code>data</code></p>
</li>
<li>
<p><code>ingest</code></p>
</li>
<li>
<p><code>remote_cluster_client</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you set <code>node.roles</code>, the node is assigned only the roles you specify.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="settings.html#master-node">Master-eligible node</a></dt>
<dd>
<p>A node that has the <code>master</code> role (default), which makes it eligible to be
<a href="modules-discovery.html">elected as the <em>master</em> node</a>, which controls the cluster.</p>
</dd>
<dt class="hdlist1"><a href="settings.html#data-node">Data node</a></dt>
<dd>
<p>A node that has the <code>data</code> role (default). Data nodes hold data and perform data
related operations such as CRUD, search, and aggregations. A node with the <code>data</code> role can fill any of the specialised data node roles.</p>
</dd>
<dt class="hdlist1"><a href="settings.html#node-ingest-node">Ingest node</a></dt>
<dd>
<p>A node that has the <code>ingest</code> role (default). Ingest nodes are able to apply an
<a href="pipeline.html">ingest pipeline</a> to a document in order to transform and enrich the
document before indexing. With a heavy ingest load, it makes sense to use
dedicated ingest nodes and to not include the <code>ingest</code> role from nodes that have
the <code>master</code> or <code>data</code> roles.</p>
</dd>
<dt class="hdlist1"><a href="settings.html#remote-node">Remote-eligible node</a></dt>
<dd>
<p>A node that has the <code>remote_cluster_client</code> role (default), which makes it
eligible to act as a remote client. By default, any node in the cluster can act
as a cross-cluster client and connect to remote clusters.</p>
</dd>
</dl>
</div>
<div id="coordinating-node" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Coordinating node</div>
<div class="paragraph">
<p>Requests like search requests or bulk-indexing requests may involve data held
on different data nodes. A search request, for example, is executed in two
phases which are coordinated by the node which receives the client request&#8201;&#8212;&#8201;the <em>coordinating node</em>.</p>
</div>
<div class="paragraph">
<p>In the <em>scatter</em> phase, the coordinating node forwards the request to the data
nodes which hold the data.  Each data node executes the request locally and
returns its results to the coordinating node. In the <em>gather</em>  phase, the
coordinating node reduces each data node&#8217;s results into a single global
result set.</p>
</div>
<div class="paragraph">
<p>Every node is implicitly a coordinating node. This means that a node that has
an explicit empty list of roles via <code>node.roles</code> will only act as a coordinating
node, which cannot be disabled. As a result, such a node needs to have enough
memory and CPU in order to deal with the gather phase.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="master-node">Master-eligible node</h4>
<div class="paragraph">
<p>The master node is responsible for lightweight cluster-wide actions such as
creating or deleting an index, tracking which nodes are part of the cluster,
and deciding which shards to allocate to which nodes. It is important for
cluster health to have a stable master node.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Master nodes must have access to the <code>data/</code> directory (just like
<code>data</code> nodes) as this is where the cluster state is persisted between node
restarts.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="dedicated-master-node">Dedicated master-eligible node</h5>
<div class="paragraph">
<p>It is important for the health of the cluster that the elected master node has
the resources it needs to fulfill its responsibilities. If the elected master
node is overloaded with other tasks then the cluster may not operate well. In
particular, indexing and searching your data can be very resource-intensive, so
in large or high-throughput clusters it is a good idea to avoid using the
master-eligible nodes for tasks such as indexing and searching. You can do this
by configuring three of your nodes to be dedicated master-eligible nodes.
Dedicated master-eligible nodes only have the <code>master</code> role, allowing them to
focus on managing the cluster. While master nodes can also behave as
<a href="settings.html#coordinating-node">coordinating nodes</a> and route search and indexing requests
from clients to data nodes, it is better <em>not</em> to use dedicated master nodes for
this purpose.</p>
</div>
<div class="paragraph">
<p>To create a dedicated master-eligible node, set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">node.roles: [ master ]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="data-node">Data node</h4>
<div class="paragraph">
<p>Data nodes hold the shards that contain the documents you have indexed. Data
nodes handle data related operations like CRUD, search, and aggregations.
These operations are I/O-, memory-, and CPU-intensive. It is important to
monitor these resources and to add more data nodes if they are overloaded.</p>
</div>
<div class="paragraph">
<p>The main benefit of having dedicated data nodes is the separation of the master
and data roles.</p>
</div>
<div class="paragraph">
<p>To create a dedicated data node, set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">node.roles: [ data ]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="node-ingest-node">Ingest node</h4>
<div class="paragraph">
<p>Ingest nodes can execute pre-processing pipelines, composed of one or more
ingest processors. Depending on the type of operations performed by the ingest
processors and the required resources, it may make sense to have dedicated
ingest nodes, that will only perform this specific task.</p>
</div>
<div class="paragraph">
<p>To create a dedicated ingest node, set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">node.roles: [ ingest ]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="coordinating-only-node">Coordinating only node</h4>
<div class="paragraph">
<p>If you take away the ability to be able to handle master duties, to hold data,
and pre-process documents, then you are left with a <em>coordinating</em> node that
can only route requests, handle the search reduce phase, and distribute bulk
indexing. Essentially, coordinating only nodes behave as smart load balancers.</p>
</div>
<div class="paragraph">
<p>Coordinating only nodes can benefit large clusters by offloading the
coordinating node role from data and master-eligible nodes.  They join the
cluster and receive the full <a href="cluster.html#cluster-state">cluster state</a>, like every other
node, and they use the cluster state to route requests directly to the
appropriate place(s).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Adding too many coordinating only nodes to a cluster can increase the
burden on the entire cluster because the elected master node must await
acknowledgement of cluster state updates from every node! The benefit of
coordinating only nodes should not be overstated&#8201;&#8212;&#8201;data nodes can happily
serve the same purpose.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To create a dedicated coordinating node, set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">node.roles: [ ]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="remote-node">Remote-eligible node</h4>
<div class="paragraph">
<p>By default, any node in a cluster can act as a cross-cluster client and connect
to <a href="modules-remote-clusters.html">remote clusters</a>. Once connected, you can search
remote clusters using <a href="modules-cross-cluster-search.html">cross-cluster search</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">node.roles: [ remote_cluster_client ]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="change-node-role">Changing the role of a node</h4>
<div class="paragraph">
<p>Each data node maintains the following data on disk:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the shard data for every shard allocated to that node,</p>
</li>
<li>
<p>the index metadata corresponding with every shard allocated to that node, and</p>
</li>
<li>
<p>the cluster-wide metadata, such as settings and index templates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Similarly, each master-eligible node maintains the following data on disk:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the index metadata for every index in the cluster, and</p>
</li>
<li>
<p>the cluster-wide metadata, such as settings and index templates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each node checks the contents of its data path at startup. If it discovers
unexpected data then it will refuse to start. This is to avoid importing
unwanted <a href="getting-started-modify-data.html#modules-gateway-dangling-indices">dangling indices</a> which can lead
to a red cluster health. To be more precise, nodes without the <code>data</code> role will
refuse to start if they find any shard data on disk at startup, and nodes
without both the <code>master</code> and <code>data</code> roles will refuse to start if they have any
index metadata on disk at startup.</p>
</div>
<div class="paragraph">
<p>It is possible to change the roles of a node by adjusting its
<code>opensearch.yml</code> file and restarting it. This is known as <em>repurposing</em> a
node. In order to satisfy the checks for unexpected data described above, you
must perform some extra steps to prepare a node for repurposing when starting
the node without the <code>data</code> or <code>master</code> roles.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you want to repurpose a data node by removing the <code>data</code> role then you
should first use an <a href="getting-started-modify-data.html#allocation-filtering">allocation filter</a> to safely
migrate all the shard data onto other nodes in the cluster.</p>
</li>
<li>
<p>If you want to repurpose a node to have neither the <code>data</code> nor <code>master</code> roles
then it is simplest to start a brand-new node with an empty data path and the
desired roles. You may find it safest to use an
<a href="getting-started-modify-data.html#allocation-filtering">allocation filter</a> to migrate the shard data elsewhere
in the cluster first.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If it is not possible to follow these extra steps then you may be able to use
the <a href="node-tool.html#node-tool-repurpose"><code>opensearch-node repurpose</code></a> tool to delete any
excess data that prevents a node from starting.</p>
</div>
<h3 id="_node_data_path_settings" class="discrete">Node data path settings</h3>
</div>
<div class="sect3">
<h4 id="data-path"><code>path.data</code></h4>
<div class="paragraph">
<p>Every data and master-eligible node requires access to a data directory where
shards and index and cluster metadata will be stored. The <code>path.data</code> defaults
to <code>$OPENSEARCH_HOME/data</code> but can be configured in the <code>opensearch.yml</code> config
file an absolute path or a path relative to <code>$OPENSEARCH_HOME</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">path.data:  /var/opensearch/data</code></pre>
</div>
</div>
<div class="paragraph">
<p>Like all node settings, it can also be specified on the command line as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">./bin/opensearch -Epath.data=/var/opensearch/data</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
When using the <code>.zip</code> or <code>.tar.gz</code> distributions, the <code>path.data</code> setting
should be configured to locate the data directory outside the OpenSearch home
directory, so that the home directory can be deleted without deleting your data!
The RPM and Debian distributions do this for you already.
</td>
</tr>
</table>
</div>
<h3 id="max-local-storage-nodes" class="discrete"><code>node.max_local_storage_nodes</code></h3>
<div class="paragraph">
<p>The <a href="settings.html#data-path">data path</a> can be shared by multiple nodes, even by nodes from
different clusters. It is recommended however to only run one node of OpenSearch using
the same data path. This setting is deprecated.</p>
</div>
<div class="paragraph">
<p>By default, OpenSearch is configured to prevent more than one node from sharing the
same data path. To allow for more than one node (e.g., on your development
machine), use the setting <code>node.max_local_storage_nodes</code> and set this to a
positive integer larger than one.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Never run different node types (i.e. master, data) from the same data
directory. This can lead to unexpected data loss.
</td>
</tr>
</table>
</div>
<h3 id="other-node-settings" class="discrete">Other node settings</h3>
<div class="paragraph">
<p>More node settings can be found in <a href="settings.html">Configuring OpenSearch</a> and <a href="important-settings.html">Important OpenSearch configuration</a>,
including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="important-settings.html#cluster-name"><code>cluster.name</code></a></p>
</li>
<li>
<p><a href="important-settings.html#node-name"><code>node.name</code></a></p>
</li>
<li>
<p><a href="settings.html#modules-network">network settings</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modules-network">Network settings</h3>
<div class="paragraph">
<p>OpenSearch binds to localhost only by default.  This is sufficient for you
to run a local development server (or even a development cluster, if you start
multiple nodes on the same machine), but you will need to configure some
<a href="settings.html#common-network-settings">basic network settings</a> in order to run a real
production cluster across multiple servers.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="title">Be careful with the network configuration!</div>
<div class="paragraph">
<p>Never expose an unprotected node to the public internet.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="common-network-settings">Commonly used network settings</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>network.host</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The node will bind to this hostname or IP address and <em>publish</em> (advertise)
this host to other nodes in the cluster. Accepts an IP address, hostname, a
<a href="settings.html#network-interface-values">special value</a>, or an array of any combination of
these. Note that any values containing a <code>:</code> (e.g., an IPv6 address or
containing one of the <a href="settings.html#network-interface-values">special values</a>) must be
quoted because <code>:</code> is a special character in YAML. <code>0.0.0.0</code> is an acceptable
IP address and will bind to all network interfaces. The value <code>0</code> has the
same effect as the value <code>0.0.0.0</code>.</p>
<div class="paragraph">
<p>Defaults to <code><em>local</em></code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>discovery.seed_hosts</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
In order to join a cluster, a node needs to know the hostname or IP address of
at least some of the other nodes in the cluster.  This setting provides the
initial list of addresses this node will try to contact. Accepts IP addresses
or hostnames. If a hostname lookup resolves to multiple IP addresses then each
IP address will be used for discovery.
<a href="https://en.wikipedia.org/wiki/Round-robin_DNS">Round robin DNS</a>&#8201;&#8212;&#8201;returning a
different IP from a list on each lookup&#8201;&#8212;&#8201;can be used for discovery; non-
existent IP addresses will throw exceptions and cause another DNS lookup on the
next round of pinging (subject to <a href="system-config.html#networkaddress-cache-ttl">JVM DNS
caching</a>).</p>
<div class="paragraph">
<p>Defaults to <code>["127.0.0.1", "[::1]"]</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>http.port</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Port to bind to for incoming HTTP requests. Accepts a single value or a range.
If a range is specified, the node will bind to the first available port in the
range.</p>
<div class="paragraph">
<p>Defaults to <code>9200-9300</code>.</p>
</div>
</dd>
<dt class="hdlist1"><code>transport.port</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Port to bind for communication between nodes. Accepts a single value or a
range. If a range is specified, the node will bind to the first available port
in the range.</p>
<div class="paragraph">
<p>Defaults to <code>9300-9400</code>.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="network-interface-values">Special values for <code>network.host</code></h4>
<div class="paragraph">
<p>The following special values may be passed to <code>network.host</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code><em>local</em></code></dt>
<dd>
<p>Any loopback addresses on the system, for example <code>127.0.0.1</code>.</p>
</dd>
<dt class="hdlist1"><code><em>site</em></code></dt>
<dd>
<p>Any site-local addresses on the system, for example <code>192.168.0.1</code>.</p>
</dd>
<dt class="hdlist1"><code><em>global</em></code></dt>
<dd>
<p>Any globally-scoped addresses on the system, for example <code>8.8.8.8</code>.</p>
</dd>
<dt class="hdlist1"><code><em>[networkInterface]</em></code></dt>
<dd>
<p>Use the addresses of the network interface called <code>[networkInterface]</code>. For
example if you wish to use the addresses of an interface called <code>en0</code> then
set <code>network.host: <em>en0</em></code>.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="network-interface-values-ipv4-vs-ipv6">IPv4 vs IPv6</h5>
<div class="paragraph">
<p>These special values will work over both IPv4 and IPv6 by default, but you can
also limit this with the use of <code>:ipv4</code> of <code>:ipv6</code> specifiers. For example,
<code><em>en0:ipv4</em></code> would only bind to the IPv4 addresses of interface <code>en0</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="title">Discovery in the cloud</div>
<div class="paragraph">
<p>More special settings are available when running in the cloud with either the
<a href="https://www.opensearch.org/guide/en/opensearch/plugins/{branch}/discovery-ec2.html">EC2 discovery plugin</a> or the
<a href="https://www.opensearch.org/guide/en/opensearch/plugins/{branch}/discovery-gce-network-host.html#discovery-gce-network-host">Google Compute Engine discovery plugin</a>
installed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="advanced-network-settings">Advanced network settings</h4>
<div class="paragraph">
<p>The <code>network.host</code> setting explained in <a href="settings.html#common-network-settings">Commonly used network settings</a>
is a shortcut which sets the <em>bind host</em> and the <em>publish host</em> at the same
time. In advanced used cases, such as when running behind a proxy server, you
may need to set these settings to different values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>network.bind_host</code></dt>
<dd>
<p>This specifies which network interface(s) a node should bind to in order to
listen for incoming requests.  A node can bind to multiple interfaces, e.g.
two network cards, or a site-local address and a local address. Defaults to
<code>network.host</code>.</p>
</dd>
<dt class="hdlist1"><code>network.publish_host</code></dt>
<dd>
<p>The publish host is the single interface that the node advertises to other nodes
in the cluster, so that those nodes can connect to it. Currently an
OpenSearch node may be bound to multiple addresses, but only publishes one.
If not specified, this defaults to the <code>`best'' address from `network.host</code>,
sorted by IPv4/IPv6 stack preference, then by reachability. If you set a
<code>network.host</code> that results in multiple bind addresses yet rely on a specific
address for node-to-node communication, you should explicitly set
<code>network.publish_host</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Both of the above settings can be configured just like <code>network.host</code>&#8201;&#8212;&#8201;they
accept IP addresses, host names, and
<a href="settings.html#network-interface-values">special values</a>.</p>
</div>
<div class="sect4">
<h5 id="tcp-settings">Advanced TCP settings</h5>
<div class="paragraph">
<p>Any component that uses TCP (like the <a href="settings.html#modules-http">HTTP</a> and
<a href="settings.html#modules-transport">transport</a> layers) share the following settings:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>network.tcp.no_delay</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Enable or disable the <a href="https://en.wikipedia.org/wiki/Nagle%27s_algorithm">TCP no delay</a>
setting. Defaults to <code>true</code>.</p>
</dd>
<dt class="hdlist1"><code>network.tcp.keep_alive</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>SO_KEEPALIVE</code> option for this socket, which
determines whether it sends TCP keepalive probes.</p>
</dd>
<dt class="hdlist1"><code>network.tcp.keep_idle</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>TCP_KEEPIDLE</code> option for this socket, which
determines the time in seconds that a connection must be idle before
starting to send TCP keepalive probes. Defaults to <code>-1</code>, which uses
the system default. This value cannot exceed <code>300</code> seconds. Only applicable on Linux and macOS,
and requires Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>network.tcp.keep_interval</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>TCP_KEEPINTVL</code> option for this socket,
which determines the time in seconds between sending TCP keepalive probes.
Defaults to <code>-1</code>, which uses the system default. This value cannot exceed <code>300</code> seconds.
Only applicable on Linux and macOS, and requires Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>network.tcp.keep_count</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>TCP_KEEPCNT</code> option for this socket, which
determines the number of unacknowledged TCP keepalive probes that may be
sent on a connection before it is dropped. Defaults to <code>-1</code>,
which uses the system default. Only applicable on Linux and macOS, and requires
Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>network.tcp.reuse_address</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Should an address be reused or not. Defaults to <code>true</code> on non-windows
machines.</p>
</dd>
<dt class="hdlist1"><code>network.tcp.send_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The size of the TCP send buffer (specified with <a href="api-conventions.html#size-units">size units</a>).
By default not explicitly set.</p>
</dd>
<dt class="hdlist1"><code>network.tcp.receive_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The size of the TCP receive buffer (specified with <a href="api-conventions.html#size-units">size units</a>).
By default not explicitly set.</p>
</dd>
</dl>
</div>
<h3 id="_http_and_transport_network_communication" class="discrete">HTTP and transport network communication</h3>
<div class="paragraph">
<p>Each OpenSearch node uses the network for two different methods of communication:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it exposes an <a href="settings.html#modules-http">HTTP interface</a> for use by clients.</p>
</li>
<li>
<p>it exposes a <a href="settings.html#modules-transport">transport interface</a> for communication
between nodes within a cluster, for communication with a
<a href="modules-remote-clusters.html">remote cluster</a>, and for the
<a href="https://www.opensearch.org/guide/en/opensearch/client/java-api/{branch}/transport-client.html">Java Transport client</a> to communicate with a
cluster.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The network settings described above apply to both methods of communication,
and you can also configure each interface separately if needed. See the
<a href="settings.html#modules-http">HTTP</a> and <a href="settings.html#modules-transport">transport</a> pages for more
details on their respective configurations.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="query-cache">Node query cache settings</h3>
<div class="paragraph">
<p>The results of queries used in the filter context are cached in the node query
cache for fast lookup. There is one queries cache per node that is shared by all
shards. The cache uses an LRU eviction policy: when the cache is full, the least
recently used query results are evicted to make way for new data. You cannot
inspect the contents of the query cache.</p>
</div>
<div class="paragraph">
<p>Term queries and queries used outside of a filter context are not eligible for
caching.</p>
</div>
<div class="paragraph">
<p>By default, the cache holds a maximum of 10000 queries in up to 10% of the total
heap space. To determine if a query is eligible for caching, OpenSearch maintains a
query history to track occurrences.</p>
</div>
<div class="paragraph">
<p>Caching is done on a per segment basis if a segment contains at least 10000
documents and the segment has at least 3% of the total documents of a shard.
Because caching is per segment, merging segments can invalidate cached queries.</p>
</div>
<div class="paragraph">
<p>The following setting is <em>static</em> and must be configured on every data node in
the cluster:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>indices.queries.cache.size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Controls the memory size for the filter cache. Accepts
either a percentage value, like <code>5%</code>, or an exact value, like <code>512mb</code>. Defaults to <code>10%</code>.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="query-cache-index-settings">Query cache index settings</h4>
<div class="paragraph">
<p>The following setting is an <em>index</em> setting that can be configured on a
per-index basis. Can only be set at index creation time or on a
<a href="indices.html#indices-open-close">closed index</a>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>index.queries.cache.enabled</code></dt>
<dd>
<p>(<a href="index-modules.html#index-modules-settings">Static</a>)
Controls whether to enable query caching. Accepts <code>true</code> (default) or
<code>false</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="search-settings">Search settings</h3>
<div class="paragraph">
<p>The following expert settings can be set to manage global search and aggregation
limits.</p>
</div>
<div id="indices-query-bool-max-clause-count" class="dlist">
<dl>
<dt class="hdlist1"><code>indices.query.bool.max_clause_count</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>, integer)
Maximum number of clauses a Lucene BooleanQuery can contain. Defaults to <code>1024</code>.</p>
<div class="paragraph">
<p>This setting limits the number of clauses a Lucene BooleanQuery can have. The
default of 1024 is quite high and should normally be sufficient. This limit does
not only affect OpenSearch&#8217;s <code>bool</code> query, but many other queries are rewritten to Lucene&#8217;s
BooleanQuery internally. The limit is in place to prevent searches from becoming too large
and taking up too much CPU and memory. In case you&#8217;re considering increasing this setting,
make sure you&#8217;ve exhausted all other options to avoid having to do this. Higher values can lead
to performance degradations and memory issues, especially in clusters with a high load or
few resources.</p>
</div>
</dd>
</dl>
</div>
<div id="search-settings-max-buckets" class="dlist">
<dl>
<dt class="hdlist1"><code>search.max_buckets</code></dt>
<dd>
<p>(<a href="cluster.html#cluster-update-settings">Dynamic</a>, integer)
Maximum number of <a href="search-aggregations-bucket.html">aggregation buckets</a> allowed in
a single response. Defaults to 65,535.</p>
<div class="paragraph">
<p>Requests that attempt to return more than this limit will return an error.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="shard-request-cache">Shard request cache settings</h3>
<div class="paragraph">
<p>When a search request is run against an index or against many indices, each
involved shard executes the search locally and returns its local results to
the <em>coordinating node</em>, which combines these shard-level results into a
``global'' result set.</p>
</div>
<div class="paragraph">
<p>The shard-level request cache module caches the local results on each shard.
This allows frequently used (and potentially heavy) search requests to return
results almost instantly. The requests cache is a very good fit for the logging
use case, where only the most recent index is being actively updated&#8201;&#8212;&#8201;results from older indices will be served directly from the cache.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the requests cache will only cache the results of search requests
where <code>size=0</code>, so it will not cache <code>hits</code>,
but it will cache <code>hits.total</code>,  <a href="search-aggregations.html">aggregations</a>, and
<a href="search.html#search-suggesters">suggestions</a>.</p>
</div>
<div class="paragraph">
<p>Most queries that use <code>now</code> (see <a href="api-conventions.html#date-math">Date Math</a>) cannot be cached.</p>
</div>
<div class="paragraph">
<p>Scripted queries that use the API calls which are non-deterministic, such as
<code>Math.random()</code> or <code>new Date()</code> are not cached.</p>
</div>
</td>
</tr>
</table>
</div>
<h4 id="_cache_invalidation" class="discrete">Cache invalidation</h4>
<div class="paragraph">
<p>The cache is smart&#8201;&#8212;&#8201;it keeps the same <em>near real-time</em> promise as uncached
search.</p>
</div>
<div class="paragraph">
<p>Cached results are invalidated automatically whenever the shard refreshes, but
only if the data in the shard has actually changed.  In other words, you will
always get the same results from the cache as you would for an uncached search
request.</p>
</div>
<div class="paragraph">
<p>The longer the refresh interval, the longer that cached entries will remain
valid. If the cache is full, the least recently used cache keys will be
evicted.</p>
</div>
<div class="paragraph">
<p>The cache can be expired manually with the <a href="indices.html#indices-clearcache"><code>clear-cache</code> API</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">POST /my-index-000001,my-index-000002/_cache/clear?request=true</code></pre>
</div>
</div>
<h4 id="_enabling_and_disabling_caching" class="discrete">Enabling and disabling caching</h4>
<div class="paragraph">
<p>The cache is enabled by default, but can be disabled when creating a new
index as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /my-index-000001
{
  "settings": {
    "index.requests.cache.enable": false
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It can also be enabled or disabled dynamically on an existing index with the
<a href="indices.html#indices-update-settings"><code>update-settings</code></a> API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT /my-index-000001/_settings
{ "index.requests.cache.enable": true }</code></pre>
</div>
</div>
<h4 id="_enabling_and_disabling_caching_per_request" class="discrete">Enabling and disabling caching per request</h4>
<div class="paragraph">
<p>The <code>request_cache</code> query-string parameter can be used to enable or disable
caching on a <strong>per-request</strong> basis.  If set, it overrides the index-level setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /my-index-000001/_search?request_cache=true
{
  "size": 0,
  "aggs": {
    "popular_colors": {
      "terms": {
        "field": "colors"
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Requests where <code>size</code> is greater than 0 will not be cached even if the request cache is
enabled in the index settings. To cache these requests you will need to use the
query-string parameter detailed here.</p>
</div>
<h4 id="_cache_key" class="discrete">Cache key</h4>
<div class="paragraph">
<p>The whole JSON body is used as the cache key.  This means that if the JSON
changes&#8201;&#8212;&#8201;for instance if keys are output in a different order&#8201;&#8212;&#8201;then the
cache key will not be recognised.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Most JSON libraries support a <em>canonical</em> mode which ensures that JSON
keys are always emitted in the same order. This canonical mode can be used in
the application to ensure that a request is always serialized in the same way.
</td>
</tr>
</table>
</div>
<h4 id="_cache_settings" class="discrete">Cache settings</h4>
<div class="paragraph">
<p>The cache is managed at the node level, and has a default maximum size of <code>1%</code>
of the heap.  This can be changed in the <code>config/opensearch.yml</code> file with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">indices.requests.cache.size: 2%</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, you can use the indices.requests.cache.expire setting to specify a TTL
for cached results, but there should be no reason to do so.  Remember that
stale results are automatically invalidated when the index is refreshed. This
setting is provided for completeness' sake only.</p>
</div>
<h4 id="_monitoring_cache_usage" class="discrete">Monitoring cache usage</h4>
<div class="paragraph">
<p>The size of the cache (in bytes) and the number of evictions can be viewed
by index, with the <a href="indices.html#indices-stats"><code>indices-stats</code></a> API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_stats/request_cache?human</code></pre>
</div>
</div>
<div class="paragraph">
<p>or by node with the <a href="cluster.html#cluster-nodes-stats"><code>nodes-stats</code></a> API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">GET /_nodes/stats/indices/request_cache?human</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modules-transport">Transport</h3>
<div class="paragraph">
<p>REST clients send requests to your OpenSearch cluster over <a href="settings.html#modules-http">HTTP</a>, but
the node that receives a client request cannot always handle it alone and must
normally pass it on to other nodes for further processing. It does this using
the transport networking layer. The transport layer is used for all internal
communication between nodes within a cluster, all communication with the nodes
of a <a href="modules-remote-clusters.html">remote cluster</a>, and also by the
<code>TransportClient</code> in the OpenSearch Java API.</p>
</div>
<div class="sect3">
<h4 id="transport-settings">Transport settings</h4>
<div class="paragraph">
<p>The following settings can be configured for the internal transport that
communicates over TCP. These settings also use the common
<a href="settings.html#modules-network">network settings</a>.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>transport.port</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
A bind port range. Defaults to <code>9300-9400</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.publish_port</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The port that other nodes in the cluster
should use when communicating with this node. Useful when a cluster node
is behind a proxy or firewall and the <code>transport.port</code> is not directly
addressable from the outside. Defaults to the actual port assigned via
<code>transport.port</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.bind_host</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The host address to bind the transport service to. Defaults to
<code>transport.host</code> (if set) or <code>network.bind_host</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.publish_host</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The host address to publish for nodes in the cluster to connect to.
Defaults to <code>transport.host</code> (if set) or <code>network.publish_host</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.host</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Used to set the <code>transport.bind_host</code> and the <code>transport.publish_host</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.connect_timeout</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The connect timeout for initiating a new connection (in
time setting format). Defaults to <code>30s</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.compress</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Set to <code>true</code> to enable compression (<code>DEFLATE</code>) between
all nodes. Defaults to <code>false</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.ping_schedule</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Schedule a regular application-level ping message
to ensure that transport connections between nodes are kept alive. Defaults to
<code>5s</code> in the transport client and <code>-1</code> (disabled) elsewhere. It is preferable
to correctly configure TCP keep-alives instead of using this feature, because
TCP keep-alives apply to all kinds of long-lived connections and not just to
transport connections.</p>
</dd>
<dt class="hdlist1"><code>transport.tcp.no_delay</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Enable or disable the <a href="https://en.wikipedia.org/wiki/Nagle%27s_algorithm">TCP no delay</a>
setting. Defaults to <code>network.tcp.no_delay</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.tcp.keep_alive</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>SO_KEEPALIVE</code> option for this socket, which
determines whether it sends TCP keepalive probes.
Defaults to <code>network.tcp.keep_alive</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.tcp.keep_idle</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>TCP_KEEPIDLE</code> option for this socket, which
determines the time in seconds that a connection must be idle before
starting to send TCP keepalive probes. Defaults to <code>network.tcp.keep_idle</code> if set,
or the system default otherwise.
This value cannot exceed <code>300</code> seconds. In cases where the system default
is higher than <code>300</code>, the value is automatically lowered to <code>300</code>. Only applicable on
Linux and macOS, and requires Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>transport.tcp.keep_interval</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>TCP_KEEPINTVL</code> option for this socket,
which determines the time in seconds between sending TCP keepalive probes.
Defaults to <code>network.tcp.keep_interval</code> if set, or the system default otherwise.
This value cannot exceed <code>300</code> seconds. In cases where the system default is higher than <code>300</code>,
the value is automatically lowered to <code>300</code>. Only applicable on Linux and macOS,
and requires Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>transport.tcp.keep_count</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Configures the <code>TCP_KEEPCNT</code> option for this socket, which
determines the number of unacknowledged TCP keepalive probes that may be
sent on a connection before it is dropped. Defaults to <code>network.tcp.keep_count</code>
if set, or the system default otherwise. Only applicable on Linux and macOS, and
requires Java 11 or newer.</p>
</dd>
<dt class="hdlist1"><code>transport.tcp.reuse_address</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
Should an address be reused or not. Defaults to <code>network.tcp.reuse_address</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.tcp.send_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The size of the TCP send buffer (specified with <a href="api-conventions.html#size-units">size units</a>).
Defaults to <code>network.tcp.send_buffer_size</code>.</p>
</dd>
<dt class="hdlist1"><code>transport.tcp.receive_buffer_size</code></dt>
<dd>
<p>(<a href="settings.html#static-cluster-setting">Static</a>)
The size of the TCP receive buffer (specified with <a href="api-conventions.html#size-units">size units</a>).
Defaults to <code>network.tcp.receive_buffer_size</code>.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="transport-profiles">Transport profiles</h5>
<div class="paragraph">
<p>OpenSearch allows you to bind to multiple ports on different interfaces by
the use of transport profiles. See this example configuration</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">transport.profiles.default.port: 9300-9400
transport.profiles.default.bind_host: 10.0.0.1
transport.profiles.client.port: 9500-9600
transport.profiles.client.bind_host: 192.168.0.1
transport.profiles.dmz.port: 9700-9800
transport.profiles.dmz.bind_host: 172.16.1.2</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>default</code> profile is special. It is used as a fallback for any other
profiles, if those do not have a specific configuration setting set, and is how
this node connects to other nodes in the cluster.</p>
</div>
<div class="paragraph">
<p>The following parameters can be configured on each transport profile, as in the
example above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>port</code>: The port to which to bind.</p>
</li>
<li>
<p><code>bind_host</code>: The host to which to bind.</p>
</li>
<li>
<p><code>publish_host</code>: The host which is published in informational APIs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Profiles also support all the other transport settings specified in the
<a href="settings.html#transport-settings">transport settings</a> section, and use these as defaults.
For example, <code>transport.profiles.client.tcp.reuse_address</code> can be explicitly
configured, and defaults otherwise to <code>transport.tcp.reuse_address</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="long-lived-connections">Long-lived idle connections</h5>
<div class="paragraph">
<p>A transport connection between two nodes is made up of a number of long-lived
TCP connections, some of which may be idle for an extended period of time.
Nonetheless, OpenSearch requires these connections to remain open, and it
can disrupt the operation of your cluster if any inter-node connections are
closed by an external influence such as a firewall. It is important to
configure your network to preserve long-lived idle connections between
OpenSearch nodes, for instance by leaving <code>tcp.keep_alive</code> enabled and
ensuring that the keepalive interval is shorter than any timeout that might
cause idle connections to be closed, or by setting <code>transport.ping_schedule</code> if
keepalives cannot be configured. Devices which drop connections when they reach
a certain age are a common source of problems to OpenSearch clusters, and
must not be used.</p>
</div>
</div>
<div class="sect4">
<h5 id="request-compression">Request compression</h5>
<div class="paragraph">
<p>By default, the <code>transport.compress</code> setting is <code>false</code> and network-level
request compression is disabled between nodes in the cluster. This default
normally makes sense for local cluster communication as compression has a
noticeable CPU cost and local clusters tend to be set up with fast network
connections between nodes.</p>
</div>
<div class="paragraph">
<p>The <code>transport.compress</code> setting always configures local cluster request
compression and is the fallback setting for remote cluster request compression.
If you want to configure remote request compression differently than local
request compression, you can set it on a per-remote cluster basis using the
<a href="modules-remote-clusters.html#remote-cluster-settings"><code>cluster.remote.${cluster_alias}.transport.compress</code> setting</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="response-compression">Response compression</h5>
<div class="paragraph">
<p>The compression settings do not configure compression for responses. OpenSearch will
compress a response if the inbound request was compressed&#8212;&#8203;even when compression
is not enabled. Similarly, OpenSearch will not compress a response if the inbound
request was uncompressed&#8212;&#8203;even when compression is enabled.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="transport-tracer">Transport tracer</h4>
<div class="paragraph">
<p>The transport layer has a dedicated tracer logger which, when activated, logs incoming and out going requests. The log can be dynamically activated
by setting the level of the <code>org.opensearch.transport.TransportService.tracer</code> logger to <code>TRACE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT _cluster/settings
{
   "transient" : {
      "logger.org.opensearch.transport.TransportService.tracer" : "TRACE"
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also control which actions will be traced, using a set of include and exclude wildcard patterns. By default every request will be traced
except for fault detection pings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">PUT _cluster/settings
{
   "transient" : {
      "transport.tracer.include" : "*",
      "transport.tracer.exclude" : "internal:coordination/fault_detection/*"
   }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="modules-threadpool">Thread pools</h3>
<div class="paragraph">
<p>A node uses several thread pools to manage memory consumption.
Queues associated with many of the thread pools enable pending requests
to be held instead of discarded.</p>
</div>
<div class="paragraph">
<p>There are several thread pools, but the important ones include:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>generic</code></dt>
<dd>
<p>For generic operations (for example, background node discovery).
Thread pool type is <code>scaling</code>.</p>
</dd>
</dl>
</div>
<div id="search-threadpool" class="dlist">
<dl>
<dt class="hdlist1"><code>search</code></dt>
<dd>
<p>For count/search/suggest operations. Thread pool type is
<code>fixed_auto_queue_size</code> with a size of <code>int((</code><a href="settings.html#node.processors"><code># of allocated processors</code></a>` * 3) / 2) + 1`, and initial queue_size of
<code>1000</code>.</p>
</dd>
<dt class="hdlist1"><a id="search-throttled"></a><code>search_throttled</code></dt>
<dd>
<p>For count/search/suggest/get operations on <code>search_throttled indices</code>.
Thread pool type is <code>fixed_auto_queue_size</code> with a size of <code>1</code>, and initial
queue_size of <code>100</code>.</p>
</dd>
<dt class="hdlist1"><code>get</code></dt>
<dd>
<p>For get operations. Thread pool type is <code>fixed</code>
with a size of <a href="settings.html#node.processors"><code># of allocated processors</code></a>,
queue_size of <code>1000</code>.</p>
</dd>
<dt class="hdlist1"><code>analyze</code></dt>
<dd>
<p>For analyze requests. Thread pool type is <code>fixed</code> with a size of <code>1</code>, queue
size of <code>16</code>.</p>
</dd>
<dt class="hdlist1"><code>write</code></dt>
<dd>
<p>For single-document index/delete/update and bulk requests. Thread pool type
is <code>fixed</code> with a size of <a href="settings.html#node.processors"><code># of allocated processors</code></a>,
queue_size of <code>10000</code>. The maximum size for this pool is
<code>1 + </code><a href="settings.html#node.processors"><code># of allocated processors</code></a>.</p>
</dd>
<dt class="hdlist1"><code>snapshot</code></dt>
<dd>
<p>For snapshot/restore operations. Thread pool type is <code>scaling</code> with a
keep-alive of <code>5m</code> and a max of <code>min(5, (</code><a href="settings.html#node.processors"><code># of allocated processors</code></a>`) / 2)`.</p>
</dd>
<dt class="hdlist1"><code>warmer</code></dt>
<dd>
<p>For segment warm-up operations. Thread pool type is <code>scaling</code> with a
keep-alive of <code>5m</code> and a max of <code>min(5, (</code><a href="settings.html#node.processors"><code># of allocated processors</code></a>`) / 2)`.</p>
</dd>
<dt class="hdlist1"><code>refresh</code></dt>
<dd>
<p>For refresh operations. Thread pool type is <code>scaling</code> with a
keep-alive of <code>5m</code> and a max of <code>min(10, (</code><a href="settings.html#node.processors"><code># of allocated processors</code></a>`) / 2)`.</p>
</dd>
<dt class="hdlist1"><code>listener</code></dt>
<dd>
<p>Mainly for java client executing of action when listener threaded is set to
<code>true</code>. Thread pool type is <code>scaling</code> with a default max of
<code>min(10, (</code><a href="settings.html#node.processors"><code># of allocated processors</code></a>`) / 2)`.</p>
</dd>
<dt class="hdlist1"><code>fetch_shard_started</code></dt>
<dd>
<p>For listing shard states.
Thread pool type is <code>scaling</code> with keep-alive of <code>5m</code> and a default maximum
size of <code>2 * </code><a href="settings.html#node.processors"><code># of allocated processors</code></a>.</p>
</dd>
<dt class="hdlist1"><code>fetch_shard_store</code></dt>
<dd>
<p>For listing shard stores.
Thread pool type is <code>scaling</code> with keep-alive of <code>5m</code> and a default maximum
size of <code>2 * </code><a href="settings.html#node.processors"><code># of allocated processors</code></a>.</p>
</dd>
<dt class="hdlist1"><code>flush</code></dt>
<dd>
<p>For <a href="indices.html#indices-flush">flush</a>, <a href="indices.html#indices-flush">flush</a>, and
<a href="index-modules-translog.html">translog</a> <code>fsync</code> operations. Thread pool type is
<code>scaling</code> with a keep-alive of <code>5m</code> and a default maximum size of <code>min(5, (</code>
<a href="settings.html#node.processors"><code># of allocated processors</code></a>`) / 2)`.</p>
</dd>
<dt class="hdlist1"><code>force_merge</code></dt>
<dd>
<p>For <a href="indices.html#indices-forcemerge">force merge</a> operations.
Thread pool type is <code>fixed</code> with a size of 1 and an unbounded queue size.</p>
</dd>
<dt class="hdlist1"><code>management</code></dt>
<dd>
<p>For cluster management.
Thread pool type is <code>scaling</code> with a keep-alive of <code>5m</code> and a default
maximum size of <code>5</code>.</p>
</dd>
<dt class="hdlist1"><code>system_read</code></dt>
<dd>
<p>For read operations on system indices.
Thread pool type is <code>fixed</code> and a default maximum size of
<code>min(5, (</code><a href="settings.html#node.processors"><code># of allocated processors</code></a>`) / 2)`.</p>
</dd>
<dt class="hdlist1"><code>system_write</code></dt>
<dd>
<p>For write operations on system indices.
Thread pool type is <code>fixed</code> and a default maximum size of
<code>min(5, (</code><a href="settings.html#node.processors"><code># of allocated processors</code></a>`) / 2)`.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Changing a specific thread pool can be done by setting its type-specific
parameters; for example, changing the number of threads in the <code>write</code> thread
pool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">thread_pool:
    write:
        size: 30</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="thread-pool-types">Thread pool types</h4>
<div class="paragraph">
<p>The following are the types of thread pools and their respective parameters:</p>
</div>
<div class="sect4">
<h5 id="fixed-thread-pool"><code>fixed</code></h5>
<div class="paragraph">
<p>The <code>fixed</code> thread pool holds a fixed size of threads to handle the
requests with a queue (optionally bounded) for pending requests that
have no threads to service them.</p>
</div>
<div class="paragraph">
<p>The <code>size</code> parameter controls the number of threads.</p>
</div>
<div class="paragraph">
<p>The <code>queue_size</code> allows to control the size of the queue of pending
requests that have no threads to execute them. By default, it is set to
<code>-1</code> which means its unbounded. When a request comes in and the queue is
full, it will abort the request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">thread_pool:
    write:
        size: 30
        queue_size: 1000</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="fixed-auto-queue-size"><code>fixed_auto_queue_size</code></h5>
<div class="paragraph">
<p>Deprecated. The <code>fixed_auto_queue_size</code> thread pool holds a fixed size of threads to handle
the requests with a bounded queue for pending requests that have no threads to
service them. It&#8217;s similar to the <code>fixed</code> threadpool, however, the <code>queue_size</code>
automatically adjusts according to calculations based on
<a href="https://en.wikipedia.org/wiki/Little%27s_law">Little&#8217;s Law</a>. These calculations
will potentially adjust the <code>queue_size</code> up or down by 50 every time
<code>auto_queue_frame_size</code> operations have been completed.</p>
</div>
<div class="paragraph">
<p>The <code>size</code> parameter controls the number of threads.</p>
</div>
<div class="paragraph">
<p>The <code>queue_size</code> allows to control the initial size of the queue of pending
requests that have no threads to execute them.</p>
</div>
<div class="paragraph">
<p>The <code>min_queue_size</code> setting controls the minimum amount the <code>queue_size</code> can be
adjusted to.</p>
</div>
<div class="paragraph">
<p>The <code>max_queue_size</code> setting controls the maximum amount the <code>queue_size</code> can be
adjusted to.</p>
</div>
<div class="paragraph">
<p>The <code>auto_queue_frame_size</code> setting controls the number of operations during
which measurement is taken before the queue is adjusted. It should be large
enough that a single operation cannot unduly bias the calculation.</p>
</div>
<div class="paragraph">
<p>The <code>target_response_time</code> is a time value setting that indicates the targeted
average response time for tasks in the thread pool queue. If tasks are routinely
above this time, the thread pool queue will be adjusted down so that tasks are
rejected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">thread_pool:
    search:
        size: 30
        queue_size: 500
        min_queue_size: 10
        max_queue_size: 1000
        auto_queue_frame_size: 2000
        target_response_time: 1s</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="scaling-thread-pool"><code>scaling</code></h5>
<div class="paragraph">
<p>The <code>scaling</code> thread pool holds a dynamic number of threads. This
number is proportional to the workload and varies between the value of
the <code>core</code> and <code>max</code> parameters.</p>
</div>
<div class="paragraph">
<p>The <code>keep_alive</code> parameter determines how long a thread should be kept
around in the thread pool without it doing any work.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">thread_pool:
    warmer:
        core: 1
        max: 8
        keep_alive: 2m</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="node.processors">Allocated processors setting</h4>
<div class="paragraph">
<p>The number of processors is automatically detected, and the thread pool settings
are automatically set based on it. In some cases it can be useful to override
the number of detected processors. This can be done by explicitly setting the
<code>node.processors</code> setting.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">node.processors: 2</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are a few use-cases for explicitly overriding the <code>node.processors</code>
setting:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you are running multiple instances of OpenSearch on the same host but want want
OpenSearch to size its thread pools as if it only has a fraction of the CPU, you
should override the <code>node.processors</code> setting to the desired fraction, for
example, if you&#8217;re running two instances of OpenSearch on a 16-core machine, set
<code>node.processors</code> to 8.  Note that this is an expert-level use case and there&#8217;s
a lot more involved than just setting the <code>node.processors</code> setting as there are
other considerations like changing the number of garbage collector threads,
pinning processes to cores, and so on.</p>
</li>
<li>
<p>Sometimes the number of processors is wrongly detected and in such cases
explicitly setting the <code>node.processors</code> setting will workaround such issues.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In order to check the number of processors detected, use the nodes info
API with the <code>os</code> flag.</p>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>← Previous: <a href="install-opensearch.html">Installing OpenSearch</a> | ↑ Up: <a href="setup.html">Set up OpenSearch</a> | ⌂ Home: <a href="index.html">OpenSearch Reference</a> | Next: <a href="important-settings.html">Important OpenSearch configuration</a> →</p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-04-12 14:08:20 -0700
</div>
</div>
</body>
</html>